.. index:: pair: class; cv::detail::BundleAdjusterBase
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base:

class cv::detail::BundleAdjusterBase
====================================

.. toctree::
	:hidden:

Overview
~~~~~~~~

Base class for all camera parameters refinement methods. :ref:`More...<details-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <motion_estimators.hpp>
	
	class BundleAdjusterBase: public :ref:`cv::detail::Estimator<doxid-dc/dc4/classcv_1_1detail_1_1_estimator>`
	{
	public:
		// methods
	
		double
		:target:`confThresh<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1ae5421c7653929d73265431105631aecf>`() const;
	
		const :ref:`Mat<doxid-db/de6/classcv_1_1_mat>`
		:target:`refinementMask<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a78c3d35fb56343accaf1ee5fc9441713>`() const;
	
		void
		:target:`setConfThresh<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1aa5e180dd73dc7ce4fa1627fda01b1bfc>`(double conf_thresh);
	
		void
		:target:`setRefinementMask<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1aa47bf2d3496b65b3e70b5b43681e5360>`(const :ref:`Mat<doxid-db/de6/classcv_1_1_mat>`& mask);
	
		void
		:target:`setTermCriteria<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1ae81349da624b7fa2b76eba78b2ffa613>`(const :ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>`& term_criteria);
	
		:ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>`
		:target:`termCriteria<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a0e91ee6fb4015df0a8ba29485fe0cd26>`();

	protected:
		// fields
	
		:ref:`Mat<doxid-db/de6/classcv_1_1_mat>` :target:`cam_params_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a075f23eff9fafb25b01dc0d909ec308c>`;
		double :target:`conf_thresh_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a7496b2ad6eb9893b7cf20a723eb4cec7>`;
		std::vector<std::pair<int, int>> :target:`edges_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a20d50a47ba95683398d61581dcaac28d>`;
		const :ref:`ImageFeatures<doxid-d4/dbe/structcv_1_1detail_1_1_image_features>`* :target:`features_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a3e3bcb444b3e4b4bd570653d247c8639>`;
		int :target:`num_errs_per_measurement_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a316c5f7ee2a86061f1aab7169aa78bac>`;
		int :target:`num_images_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a195a4414e1e513a21ad1290cafb2c455>`;
		int :target:`num_params_per_cam_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a53a2fe05702415fbf2926179032c727b>`;
		const :ref:`MatchesInfo<doxid-d2/d99/structcv_1_1detail_1_1_matches_info>`* :target:`pairwise_matches_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a5c6d7027fd93d1824ba811a3c7bbf0a5>`;
		:ref:`Mat<doxid-db/de6/classcv_1_1_mat>` :target:`refinement_mask_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a56ea71911cc8a1693544f2f6a890ba73>`;
		:ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>` :target:`term_criteria_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a7cc52deb16df4fd9e3f2bbfd8843a743>`;
		int :target:`total_num_matches_<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a4f14cdc846f7f03828c1fb6c21539936>`;

		// construction
	
		:ref:`BundleAdjusterBase<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a6b2709dce0e39413fa988dc5c0ffc47b>`(
			int num_params_per_cam,
			int num_errs_per_measurement
			);

		// methods
	
		virtual
		void
		:ref:`calcError<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a915c63bff1eb2097710d0cf95f2b9784>`(:ref:`Mat<doxid-db/de6/classcv_1_1_mat>`& err) = 0;
	
		virtual
		void
		:ref:`calcJacobian<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a2d09d69ec01cd5f4967ed861230f9c45>`(:ref:`Mat<doxid-db/de6/classcv_1_1_mat>`& jac) = 0;
	
		virtual
		bool
		:ref:`estimate<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1af2477a78f4e5ff4fb557f8c8500def2b>`(
			const std::vector<:ref:`ImageFeatures<doxid-d4/dbe/structcv_1_1detail_1_1_image_features>`>& features,
			const std::vector<:ref:`MatchesInfo<doxid-d2/d99/structcv_1_1detail_1_1_matches_info>`>& pairwise_matches,
			std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras
			);
	
		virtual
		void
		:ref:`obtainRefinedCameraParams<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1aae756bac56334dea76d4064c6a32c1a9>`(std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras) const = 0;
	
		virtual
		void
		:ref:`setUpInitialCameraParams<doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a7d3b589d7502dd18a1d1dad898816b2e>`(const std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras) = 0;
	};

	// direct descendants

	class :ref:`BundleAdjusterAffine<doxid-d6/d86/classcv_1_1detail_1_1_bundle_adjuster_affine>`;
	class :ref:`BundleAdjusterAffinePartial<doxid-da/d8b/classcv_1_1detail_1_1_bundle_adjuster_affine_partial>`;
	class :ref:`BundleAdjusterRay<doxid-d2/d79/classcv_1_1detail_1_1_bundle_adjuster_ray>`;
	class :ref:`BundleAdjusterReproj<doxid-d4/d9d/classcv_1_1detail_1_1_bundle_adjuster_reproj>`;
	class :ref:`NoBundleAdjuster<doxid-da/ddd/classcv_1_1detail_1_1_no_bundle_adjuster>`;

Inherited Members
-----------------

.. ref-code-block:: cpp
	:class: doxyrest-overview-inherited-code-block

	public:
		// methods
	
		bool
		:ref:`operator()<doxid-dc/dc4/classcv_1_1detail_1_1_estimator_1a0924447fc99df3360b6f005a7c0aa437>`(
			const std::vector<:ref:`ImageFeatures<doxid-d4/dbe/structcv_1_1detail_1_1_image_features>`>& features,
			const std::vector<:ref:`MatchesInfo<doxid-d2/d99/structcv_1_1detail_1_1_matches_info>`>& pairwise_matches,
			std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras
			);

	protected:
		// methods
	
		virtual
		bool
		:ref:`estimate<doxid-dc/dc4/classcv_1_1detail_1_1_estimator_1ab65ae24f4d6b53554dcc04121e6cbc47>`(
			const std::vector<:ref:`ImageFeatures<doxid-d4/dbe/structcv_1_1detail_1_1_image_features>`>& features,
			const std::vector<:ref:`MatchesInfo<doxid-d2/d99/structcv_1_1detail_1_1_matches_info>`>& pairwise_matches,
			std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras
			) = 0;

.. _details-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

Base class for all camera parameters refinement methods.

Construction
------------

.. index:: pair: function; BundleAdjusterBase
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a6b2709dce0e39413fa988dc5c0ffc47b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	BundleAdjusterBase(
		int num_params_per_cam,
		int num_errs_per_measurement
		)

Construct a bundle adjuster base instance.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- num_params_per_cam

		- Number of parameters per camera

	*
		- num_errs_per_measurement

		- Number of error terms (components) per match

Methods
-------

.. index:: pair: function; calcError
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a915c63bff1eb2097710d0cf95f2b9784:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	calcError(:ref:`Mat<doxid-db/de6/classcv_1_1_mat>`& err) = 0

Calculates error vector.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- err

		- :ref:`Error <doxid-d6/d43/namespacecv_1_1_error>` column-vector of length total_num_matches \* num_errs_per_measurement

.. index:: pair: function; calcJacobian
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a2d09d69ec01cd5f4967ed861230f9c45:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	calcJacobian(:ref:`Mat<doxid-db/de6/classcv_1_1_mat>`& jac) = 0

Calculates the cost function jacobian.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- jac

		- Jacobian matrix of dimensions (total_num_matches \* num_errs_per_measurement) x (num_images \* num_params_per_cam)

.. index:: pair: function; estimate
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1af2477a78f4e5ff4fb557f8c8500def2b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	bool
	estimate(
		const std::vector<:ref:`ImageFeatures<doxid-d4/dbe/structcv_1_1detail_1_1_image_features>`>& features,
		const std::vector<:ref:`MatchesInfo<doxid-d2/d99/structcv_1_1detail_1_1_matches_info>`>& pairwise_matches,
		std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras
		)

This method must implement camera parameters estimation logic in order to make the wrapper detail::Estimator::operator()\_ work.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- features

		- Features of images

	*
		- pairwise_matches

		- Pairwise matches of images

	*
		- cameras

		- Estimated camera parameters



.. rubric:: Returns:

True in case of success, false otherwise

.. index:: pair: function; obtainRefinedCameraParams
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1aae756bac56334dea76d4064c6a32c1a9:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	obtainRefinedCameraParams(std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras) const = 0

Gets the refined camera parameters.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- cameras

		- Refined camera parameters

.. index:: pair: function; setUpInitialCameraParams
.. _doxid-da/d90/classcv_1_1detail_1_1_bundle_adjuster_base_1a7d3b589d7502dd18a1d1dad898816b2e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setUpInitialCameraParams(const std::vector<:ref:`CameraParams<doxid-da/d60/structcv_1_1detail_1_1_camera_params>`>& cameras) = 0

Sets initial camera parameter to refine.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- cameras

		- Camera parameters

