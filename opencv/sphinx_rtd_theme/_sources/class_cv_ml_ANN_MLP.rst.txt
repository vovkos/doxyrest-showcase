.. index:: pair: class; cv::ml::ANN_MLP
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p:

class cv::ml::ANN_MLP
=====================

.. toctree::
	:hidden:

	enum_cv_ml_ANN_MLP_ActivationFunctions.rst
	enum_cv_ml_ANN_MLP_TrainFlags.rst
	enum_cv_ml_ANN_MLP_TrainingMethods.rst

Overview
~~~~~~~~

Artificial Neural Networks - Multi-Layer Perceptrons. :ref:`More...<details-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <ml.hpp>
	
	class ANN_MLP: public :ref:`cv::ml::StatModel<doxid-d9/d36/classcv_1_1ml_1_1_stat_model>`
	{
	public:
		// enums
	
		enum :ref:`ActivationFunctions<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ade71470ec8814021728f8b31b09773b0>`;
		enum :ref:`TrainFlags<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1afb51e414f22dd69f281a569145ccfad7>`;
		enum :ref:`TrainingMethods<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181>`;

		// methods
	
		virtual
		double
		:ref:`getBackpropMomentumScale<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a8a239f6fc2f3af77b5b8af14b85db6c2>`() const = 0;
	
		virtual
		double
		:ref:`getBackpropWeightScale<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a3f3118577f227f7f6ccc9d8c9a0496a4>`() const = 0;
	
		virtual
		:ref:`cv::Mat<doxid-db/de6/classcv_1_1_mat>`
		:ref:`getLayerSizes<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a6ddeca856c988d91ec7b7209e324e555>`() const = 0;
	
		virtual
		double
		:ref:`getRpropDW0<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1aec1c80229df0d4552c0a922dd2caa935>`() const = 0;
	
		virtual
		double
		:ref:`getRpropDWMax<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a73f174d3f24d5715a4db57b23cdc066c>`() const = 0;
	
		virtual
		double
		:ref:`getRpropDWMin<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a4c56d0ab068e59e8d7d1ad42a2ce386f>`() const = 0;
	
		virtual
		double
		:ref:`getRpropDWMinus<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a9db260e1b71d8865d1dd9856ea1b5124>`() const = 0;
	
		virtual
		double
		:ref:`getRpropDWPlus<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a71261559e73c1f307310bc5ae6491743>`() const = 0;
	
		virtual
		:ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>`
		:ref:`getTermCriteria<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a1d38045b36f3f1363573ad0fd18b82ae>`() const = 0;
	
		virtual
		int
		:ref:`getTrainMethod<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a97308c9dc08c75b5b82a4efd3b6118a6>`() const = 0;
	
		virtual
		:ref:`Mat<doxid-db/de6/classcv_1_1_mat>`
		:target:`getWeights<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a36b5016e3d389d84c0c5863bb8d5b8b9>`(int layerIdx) const = 0;
	
		virtual
		void
		:ref:`setActivationFunction<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a16998f97db903c1c652e68f342240524>`(
			int type,
			double param1 = 0,
			double param2 = 0
			) = 0;
	
		virtual
		void
		:ref:`setBackpropMomentumScale<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a59fd3f49aba9418a96d44998deb68d00>`(double val) = 0;
	
		virtual
		void
		:ref:`setBackpropWeightScale<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a80a03e3e259441438f7ae3312104161f>`(double val) = 0;
	
		virtual
		void
		:ref:`setLayerSizes<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a79731c3fd3168e28eb3c3bba7a2caa94>`(:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` _layer_sizes) = 0;
	
		virtual
		void
		:ref:`setRpropDW0<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ae32498b59f9b8ce5737006ad49ad863e>`(double val) = 0;
	
		virtual
		void
		:ref:`setRpropDWMax<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a09d58b45d950729587577de3a7ed7142>`(double val) = 0;
	
		virtual
		void
		:ref:`setRpropDWMin<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a2d1c40a8eae6c7ad25554593a11d1e80>`(double val) = 0;
	
		virtual
		void
		:ref:`setRpropDWMinus<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a65350ee4fbb0e521e3d53dbd3101dadd>`(double val) = 0;
	
		virtual
		void
		:ref:`setRpropDWPlus<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a54b72c0446330effe6a003929d4aecbe>`(double val) = 0;
	
		virtual
		void
		:ref:`setTermCriteria<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ab6310aa2b5894ceb4e72008e62316182>`(:ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>` val) = 0;
	
		virtual
		void
		:ref:`setTrainMethod<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a4be093cfd2e743ee2f41e34e50cf3a54>`(
			int method,
			double param1 = 0,
			double param2 = 0
			) = 0;
	
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<ANN_MLP>
		:ref:`create<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a1c78150f5117029c53d6ad3cdd61af4b>`();
	
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<ANN_MLP>
		:ref:`load<doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ac24cc2e2fc5cd1dd74fd5da31886fbb7>`(const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& filepath);
	};

Inherited Members
-----------------

.. ref-code-block:: cpp
	:class: doxyrest-overview-inherited-code-block

	public:
		// enums
	
		enum :ref:`Flags<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af1ea864e1c19796e6264ebb3950c0b9a>`;

		// methods
	
		virtual
		void
		:ref:`clear<doxid-d1/d41/classcv_1_1_algorithm_1aec9c965448e4dc851d7cacd3abd84cd1>`();
	
		virtual
		bool
		:ref:`empty<doxid-d1/d41/classcv_1_1_algorithm_1ab6a18f1825475643e94381697d413972>`() const;
	
		virtual
		:ref:`String<doxid-dc/d0e/classcv_1_1_string>`
		:ref:`getDefaultName<doxid-d1/d41/classcv_1_1_algorithm_1a286fc82744ccab3d248aca44524266a9>`() const;
	
		virtual
		void
		:ref:`read<doxid-d1/d41/classcv_1_1_algorithm_1aef2ad3f4145bd6e8c3664eb1c4b5e1e6>`(const :ref:`FileNode<doxid-dc/d21/classcv_1_1_file_node>`& fn);
	
		virtual
		void
		:ref:`save<doxid-d1/d41/classcv_1_1_algorithm_1a0a880744bc4e3f45711444571df47d67>`(const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& filename) const;
	
		virtual
		void
		:ref:`write<doxid-d1/d41/classcv_1_1_algorithm_1a1f8ad7b8add515077367fb9949a174d2>`(:ref:`FileStorage<doxid-d9/df9/classcv_1_1_file_storage>`& fs) const;
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`load<doxid-d1/d41/classcv_1_1_algorithm_1a623841c33b58ea9c4847da04607e067b>`(
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& filename,
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& objname = :ref:`String<doxid-dc/d0e/classcv_1_1_string>`()
			);
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`loadFromString<doxid-d1/d41/classcv_1_1_algorithm_1a3ba305a10d02479c13cf7d169c321547>`(
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& strModel,
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& objname = :ref:`String<doxid-dc/d0e/classcv_1_1_string>`()
			);
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`read<doxid-d1/d41/classcv_1_1_algorithm_1ad8c591bacb34c485f5b7a250c314fc53>`(const :ref:`FileNode<doxid-dc/d21/classcv_1_1_file_node>`& fn);
	
		virtual
		float
		:ref:`calcError<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1aa6a71b1ee5b7fa0b07b55e77106cda13>`(
			const :ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<:ref:`TrainData<doxid-d3/daf/classcv_1_1ml_1_1_train_data>`>& data,
			bool test,
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` resp
			) const;
	
		virtual
		bool
		:ref:`empty<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a398fed53d9312b923e34aefd42f70e17>`() const;
	
		virtual
		int
		:ref:`getVarCount<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a783b92c436c7a2978e2d4bbb3cfb6e0c>`() const = 0;
	
		virtual
		bool
		:ref:`isClassifier<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a1121a835feedefdcdb8624966567aec6>`() const = 0;
	
		virtual
		bool
		:ref:`isTrained<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1aab380b59eb30b50254ef1b804774c4d8>`() const = 0;
	
		virtual
		float
		:ref:`predict<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a1a7e49e1febd10392452727498771bc1>`(
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` samples,
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` results = :ref:`noArray<doxid-dc/d84/group__core__basic_1gad9287b23bba2fed753b36ef561ae7346>`(),
			int flags = 0
			) const = 0;
	
		virtual
		bool
		:ref:`train<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af96a0e04f1677a835cc25263c7db3c0c>`(
			const :ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<:ref:`TrainData<doxid-d3/daf/classcv_1_1ml_1_1_train_data>`>& trainData,
			int flags = 0
			);
	
		virtual
		bool
		:ref:`train<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1aeb25a75f438864fb25af182fb4b1b96f>`(
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` samples,
			int layout,
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` responses
			);
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`train<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af93a21ea5866cd305936a03742f69af8>`(
			const :ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<:ref:`TrainData<doxid-d3/daf/classcv_1_1ml_1_1_train_data>`>& data,
			int flags = 0
			);

	protected:
		// methods
	
		void
		:ref:`writeFormat<doxid-d1/d41/classcv_1_1_algorithm_1a68eeca71617474ad3d4561786f0289d2>`(:ref:`FileStorage<doxid-d9/df9/classcv_1_1_file_storage>`& fs) const;

.. _details-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

Artificial Neural Networks - Multi-Layer Perceptrons.

Unlike many other models in ML that are constructed and trained at once, in the MLP model these steps are separated. First, a network with the specified topology is created using the non-default constructor or the method :ref:`ANN_MLP::create <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a1c78150f5117029c53d6ad3cdd61af4b>`. All the weights are set to zeros. Then, the network is trained using a set of input and output vectors. The training procedure can be repeated more than once, that is, the weights can be adjusted based on the new training data.

Additional flags for :ref:`StatModel::train <doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af96a0e04f1677a835cc25263c7db3c0c>` are available: :ref:`ANN_MLP::TrainFlags <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1afb51e414f22dd69f281a569145ccfad7>`.



.. rubric:: See also:

:ref:`Neural Networks <doxid-dc/dd6/ml_intro_1ml_intro_ann>`

Methods
-------

.. index:: pair: function; getBackpropMomentumScale
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a8a239f6fc2f3af77b5b8af14b85db6c2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getBackpropMomentumScale() const = 0

BPROP: Strength of the momentum term (the difference between weights on the 2 previous iterations). This parameter provides some inertia to smooth the random fluctuations of the weights. It can vary from 0 (the feature is disabled) to 1 and beyond. The value 0.1 or so is good enough. Default value is 0.1.



.. rubric:: See also:

:ref:`setBackpropMomentumScale <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a59fd3f49aba9418a96d44998deb68d00>`

.. index:: pair: function; getBackpropWeightScale
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a3f3118577f227f7f6ccc9d8c9a0496a4:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getBackpropWeightScale() const = 0

BPROP: Strength of the weight gradient term. The recommended value is about 0.1. Default value is 0.1.



.. rubric:: See also:

:ref:`setBackpropWeightScale <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a80a03e3e259441438f7ae3312104161f>`

.. index:: pair: function; getLayerSizes
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a6ddeca856c988d91ec7b7209e324e555:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	:ref:`cv::Mat<doxid-db/de6/classcv_1_1_mat>`
	getLayerSizes() const = 0

Integer vector specifying the number of neurons in each layer including the input and output layers. The very first element specifies the number of elements in the input layer. The last element - number of elements in the output layer.



.. rubric:: See also:

:ref:`setLayerSizes <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a79731c3fd3168e28eb3c3bba7a2caa94>`

.. index:: pair: function; getRpropDW0
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1aec1c80229df0d4552c0a922dd2caa935:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getRpropDW0() const = 0

RPROP: Initial value :math:`\Delta_0` of update-values :math:`\Delta_{ij}`. Default value is 0.1.



.. rubric:: See also:

:ref:`setRpropDW0 <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ae32498b59f9b8ce5737006ad49ad863e>`

.. index:: pair: function; getRpropDWMax
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a73f174d3f24d5715a4db57b23cdc066c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getRpropDWMax() const = 0

RPROP: Update-values upper limit :math:`\Delta_{max}`. It must be >1. Default value is 50.



.. rubric:: See also:

:ref:`setRpropDWMax <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a09d58b45d950729587577de3a7ed7142>`

.. index:: pair: function; getRpropDWMin
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a4c56d0ab068e59e8d7d1ad42a2ce386f:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getRpropDWMin() const = 0

RPROP: Update-values lower limit :math:`\Delta_{min}`. It must be positive. Default value is FLT_EPSILON.



.. rubric:: See also:

:ref:`setRpropDWMin <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a2d1c40a8eae6c7ad25554593a11d1e80>`

.. index:: pair: function; getRpropDWMinus
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a9db260e1b71d8865d1dd9856ea1b5124:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getRpropDWMinus() const = 0

RPROP: Decrease factor :math:`\eta^-`. It must be <1. Default value is 0.5.



.. rubric:: See also:

:ref:`setRpropDWMinus <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a65350ee4fbb0e521e3d53dbd3101dadd>`

.. index:: pair: function; getRpropDWPlus
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a71261559e73c1f307310bc5ae6491743:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	double
	getRpropDWPlus() const = 0

RPROP: Increase factor :math:`\eta^+`. It must be >1. Default value is 1.2.



.. rubric:: See also:

:ref:`setRpropDWPlus <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a54b72c0446330effe6a003929d4aecbe>`

.. index:: pair: function; getTermCriteria
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a1d38045b36f3f1363573ad0fd18b82ae:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	:ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>`
	getTermCriteria() const = 0

Termination criteria of the training algorithm. You can specify the maximum number of iterations (maxCount) and/or how much the error could change between the iterations to make the algorithm continue (epsilon). Default value is :ref:`TermCriteria <doxid-df/d8a/classcv_1_1_term_criteria>` (:ref:`TermCriteria::MAX_ITER <doxid-df/d8a/classcv_1_1_term_criteria_1a56fecdc291ccaba8aad27d67ccf72c57a56ca2bc5cd06345060a1c1c66a8fc06e>` + :ref:`TermCriteria::EPS <doxid-df/d8a/classcv_1_1_term_criteria_1a56fecdc291ccaba8aad27d67ccf72c57a857609e73e7028e638d2ea649f3b45d5>`, 1000, 0.01).



.. rubric:: See also:

:ref:`setTermCriteria <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ab6310aa2b5894ceb4e72008e62316182>`

.. index:: pair: function; getTrainMethod
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a97308c9dc08c75b5b82a4efd3b6118a6:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	getTrainMethod() const = 0

Returns current training method

.. index:: pair: function; setActivationFunction
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a16998f97db903c1c652e68f342240524:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setActivationFunction(
		int type,
		double param1 = 0,
		double param2 = 0
		) = 0

Initialize the activation function for each neuron. Currently the default and the only fully supported activation function is :ref:`ANN_MLP::SIGMOID_SYM <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ade71470ec8814021728f8b31b09773b0a90410002f1e243d35dca234f859f270e>`.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- type

		- The type of activation function. See :ref:`ANN_MLP::ActivationFunctions <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ade71470ec8814021728f8b31b09773b0>`.

	*
		- param1

		- The first parameter of the activation function, :math:`\alpha`. Default value is 0.

	*
		- param2

		- The second parameter of the activation function, :math:`\beta`. Default value is 0.

.. index:: pair: function; setBackpropMomentumScale
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a59fd3f49aba9418a96d44998deb68d00:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setBackpropMomentumScale(double val) = 0



.. rubric:: See also:

:ref:`getBackpropMomentumScale <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a8a239f6fc2f3af77b5b8af14b85db6c2>`

.. index:: pair: function; setBackpropWeightScale
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a80a03e3e259441438f7ae3312104161f:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setBackpropWeightScale(double val) = 0



.. rubric:: See also:

:ref:`getBackpropWeightScale <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a3f3118577f227f7f6ccc9d8c9a0496a4>`

.. index:: pair: function; setLayerSizes
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a79731c3fd3168e28eb3c3bba7a2caa94:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setLayerSizes(:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` _layer_sizes) = 0

Integer vector specifying the number of neurons in each layer including the input and output layers. The very first element specifies the number of elements in the input layer. The last element - number of elements in the output layer. Default value is empty :ref:`Mat <doxid-db/de6/classcv_1_1_mat>`.



.. rubric:: See also:

:ref:`getLayerSizes <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a6ddeca856c988d91ec7b7209e324e555>`

.. index:: pair: function; setRpropDW0
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ae32498b59f9b8ce5737006ad49ad863e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setRpropDW0(double val) = 0



.. rubric:: See also:

:ref:`getRpropDW0 <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1aec1c80229df0d4552c0a922dd2caa935>`

.. index:: pair: function; setRpropDWMax
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a09d58b45d950729587577de3a7ed7142:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setRpropDWMax(double val) = 0



.. rubric:: See also:

:ref:`getRpropDWMax <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a73f174d3f24d5715a4db57b23cdc066c>`

.. index:: pair: function; setRpropDWMin
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a2d1c40a8eae6c7ad25554593a11d1e80:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setRpropDWMin(double val) = 0



.. rubric:: See also:

:ref:`getRpropDWMin <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a4c56d0ab068e59e8d7d1ad42a2ce386f>`

.. index:: pair: function; setRpropDWMinus
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a65350ee4fbb0e521e3d53dbd3101dadd:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setRpropDWMinus(double val) = 0



.. rubric:: See also:

:ref:`getRpropDWMinus <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a9db260e1b71d8865d1dd9856ea1b5124>`

.. index:: pair: function; setRpropDWPlus
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a54b72c0446330effe6a003929d4aecbe:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setRpropDWPlus(double val) = 0



.. rubric:: See also:

:ref:`getRpropDWPlus <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a71261559e73c1f307310bc5ae6491743>`

.. index:: pair: function; setTermCriteria
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ab6310aa2b5894ceb4e72008e62316182:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setTermCriteria(:ref:`TermCriteria<doxid-df/d8a/classcv_1_1_term_criteria>` val) = 0



.. rubric:: See also:

:ref:`getTermCriteria <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a1d38045b36f3f1363573ad0fd18b82ae>`

.. index:: pair: function; setTrainMethod
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a4be093cfd2e743ee2f41e34e50cf3a54:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setTrainMethod(
		int method,
		double param1 = 0,
		double param2 = 0
		) = 0

Sets training method and common parameters.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- method

		- Default value is :ref:`ANN_MLP::RPROP <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181aded0d171ce651e6701a3426e192e04c9>`. See :ref:`ANN_MLP::TrainingMethods <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181>`.

	*
		- param1

		- passed to setRpropDW0 for :ref:`ANN_MLP::RPROP <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181aded0d171ce651e6701a3426e192e04c9>` and to setBackpropWeightScale for :ref:`ANN_MLP::BACKPROP <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181aaca348d78617e21b3fad5cc4c27e7889>`

	*
		- param2

		- passed to setRpropDWMin for :ref:`ANN_MLP::RPROP <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181aded0d171ce651e6701a3426e192e04c9>` and to setBackpropMomentumScale for :ref:`ANN_MLP::BACKPROP <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a012b34ee340b5d4d11b6844e12816181aaca348d78617e21b3fad5cc4c27e7889>`.

.. index:: pair: function; create
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1a1c78150f5117029c53d6ad3cdd61af4b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	static
	:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<ANN_MLP>
	create()

Creates empty model.

Use :ref:`StatModel::train <doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af96a0e04f1677a835cc25263c7db3c0c>` to train the model, :ref:`Algorithm::load <doxid-d1/d41/classcv_1_1_algorithm_1a623841c33b58ea9c4847da04607e067b>` <:ref:`ANN_MLP <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p>`>(filename) to load the pre-trained model. Note that the train method has optional flags: :ref:`ANN_MLP::TrainFlags <doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1afb51e414f22dd69f281a569145ccfad7>`.

.. index:: pair: function; load
.. _doxid-db/dd9/classcv_1_1ml_1_1_a_n_n___m_l_p_1ac24cc2e2fc5cd1dd74fd5da31886fbb7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	static
	:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<ANN_MLP>
	load(const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& filepath)

Loads and creates a serialized ANN from a file.

Use ANN::save to serialize and store an ANN to disk. Load the ANN from this file again, by calling this function with the path to the file.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- filepath

		- path to serialized ANN

