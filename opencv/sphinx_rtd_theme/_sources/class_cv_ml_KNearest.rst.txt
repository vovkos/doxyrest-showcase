.. index:: pair: class; cv::ml::KNearest
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest:

class cv::ml::KNearest
======================

.. toctree::
	:hidden:

	enum_cv_ml_KNearest_Types.rst

Overview
~~~~~~~~

The class implements K-Nearest Neighbors model. :ref:`More...<details-d9/dd0/classcv_1_1ml_1_1_k_nearest>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <ml.hpp>
	
	class KNearest: public :ref:`cv::ml::StatModel<doxid-d9/d36/classcv_1_1ml_1_1_stat_model>`
	{
	public:
		// enums
	
		enum :ref:`Types<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab654e56b6b5b0745022b7ca054ef2c1c>`;

		// methods
	
		virtual
		float
		:ref:`findNearest<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a312f975c24725b57200e221a97474b45>`(
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` samples,
			int k,
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` results,
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` neighborResponses = :ref:`noArray<doxid-dc/d84/group__core__basic_1gad9287b23bba2fed753b36ef561ae7346>`(),
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` dist = :ref:`noArray<doxid-dc/d84/group__core__basic_1gad9287b23bba2fed753b36ef561ae7346>`()
			) const = 0;
	
		virtual
		int
		:ref:`getAlgorithmType<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab942d8c101a08752dda72093a37f03e7>`() const = 0;
	
		virtual
		int
		:ref:`getDefaultK<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a402cb4d6027cc5f6cc0ff8699fcfb926>`() const = 0;
	
		virtual
		int
		:ref:`getEmax<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a113588d314f6aab1b2ba8c893f7c0658>`() const = 0;
	
		virtual
		bool
		:ref:`getIsClassifier<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a810997797296f788a070036fdd34d971>`() const = 0;
	
		virtual
		void
		:ref:`setAlgorithmType<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1aaa7548bc92dd0b43bb96e3c230e1997e>`(int val) = 0;
	
		virtual
		void
		:ref:`setDefaultK<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a0e4bbe73142a27fda05f73125b1ed5ef>`(int val) = 0;
	
		virtual
		void
		:ref:`setEmax<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a6b5975897bfc53ebc35b88414512f6f0>`(int val) = 0;
	
		virtual
		void
		:ref:`setIsClassifier<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1adf7439615632c768fa0bd448615e09e8>`(bool val) = 0;
	
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<KNearest>
		:ref:`create<doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab0ce3fa7a242f3418938592f4d935b81>`();
	};

Inherited Members
-----------------

.. ref-code-block:: cpp
	:class: doxyrest-overview-inherited-code-block

	public:
		// enums
	
		enum :ref:`Flags<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af1ea864e1c19796e6264ebb3950c0b9a>`;

		// methods
	
		virtual
		void
		:ref:`clear<doxid-d1/d41/classcv_1_1_algorithm_1aec9c965448e4dc851d7cacd3abd84cd1>`();
	
		virtual
		bool
		:ref:`empty<doxid-d1/d41/classcv_1_1_algorithm_1ab6a18f1825475643e94381697d413972>`() const;
	
		virtual
		:ref:`String<doxid-dc/d0e/classcv_1_1_string>`
		:ref:`getDefaultName<doxid-d1/d41/classcv_1_1_algorithm_1a286fc82744ccab3d248aca44524266a9>`() const;
	
		virtual
		void
		:ref:`read<doxid-d1/d41/classcv_1_1_algorithm_1aef2ad3f4145bd6e8c3664eb1c4b5e1e6>`(const :ref:`FileNode<doxid-dc/d21/classcv_1_1_file_node>`& fn);
	
		virtual
		void
		:ref:`save<doxid-d1/d41/classcv_1_1_algorithm_1a0a880744bc4e3f45711444571df47d67>`(const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& filename) const;
	
		virtual
		void
		:ref:`write<doxid-d1/d41/classcv_1_1_algorithm_1a1f8ad7b8add515077367fb9949a174d2>`(:ref:`FileStorage<doxid-d9/df9/classcv_1_1_file_storage>`& fs) const;
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`load<doxid-d1/d41/classcv_1_1_algorithm_1a623841c33b58ea9c4847da04607e067b>`(
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& filename,
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& objname = :ref:`String<doxid-dc/d0e/classcv_1_1_string>`()
			);
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`loadFromString<doxid-d1/d41/classcv_1_1_algorithm_1a3ba305a10d02479c13cf7d169c321547>`(
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& strModel,
			const :ref:`String<doxid-dc/d0e/classcv_1_1_string>`& objname = :ref:`String<doxid-dc/d0e/classcv_1_1_string>`()
			);
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`read<doxid-d1/d41/classcv_1_1_algorithm_1ad8c591bacb34c485f5b7a250c314fc53>`(const :ref:`FileNode<doxid-dc/d21/classcv_1_1_file_node>`& fn);
	
		virtual
		float
		:ref:`calcError<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1aa6a71b1ee5b7fa0b07b55e77106cda13>`(
			const :ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<:ref:`TrainData<doxid-d3/daf/classcv_1_1ml_1_1_train_data>`>& data,
			bool test,
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` resp
			) const;
	
		virtual
		bool
		:ref:`empty<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a398fed53d9312b923e34aefd42f70e17>`() const;
	
		virtual
		int
		:ref:`getVarCount<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a783b92c436c7a2978e2d4bbb3cfb6e0c>`() const = 0;
	
		virtual
		bool
		:ref:`isClassifier<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a1121a835feedefdcdb8624966567aec6>`() const = 0;
	
		virtual
		bool
		:ref:`isTrained<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1aab380b59eb30b50254ef1b804774c4d8>`() const = 0;
	
		virtual
		float
		:ref:`predict<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1a1a7e49e1febd10392452727498771bc1>`(
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` samples,
			:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` results = :ref:`noArray<doxid-dc/d84/group__core__basic_1gad9287b23bba2fed753b36ef561ae7346>`(),
			int flags = 0
			) const = 0;
	
		virtual
		bool
		:ref:`train<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af96a0e04f1677a835cc25263c7db3c0c>`(
			const :ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<:ref:`TrainData<doxid-d3/daf/classcv_1_1ml_1_1_train_data>`>& trainData,
			int flags = 0
			);
	
		virtual
		bool
		:ref:`train<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1aeb25a75f438864fb25af182fb4b1b96f>`(
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` samples,
			int layout,
			:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` responses
			);
	
		template <typename _Tp>
		static
		:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<_Tp>
		:ref:`train<doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af93a21ea5866cd305936a03742f69af8>`(
			const :ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<:ref:`TrainData<doxid-d3/daf/classcv_1_1ml_1_1_train_data>`>& data,
			int flags = 0
			);

	protected:
		// methods
	
		void
		:ref:`writeFormat<doxid-d1/d41/classcv_1_1_algorithm_1a68eeca71617474ad3d4561786f0289d2>`(:ref:`FileStorage<doxid-d9/df9/classcv_1_1_file_storage>`& fs) const;

.. _details-d9/dd0/classcv_1_1ml_1_1_k_nearest:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

The class implements K-Nearest Neighbors model.



.. rubric:: See also:

:ref:`K-Nearest Neighbors <doxid-dc/dd6/ml_intro_1ml_intro_knn>`

Methods
-------

.. index:: pair: function; findNearest
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a312f975c24725b57200e221a97474b45:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	float
	findNearest(
		:ref:`InputArray<doxid-dc/d84/group__core__basic_1ga353a9de602fe76c709e12074a6f362ba>` samples,
		int k,
		:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` results,
		:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` neighborResponses = :ref:`noArray<doxid-dc/d84/group__core__basic_1gad9287b23bba2fed753b36ef561ae7346>`(),
		:ref:`OutputArray<doxid-dc/d84/group__core__basic_1gaad17fda1d0f0d1ee069aebb1df2913c0>` dist = :ref:`noArray<doxid-dc/d84/group__core__basic_1gad9287b23bba2fed753b36ef561ae7346>`()
		) const = 0

Finds the neighbors and predicts responses for input vectors.

For each input vector (a row of the matrix samples), the method finds the k nearest neighbors. In case of regression, the predicted result is a mean value of the particular vector's neighbor responses. In case of classification, the class is determined by voting.

For each input vector, the neighbors are sorted by their distances to the vector.

In case of C++ interface you can use output pointers to empty matrices and the function will allocate memory itself.

If only a single input vector is passed, all output matrices are optional and the predicted value is returned by the method.

The function is parallelized with the TBB library.



.. rubric:: Parameters:

.. list-table::
	:widths: 20 80

	*
		- samples

		- Input samples stored by rows. It is a single-precision floating-point matrix of ``<number_of_samples> * k`` size.

	*
		- k

		- Number of used nearest neighbors. Should be greater than 1.

	*
		- results

		- Vector with results of prediction (regression or classification) for each input sample. It is a single-precision floating-point vector with ``<number_of_samples>`` elements.

	*
		- neighborResponses

		- Optional output values for corresponding neighbors. It is a single- precision floating-point matrix of ``<number_of_samples> * k`` size.

	*
		- dist

		- Optional output distances from the input vectors to the corresponding neighbors. It is a single-precision floating-point matrix of ``<number_of_samples> * k`` size.

.. index:: pair: function; getAlgorithmType
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab942d8c101a08752dda72093a37f03e7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	getAlgorithmType() const = 0

Algorithm type, one of :ref:`KNearest::Types <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab654e56b6b5b0745022b7ca054ef2c1c>`.



.. rubric:: See also:

:ref:`setAlgorithmType <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1aaa7548bc92dd0b43bb96e3c230e1997e>`

.. index:: pair: function; getDefaultK
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a402cb4d6027cc5f6cc0ff8699fcfb926:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	getDefaultK() const = 0

Default number of neighbors to use in predict method.



.. rubric:: See also:

:ref:`setDefaultK <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a0e4bbe73142a27fda05f73125b1ed5ef>`

.. index:: pair: function; getEmax
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a113588d314f6aab1b2ba8c893f7c0658:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	getEmax() const = 0

Parameter for KDTree implementation.



.. rubric:: See also:

:ref:`setEmax <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a6b5975897bfc53ebc35b88414512f6f0>`

.. index:: pair: function; getIsClassifier
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a810997797296f788a070036fdd34d971:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	bool
	getIsClassifier() const = 0

Whether classification or regression model should be trained.



.. rubric:: See also:

:ref:`setIsClassifier <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1adf7439615632c768fa0bd448615e09e8>`

.. index:: pair: function; setAlgorithmType
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1aaa7548bc92dd0b43bb96e3c230e1997e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setAlgorithmType(int val) = 0



.. rubric:: See also:

:ref:`getAlgorithmType <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab942d8c101a08752dda72093a37f03e7>`

.. index:: pair: function; setDefaultK
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a0e4bbe73142a27fda05f73125b1ed5ef:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setDefaultK(int val) = 0



.. rubric:: See also:

:ref:`getDefaultK <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a402cb4d6027cc5f6cc0ff8699fcfb926>`

.. index:: pair: function; setEmax
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a6b5975897bfc53ebc35b88414512f6f0:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setEmax(int val) = 0



.. rubric:: See also:

:ref:`getEmax <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a113588d314f6aab1b2ba8c893f7c0658>`

.. index:: pair: function; setIsClassifier
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1adf7439615632c768fa0bd448615e09e8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setIsClassifier(bool val) = 0



.. rubric:: See also:

:ref:`getIsClassifier <doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1a810997797296f788a070036fdd34d971>`

.. index:: pair: function; create
.. _doxid-d9/dd0/classcv_1_1ml_1_1_k_nearest_1ab0ce3fa7a242f3418938592f4d935b81:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	static
	:ref:`Ptr<doxid-d2/d56/structcv_1_1_ptr>`<KNearest>
	create()

Creates the empty model.

The static method creates empty KNearest classifier. It should be then trained using :ref:`StatModel::train <doxid-d9/d36/classcv_1_1ml_1_1_stat_model_1af96a0e04f1677a835cc25263c7db3c0c>` method.

