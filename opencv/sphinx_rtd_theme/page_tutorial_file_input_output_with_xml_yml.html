

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>File Input and Output using XML and YAML files &mdash; OpenCV Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/target-highlight.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/doxyrest-pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/doxyrest-sphinx_rtd_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to scan images, lookup tables and time measurement with OpenCV" href="page_tutorial_how_to_scan_images.html" />
    <link rel="prev" title="Discrete Fourier Transform" href="page_tutorial_discrete_fourier_transform.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> OpenCV Documentation
          

          
          </a>

          
            
            
              <div class="version">
                3.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="group_features2d.html">2D Features Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_viz.html">3D Visualizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_calib3d.html">Camera Calibration and 3D Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_flann.html">Clustering and Search in Multi-Dimensional Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_photo.html">Computational Photography</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_core.html">Core functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_highgui.html">High-level GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_imgcodecs.html">Image file reading and writing</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_imgproc.html">Image processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_stitching.html">Images stitching</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_ml.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_objdetect.html">Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_shape.html">Shape Distance and Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_superres.html">Super Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_video.html">Video Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_videoio.html">Video I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_videostab.html">Video Stabilization</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="page_citelist.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_cuda_intro.html">CUDA Module Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_imgproc_color_conversions.html">Color conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_deprecated.html">Deprecated List</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_ml_intro.html">Machine Learning Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="page_tutorial_root.html">OpenCV Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_features2d.html">2D Features framework (feature2d module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_calib3d.html">Camera calibration and 3D reconstruction (calib3d module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_photo.html">Computational photography (photo module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_gpu.html">GPU-Accelerated Computer Vision (cuda module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_highgui.html">High Level GUI and Media (highgui module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_imgcodecs.html">Image Input and Output (imgcodecs module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_stitching.html">Images stitching (stitching module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_introduction.html">Introduction to OpenCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_ml.html">Machine Learning (ml module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_objdetect.html">Object Detection (objdetect module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_viz.html">OpenCV Viz</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_ios.html">OpenCV iOS</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="page_tutorial_table_of_content_core.html">The Core Functionality (core module)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_adding_images.html">Adding (blending) two images using OpenCV</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_basic_geometric_drawing.html">Basic Drawing</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_basic_linear_transform.html">Changing the contrast and brightness of an image!</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_discrete_fourier_transform.html">Discrete Fourier Transform</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">File Input and Output using XML and YAML files</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_how_to_scan_images.html">How to scan images, lookup tables and time measurement with OpenCV</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_how_to_use_OpenCV_parallel_for_.html">How to use the OpenCV parallel_for_ to parallelize your code</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_how_to_use_ippa_conversion.html">Intel® IPP Asynchronous C/C++ library in OpenCV</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_interoperability_with_OpenCV_1.html">Interoperability with OpenCV 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_mat_mask_operations.html">Mask operations on matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_mat_the_basic_image_container.html">Mat - The Basic Image Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_mat_operations.html">Operations with images</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_random_generator_and_text.html">Random generator and text with OpenCV</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_videoio.html">Video Input and Output (videoio module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_video.html">Video analysis (video module)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_index.html">OpenCV modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_tutorial_py_root.html">OpenCV-Python Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_todo.html">Todo List</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_videoio_overview.html">Video I/O with OpenCV Overview</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example_contours2.cpp.html">contours2.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_convexhull.cpp.html">convexhull.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_cout_mat.cpp.html">cout_mat.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_demhist.cpp.html">demhist.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_distrans.cpp.html">distrans.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_edge.cpp.html">edge.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_ffilldemo.cpp.html">ffilldemo.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_filestorage.cpp.html">filestorage.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_fitellipse.cpp.html">fitellipse.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_grabcut.cpp.html">grabcut.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_houghcircles.cpp.html">houghcircles.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_houghlines.cpp.html">houghlines.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_kmeans.cpp.html">kmeans.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_laplace.cpp.html">laplace.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_lsd_lines.cpp.html">lsd_lines.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_minarea.cpp.html">minarea.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_morphology2.cpp.html">morphology2.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_pca.cpp.html">pca.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_polar_transforms.cpp.html">polar_transforms.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_segment_objects.cpp.html">segment_objects.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_watershed.cpp.html">watershed.cpp</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="global.html">Global Namespace</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OpenCV Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="page_tutorial_root.html">OpenCV Tutorials</a> &raquo;</li>
        
          <li><a href="page_tutorial_table_of_content_core.html">The Core Functionality (core module)</a> &raquo;</li>
        
      <li>File Input and Output using XML and YAML files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="file-input-and-output-using-xml-and-yaml-files">
<span id="doxid-dd-d74-tutorial-file-input-output-with-xml-yml"></span><span id="index-0"></span><h1>File Input and Output using XML and YAML files</h1>
<p class="rubric">Goal</p>
<p>You’ll find answers for the following questions:</p>
<ul class="simple">
<li>How to print and read text entries to a file and OpenCV using YAML or XML files?</li>
<li>How to do the same for OpenCV data structures?</li>
<li>How to do this for your data structures?</li>
<li>Usage of OpenCV data structures such as <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">cv::FileStorage</span></a>, <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node"><span class="std std-ref">cv::FileNode</span></a> or <a class="reference internal" href="class_cv_FileNodeIterator.html#doxid-d8-d08-classcv-1-1-file-node-iterator"><span class="std std-ref">cv::FileNodeIterator</span></a>.</li>
</ul>
<p class="rubric">Source code</p>
<p>You can <a class="reference external" href="https://github.com/opencv/opencv/tree/master/samples/cpp/tutorial_code/core/file_input_output/file_input_output.cpp">download this from here</a> or find it in the <code class="docutils literal notranslate"><span class="pre">samples/cpp/tutorial_code/core/file_input_output/file_input_output.cpp</span></code> of the OpenCV source code library.</p>
<p>Here’s a sample code of how to achieve all the stuff enumerated at the goal list.</p>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&lt;opencv2/core.hpp&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_cv.html#doxid-d2-d75-namespacecv"><span class="std std-ref">cv</span></a><span></span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_std.html#doxid-d8-dcc-namespacestd"><span class="std std-ref">std</span></a><span></span><span class="p">;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">help</span><span class="p">(</span><span class="kt">char</span><span class="o">**</span> <span class="n">av</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="n">av</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; shows the usage of the OpenCV serialization functionality.&quot;</span>         <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;usage: &quot;</span>                                                                      <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span>  <span class="n">av</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; outputfile.yml.gz&quot;</span>                                                 <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;The output file may be either XML (xml) or YAML (yml/yaml). You can even compress it by &quot;</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;specifying this in its extension like xml.gz yaml.gz etc... &quot;</span>                  <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;With FileStorage you can serialize objects in OpenCV by using the &lt;&lt; and &gt;&gt; operators&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;For example: - create a class and have it serialized&quot;</span>                         <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;             - use it to read and write matrices.&quot;</span>                            <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">class</span> <span class="n">MyData</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="n">MyData</span><span class="p">()</span> <span class="o">:</span> <span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">id</span><span class="p">()</span>
    <span class="p">{}</span>
    <span class="k">explicit</span> <span class="n">MyData</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="o">:</span> <span class="n">A</span><span class="p">(</span><span class="mi">97</span><span class="p">),</span> <span class="n">X</span><span class="p">(</span><a class="reference internal" href="group_core_utils.html#doxid-db-de0-group-core-utils-1ga677b89fae9308b340ddaebf0dba8455f"><span class="std std-ref">CV_PI</span></a><span></span><span class="p">),</span> <span class="n">id</span><span class="p">(</span><span class="s">&quot;mydata1234&quot;</span><span class="p">)</span> <span class="c1">// explicit to avoid implicit conversion</span>
    <span class="p">{}</span>
    <span class="kt">void</span> <span class="n">write</span><span class="p">(</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">FileStorage</span></a><span></span><span class="o">&amp;</span> <span class="n">fs</span><span class="p">)</span> <span class="k">const</span>                        <span class="c1">//Write serialization for this class</span>
    <span class="p">{</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;{&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;A&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">A</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;X&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">X</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;id&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">void</span> <span class="n">read</span><span class="p">(</span><span class="k">const</span> <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node"><span class="std std-ref">FileNode</span></a><span></span><span class="o">&amp;</span> <span class="n">node</span><span class="p">)</span>                          <span class="c1">//Read serialization for this class</span>
    <span class="p">{</span>
        <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">node</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">];</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">node</span><span class="p">[</span><span class="s">&quot;X&quot;</span><span class="p">];</span>
        <span class="n">id</span> <span class="o">=</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="n">node</span><span class="p">[</span><span class="s">&quot;id&quot;</span><span class="p">];</span>
    <span class="p">}</span>
<span class="k">public</span><span class="o">:</span>   <span class="c1">// Data Members</span>
    <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">X</span><span class="p">;</span>
    <span class="n">string</span> <span class="n">id</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">//These write and read functions must be defined for the serialization in FileStorage to work</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">write</span><span class="p">(</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">FileStorage</span></a><span></span><span class="o">&amp;</span> <span class="n">fs</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">,</span> <span class="k">const</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">x</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">fs</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">read</span><span class="p">(</span><span class="k">const</span> <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node"><span class="std std-ref">FileNode</span></a><span></span><span class="o">&amp;</span> <span class="n">node</span><span class="p">,</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">default_value</span> <span class="o">=</span> <span class="n">MyData</span><span class="p">()){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node-1a82d59aab4765da6140c238c54aadfa92"><span class="std std-ref">empty</span></a><span></span><span class="p">())</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">default_value</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="n">x</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// This function will print our custom class to the console</span>
<span class="k">static</span> <span class="n">ostream</span><span class="o">&amp;</span> <a class="reference internal" href="group_core_hal_intrin.html#doxid-df-d91-group-core-hal-intrin-1gacef821c50106276406bf4bc1cd7a059a"><span class="std std-ref">operator&lt;&lt;</span></a><span></span><span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">out</span><span class="p">,</span> <span class="k">const</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;{ id = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">.</span><span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, &quot;</span><span class="p">;</span>
    <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;X = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">.</span><span class="n">X</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, &quot;</span><span class="p">;</span>
    <span class="n">out</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;A = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">.</span><span class="n">A</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">out</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">ac</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">av</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ac</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">help</span><span class="p">(</span><span class="n">av</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">string</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">av</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">{</span> <span class="c1">//write</span>
        <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">R</span> <span class="o">=</span> <a class="reference internal" href="class_cv_Mat_.html#doxid-d9-de0-classcv-1-1-mat-1a992daefd1a256fbd40423a2cf77f42a1"><span class="std std-ref">Mat_&lt;uchar&gt;::eye</span></a><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
            <span class="n">T</span> <span class="o">=</span> <a class="reference internal" href="class_cv_Mat_.html#doxid-d9-de0-classcv-1-1-mat-1ab68de1358f5aedd6028269f77a9e841b"><span class="std std-ref">Mat_&lt;double&gt;::zeros</span></a><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
        <span class="n">MyData</span> <span class="nf">m</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>

        <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">FileStorage</span></a><span></span> <span class="n">fs</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <a class="reference internal" href="enum_cv_FileStorage_Mode.html#doxid-d9-df9-classcv-1-1-file-storage-1a973e41cb75ef6230412a567723b7482da747a241cefee7b8af34c3d804c864ad6"><span class="std std-ref">FileStorage::WRITE</span></a><span></span><span class="p">);</span>

        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;iterationNr&quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">100</span><span class="p">;</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;strings&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[&quot;</span><span class="p">;</span>                              <span class="c1">// text - string sequence</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;image1.jpg&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Awesomeness&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;../data/baboon.jpg&quot;</span><span class="p">;</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;]&quot;</span><span class="p">;</span>                                           <span class="c1">// close sequence</span>

        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Mapping&quot;</span><span class="p">;</span>                              <span class="c1">// text - mapping</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;{&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;One&quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span>        <span class="s">&quot;Two&quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>

        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;R&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">;</span>                                      <span class="c1">// cv::Mat</span>
        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;T&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">T</span><span class="p">;</span>

        <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;MyData&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">;</span>                                <span class="c1">// your own data structures</span>

        <span class="n">fs</span><span class="p">.</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1ad23d5415a06fb4bc97bfa034589b376e"><span class="std std-ref">release</span></a><span></span><span class="p">();</span>                                       <span class="c1">// explicit close</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Write Done.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="p">{</span><span class="c1">//read</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Reading: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">FileStorage</span></a><span></span> <span class="n">fs</span><span class="p">;</span>
        <span class="n">fs</span><span class="p">.</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1a14c2c18dc2e29999d03d52a0c24bd91c"><span class="std std-ref">open</span></a><span></span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <a class="reference internal" href="enum_cv_FileStorage_Mode.html#doxid-d9-df9-classcv-1-1-file-storage-1a973e41cb75ef6230412a567723b7482daa0dcc459c4d100c35ccfa9a643827bed"><span class="std std-ref">FileStorage::READ</span></a><span></span><span class="p">);</span>

        <span class="kt">int</span> <span class="n">itNr</span><span class="p">;</span>
        <span class="c1">//fs[&quot;iterationNr&quot;] &gt;&gt; itNr;</span>
        <span class="n">itNr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">fs</span><span class="p">[</span><span class="s">&quot;iterationNr&quot;</span><span class="p">];</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">itNr</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fs</span><span class="p">.</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1aa952c31f4e632595cd5ac107913f4fd1"><span class="std std-ref">isOpened</span></a><span></span><span class="p">())</span>
        <span class="p">{</span>
            <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Failed to open &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">filename</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
            <span class="n">help</span><span class="p">(</span><span class="n">av</span><span class="p">);</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node"><span class="std std-ref">FileNode</span></a><span></span> <span class="n">n</span> <span class="o">=</span> <span class="n">fs</span><span class="p">[</span><span class="s">&quot;strings&quot;</span><span class="p">];</span>                         <span class="c1">// Read string sequence - Get node</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">.</span><a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node-1ad0fd448e25719a94320ebe574b87f997"><span class="std std-ref">type</span></a><span></span><span class="p">()</span> <span class="o">!=</span> <a class="reference internal" href="enum_cv_FileNode_Type.html#doxid-dc-d21-classcv-1-1-file-node-1a8fe1d2aa050e6909b978f4df3529066eaa359c2282183738d11a665035a1a67bb"><span class="std std-ref">FileNode::SEQ</span></a><span></span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;strings is not a sequence! FAIL&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>

        <a class="reference internal" href="class_cv_FileNodeIterator.html#doxid-d8-d08-classcv-1-1-file-node-iterator"><span class="std std-ref">FileNodeIterator</span></a><span></span> <span class="n">it</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node-1a0f299820227506079f5b9013dd8c3558"><span class="std std-ref">begin</span></a><span></span><span class="p">(),</span> <span class="n">it_end</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node-1a58b033e34726eb73f0238a1bfbe0c8e9"><span class="std std-ref">end</span></a><span></span><span class="p">();</span> <span class="c1">// Go through the node</span>
        <span class="k">for</span> <span class="p">(;</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">it_end</span><span class="p">;</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">*</span><span class="n">it</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


        <span class="n">n</span> <span class="o">=</span> <span class="n">fs</span><span class="p">[</span><span class="s">&quot;Mapping&quot;</span><span class="p">];</span>                                <span class="c1">// Read mappings from a sequence</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Two  &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">n</span><span class="p">[</span><span class="s">&quot;Two&quot;</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;; &quot;</span><span class="p">;</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;One  &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">n</span><span class="p">[</span><span class="s">&quot;One&quot;</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>


        <span class="n">MyData</span> <span class="n">m</span><span class="p">;</span>
        <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">R</span><span class="p">,</span> <span class="n">T</span><span class="p">;</span>

        <span class="n">fs</span><span class="p">[</span><span class="s">&quot;R&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>                                      <span class="c1">// Read cv::Mat</span>
        <span class="n">fs</span><span class="p">[</span><span class="s">&quot;T&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
        <span class="n">fs</span><span class="p">[</span><span class="s">&quot;MyData&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>                                 <span class="c1">// Read your own structure_</span>

        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
            <span class="o">&lt;&lt;</span> <span class="s">&quot;R = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">R</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;T = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">T</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;MyData = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

        <span class="c1">//Show default behavior for non existing nodes</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Attempt to read NonExisting (should initialize the data structure with its default).&quot;</span><span class="p">;</span>
        <span class="n">fs</span><span class="p">[</span><span class="s">&quot;NonExisting&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;NonExisting = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Tip: Open up &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">filename</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; with a text editor to see the serialized data.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p class="rubric">Explanation</p>
<p>Here we talk only about XML and YAML file inputs. Your output (and its respective input) file may have only one of these extensions and the structure coming from this. They are two kinds of data structures you may serialize: <em>mappings</em> (like the STL map) and <em>element sequence</em> (like the STL vector). The difference between these is that in a map every element has a unique name through what you may access it. For sequences you need to go through them to query a specific item.</p>
<ol class="arabic">
<li><p class="first"><strong>XML/YAML File Open and Close.</strong> Before you write any content to such file you need to open it and at the end to close it. The XML/YAML data structure in OpenCV is <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">cv::FileStorage</span></a>. To specify that this structure to which file binds on your hard drive you can use either its constructor or the <em>open()</em> function of this:</p>
<pre class="highlight literal-block">
<span></span><span class="n">string</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;I.xml&quot;</span><span class="p">;</span>
<span class="n">FileStorage</span> <span class="nf">fs</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">FileStorage</span><span class="o">::</span><span class="n">WRITE</span><span class="p">);</span>
<span class="c1">//...</span>
<span class="n">fs</span><span class="p">.</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1a14c2c18dc2e29999d03d52a0c24bd91c"><span class="std std-ref">open</span></a><span></span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">FileStorage</span><span class="o">::</span><span class="n">READ</span><span class="p">);</span>
</pre>
<p>Either one of this you use the second argument is a constant specifying the type of operations you’ll be able to on them: WRITE, READ or APPEND. The extension specified in the file name also determinates the output format that will be used. The output may be even compressed if you specify an extension such as *.xml.gz*.</p>
<p>The file automatically closes when the <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">cv::FileStorage</span></a> objects is destroyed. However, you may explicitly call for this by using the <em>release</em> function:</p>
<pre class="highlight literal-block">
<span></span><span class="n">fs</span><span class="p">.</span><a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1ad23d5415a06fb4bc97bfa034589b376e"><span class="std std-ref">release</span></a><span></span><span class="p">();</span>                                       <span class="c1">// explicit close</span>
</pre>
</li>
<li><p class="first"><strong>Input and Output of text and numbers.</strong> The data structure uses the same &lt;&lt; output operator that the STL library. For outputting any type of data structure we need first to specify its name. We do this by just simply printing out the name of this. For basic types you may follow this with the print of the value :</p>
<pre class="highlight literal-block">
<span></span><span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;iterationNr&quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">100</span><span class="p">;</span>
</pre>
<p>Reading in is a simple addressing (via the [] operator) and casting operation or a read via the &gt;&gt; operator :</p>
<pre class="highlight literal-block">
<span></span><span class="kt">int</span> <span class="n">itNr</span><span class="p">;</span>
<span class="n">fs</span><span class="p">[</span><span class="s">&quot;iterationNr&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">itNr</span><span class="p">;</span>
<span class="n">itNr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">fs</span><span class="p">[</span><span class="s">&quot;iterationNr&quot;</span><span class="p">];</span>
</pre>
</li>
<li><p class="first"><strong>Input/Output of OpenCV Data structures.</strong> Well these behave exactly just as the basic C++ types:</p>
<pre class="highlight literal-block">
<span></span><span class="n">Mat</span> <span class="n">R</span> <span class="o">=</span> <a class="reference internal" href="class_cv_Mat_.html#doxid-d9-de0-classcv-1-1-mat-1a992daefd1a256fbd40423a2cf77f42a1"><span class="std std-ref">Mat_&lt;uchar &gt;::eye</span></a><span></span>  <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
    <span class="n">T</span> <span class="o">=</span> <a class="reference internal" href="class_cv_Mat_.html#doxid-d9-de0-classcv-1-1-mat-1ab68de1358f5aedd6028269f77a9e841b"><span class="std std-ref">Mat_&lt;double&gt;::zeros</span></a><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;R&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">R</span><span class="p">;</span>                                      <span class="c1">// Write cv::Mat</span>
<span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;T&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">T</span><span class="p">;</span>

<span class="n">fs</span><span class="p">[</span><span class="s">&quot;R&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">R</span><span class="p">;</span>                                      <span class="c1">// Read cv::Mat</span>
<span class="n">fs</span><span class="p">[</span><span class="s">&quot;T&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
</pre>
</li>
<li><p class="first"><strong>Input/Output of vectors (arrays) and associative maps.</strong> As I mentioned beforehand, we can output maps and sequences (array, vector) too. Again we first print the name of the variable and then we have to specify if our output is either a sequence or map.</p>
<p>For sequence before the first element print the “[” character and after the last one the “]” character:</p>
<pre class="highlight literal-block">
<span></span><span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;strings&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[&quot;</span><span class="p">;</span>                              <span class="c1">// text - string sequence</span>
<span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;image1.jpg&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Awesomeness&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;baboon.jpg&quot;</span><span class="p">;</span>
<span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;]&quot;</span><span class="p">;</span>                                           <span class="c1">// close sequence</span>
</pre>
<p>For maps the drill is the same however now we use the “{” and “}” delimiter characters:</p>
<pre class="highlight literal-block">
<span></span><span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Mapping&quot;</span><span class="p">;</span>                              <span class="c1">// text - mapping</span>
<span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;{&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;One&quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">fs</span> <span class="o">&lt;&lt;</span>        <span class="s">&quot;Two&quot;</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>
</pre>
<p>To read from these we use the <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node"><span class="std std-ref">cv::FileNode</span></a> and the <a class="reference internal" href="class_cv_FileNodeIterator.html#doxid-d8-d08-classcv-1-1-file-node-iterator"><span class="std std-ref">cv::FileNodeIterator</span></a> data structures. The [] operator of the <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage"><span class="std std-ref">cv::FileStorage</span></a> class returns a <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node"><span class="std std-ref">cv::FileNode</span></a> data type. If the node is sequential we can use the <a class="reference internal" href="class_cv_FileNodeIterator.html#doxid-d8-d08-classcv-1-1-file-node-iterator"><span class="std std-ref">cv::FileNodeIterator</span></a> to iterate through the items:</p>
<pre class="highlight literal-block">
<span></span><span class="n">FileNode</span> <span class="n">n</span> <span class="o">=</span> <span class="n">fs</span><span class="p">[</span><span class="s">&quot;strings&quot;</span><span class="p">];</span>                         <span class="c1">// Read string sequence - Get node</span>
<span class="k">if</span> <span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">type</span><span class="p">()</span> <span class="o">!=</span> <span class="n">FileNode</span><span class="o">::</span><span class="n">SEQ</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;strings is not a sequence! FAIL&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">FileNodeIterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">it_end</span> <span class="o">=</span> <span class="n">n</span><span class="p">.</span><span class="n">end</span><span class="p">();</span> <span class="c1">// Go through the node</span>
<span class="k">for</span> <span class="p">(;</span> <span class="n">it</span> <span class="o">!=</span> <span class="n">it_end</span><span class="p">;</span> <span class="o">++</span><span class="n">it</span><span class="p">)</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="o">*</span><span class="n">it</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre>
<p>For maps you can use the [] operator again to acces the given item (or the &gt;&gt; operator too):</p>
<pre class="highlight literal-block">
<span></span><span class="n">n</span> <span class="o">=</span> <span class="n">fs</span><span class="p">[</span><span class="s">&quot;Mapping&quot;</span><span class="p">];</span>                                <span class="c1">// Read mappings from a sequence</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Two  &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">n</span><span class="p">[</span><span class="s">&quot;Two&quot;</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;; &quot;</span><span class="p">;</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;One  &quot;</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">n</span><span class="p">[</span><span class="s">&quot;One&quot;</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre>
</li>
<li><p class="first"><strong>Read and write your own data structures.</strong> Suppose you have a data structure such as:</p>
<pre class="highlight literal-block">
<span></span><span class="k">class</span> <span class="n">MyData</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
      <span class="n">MyData</span><span class="p">()</span> <span class="o">:</span> <span class="n">A</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">id</span><span class="p">()</span> <span class="p">{}</span>
<span class="k">public</span><span class="o">:</span>   <span class="c1">// Data Members</span>
   <span class="kt">int</span> <span class="n">A</span><span class="p">;</span>
   <span class="kt">double</span> <span class="n">X</span><span class="p">;</span>
   <span class="n">string</span> <span class="n">id</span><span class="p">;</span>
<span class="p">};</span>
</pre>
<p>It’s possible to serialize this through the OpenCV I/O XML/YAML interface (just as in case of the OpenCV data structures) by adding a read and a write function inside and outside of your class. For the inside part:</p>
<pre class="highlight literal-block">
<span></span><span class="kt">void</span> <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1a26447446dd3fa0644684a045e16399fe"><span class="std std-ref">write</span></a><span></span><span class="p">(</span><span class="n">FileStorage</span><span class="o">&amp;</span> <span class="n">fs</span><span class="p">)</span> <span class="k">const</span>                        <span class="c1">//Write serialization for this class</span>
<span class="p">{</span>
  <span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;{&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;A&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">A</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;X&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">X</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;id&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">id</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;}&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node-1ab24433dde37f770766481a91983e5f44"><span class="std std-ref">read</span></a><span></span><span class="p">(</span><span class="k">const</span> <span class="n">FileNode</span><span class="o">&amp;</span> <span class="n">node</span><span class="p">)</span>                          <span class="c1">//Read serialization for this class</span>
<span class="p">{</span>
  <span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">node</span><span class="p">[</span><span class="s">&quot;A&quot;</span><span class="p">];</span>
  <span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">node</span><span class="p">[</span><span class="s">&quot;X&quot;</span><span class="p">];</span>
  <span class="n">id</span> <span class="o">=</span> <span class="p">(</span><span class="n">string</span><span class="p">)</span><span class="n">node</span><span class="p">[</span><span class="s">&quot;id&quot;</span><span class="p">];</span>
<span class="p">}</span>
</pre>
<p>Then you need to add the following functions definitions outside the class:</p>
<pre class="highlight literal-block">
<span></span><span class="kt">void</span> <a class="reference internal" href="class_cv_FileStorage.html#doxid-d9-df9-classcv-1-1-file-storage-1a26447446dd3fa0644684a045e16399fe"><span class="std std-ref">write</span></a><span></span><span class="p">(</span><span class="n">FileStorage</span><span class="o">&amp;</span> <span class="n">fs</span><span class="p">,</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="p">,</span> <span class="k">const</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
<span class="n">x</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">fs</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <a class="reference internal" href="class_cv_FileNode.html#doxid-dc-d21-classcv-1-1-file-node-1ab24433dde37f770766481a91983e5f44"><span class="std std-ref">read</span></a><span></span><span class="p">(</span><span class="k">const</span> <span class="n">FileNode</span><span class="o">&amp;</span> <span class="n">node</span><span class="p">,</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="k">const</span> <span class="n">MyData</span><span class="o">&amp;</span> <span class="n">default_value</span> <span class="o">=</span> <span class="n">MyData</span><span class="p">())</span>
<span class="p">{</span>
<span class="k">if</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">default_value</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">x</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">node</span><span class="p">);</span>
<span class="p">}</span>
</pre>
<p>Here you can observe that in the read section we defined what happens if the user tries to read a non-existing node. In this case we just return the default initialization value, however a more verbose solution would be to return for instance a minus one value for an object ID.</p>
<p>Once you added these four functions use the &gt;&gt; operator for write and the &lt;&lt; operator for read:</p>
<pre class="highlight literal-block">
<span></span><span class="n">MyData</span> <span class="nf">m</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">fs</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;MyData&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">m</span><span class="p">;</span>                                <span class="c1">// your own data structures</span>
<span class="n">fs</span><span class="p">[</span><span class="s">&quot;MyData&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>                                 <span class="c1">// Read your own structure_</span>
</pre>
<p>Or to try out reading a non-existing read:</p>
<pre class="highlight literal-block">
<span></span><span class="n">fs</span><span class="p">[</span><span class="s">&quot;NonExisting&quot;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">m</span><span class="p">;</span>   <span class="c1">// Do not add a fs &lt;&lt; &quot;NonExisting&quot; &lt;&lt; m command for this to work</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;NonExisting = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">m</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre>
</li>
</ol>
<p class="rubric">Result</p>
<p>Well mostly we just print out the defined numbers. On the screen of your console you could see:</p>
<pre class="highlight literal-block">
<span></span><span class="n">Write</span> <span class="n">Done</span><span class="p">.</span>

<span class="nl">Reading</span><span class="p">:</span>
<span class="mi">100</span><span class="n">image1</span><span class="p">.</span><span class="n">jpg</span>
<span class="n">Awesomeness</span>
<span class="n">baboon</span><span class="p">.</span><span class="n">jpg</span>
<span class="n">Two</span>  <span class="mi">2</span><span class="p">;</span> <span class="n">One</span>  <span class="mi">1</span>


<span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span>
  <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">MyData</span> <span class="o">=</span>
<span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="n">mydata1234</span><span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="mf">3.14159</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">97</span><span class="p">}</span>

<span class="n">Attempt</span> <span class="n">to</span> <span class="n">read</span> <span class="n">NonExisting</span> <span class="p">(</span><span class="n">should</span> <span class="n">initialize</span> <span class="n">the</span> <span class="n">data</span> <span class="n">structure</span> <span class="n">with</span> <span class="n">its</span> <span class="k">default</span><span class="p">).</span>
<span class="n">NonExisting</span> <span class="o">=</span>
<span class="p">{</span> <span class="n">id</span> <span class="o">=</span> <span class="p">,</span> <span class="n">X</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="mi">0</span><span class="p">}</span>

<span class="nl">Tip</span><span class="p">:</span> <span class="n">Open</span> <span class="n">up</span> <span class="n">output</span><span class="p">.</span><span class="n">xml</span> <span class="n">with</span> <span class="n">a</span> <span class="n">text</span> <span class="n">editor</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="n">serialized</span> <span class="n">data</span><span class="p">.</span>
</pre>
<p>Nevertheless, it’s much more interesting what you may see in the output xml file:</p>
<pre class="highlight literal-block">
<span></span><span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">&quot;1.0&quot;</span><span class="o">?&gt;</span>
<span class="o">&lt;</span><span class="n">opencv_storage</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">iterationNr</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;/</span><span class="n">iterationNr</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">strings</span><span class="o">&gt;</span>
  <span class="n">image1</span><span class="p">.</span><span class="n">jpg</span> <span class="n">Awesomeness</span> <span class="n">baboon</span><span class="p">.</span><span class="n">jpg</span><span class="o">&lt;/</span><span class="n">strings</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">Mapping</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">One</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">One</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">Two</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">Two</span><span class="o">&gt;&lt;/</span><span class="n">Mapping</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">R</span> <span class="n">type_id</span><span class="o">=</span><span class="s">&quot;opencv-matrix&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">rows</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">rows</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">cols</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">cols</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">dt</span><span class="o">&gt;</span><span class="n">u</span><span class="o">&lt;/</span><span class="n">dt</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">data</span><span class="o">&gt;</span>
    <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="o">&lt;/</span><span class="n">data</span><span class="o">&gt;&lt;/</span><span class="n">R</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">T</span> <span class="n">type_id</span><span class="o">=</span><span class="s">&quot;opencv-matrix&quot;</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">rows</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">rows</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">cols</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">cols</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">dt</span><span class="o">&gt;</span><span class="n">d</span><span class="o">&lt;/</span><span class="n">dt</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">data</span><span class="o">&gt;</span>
    <span class="mf">0.</span> <span class="mf">0.</span> <span class="mf">0.</span><span class="o">&lt;/</span><span class="n">data</span><span class="o">&gt;&lt;/</span><span class="n">T</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">MyData</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span><span class="mi">97</span><span class="o">&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">X</span><span class="o">&gt;</span><span class="mf">3.1415926535897931e+000</span><span class="o">&lt;/</span><span class="n">X</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="n">id</span><span class="o">&gt;</span><span class="n">mydata1234</span><span class="o">&lt;/</span><span class="n">id</span><span class="o">&gt;&lt;/</span><span class="n">MyData</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">opencv_storage</span><span class="o">&gt;</span>
</pre>
<p>Or the YAML file:</p>
<pre class="highlight literal-block">
<span></span><span class="o">%</span><span class="nl">YAML</span><span class="p">:</span><span class="mf">1.0</span>
<span class="nl">iterationNr</span><span class="p">:</span> <span class="mi">100</span>
<span class="nl">strings</span><span class="p">:</span>
   <span class="o">-</span> <span class="s">&quot;image1.jpg&quot;</span>
   <span class="o">-</span> <span class="n">Awesomeness</span>
   <span class="o">-</span> <span class="s">&quot;baboon.jpg&quot;</span>
<span class="nl">Mapping</span><span class="p">:</span>
   <span class="nl">One</span><span class="p">:</span> <span class="mi">1</span>
   <span class="nl">Two</span><span class="p">:</span> <span class="mi">2</span>
<span class="nl">R</span><span class="p">:</span> <span class="o">!!</span><span class="n">opencv</span><span class="o">-</span><span class="n">matrix</span>
   <span class="nl">rows</span><span class="p">:</span> <span class="mi">3</span>
   <span class="nl">cols</span><span class="p">:</span> <span class="mi">3</span>
   <span class="nl">dt</span><span class="p">:</span> <span class="n">u</span>
   <span class="nl">data</span><span class="p">:</span> <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">]</span>
<span class="nl">T</span><span class="p">:</span> <span class="o">!!</span><span class="n">opencv</span><span class="o">-</span><span class="n">matrix</span>
   <span class="nl">rows</span><span class="p">:</span> <span class="mi">3</span>
   <span class="nl">cols</span><span class="p">:</span> <span class="mi">1</span>
   <span class="nl">dt</span><span class="p">:</span> <span class="n">d</span>
   <span class="nl">data</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">]</span>
<span class="nl">MyData</span><span class="p">:</span>
   <span class="nl">A</span><span class="p">:</span> <span class="mi">97</span>
   <span class="nl">X</span><span class="p">:</span> <span class="mf">3.1415926535897931e+000</span>
   <span class="nl">id</span><span class="p">:</span> <span class="n">mydata1234</span>
</pre>
<p>You may observe a runtime instance of this on the <a class="reference external" href="https://www.youtube.com/watch?v=A4yqVnByMMM">YouTube here</a>.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="page_tutorial_how_to_scan_images.html" class="btn btn-neutral float-right" title="How to scan images, lookup tables and time measurement with OpenCV" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="page_tutorial_discrete_fourier_transform.html" class="btn btn-neutral float-left" title="Discrete Fourier Transform" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1999-2017, OpenCV Maintainers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>