

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>More Morphology Transformations &mdash; OpenCV Documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript" src="_static/target-highlight.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/doxyrest-pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/doxyrest-sphinx_rtd_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Point Polygon Test" href="page_tutorial_point_polygon_test.html" />
    <link rel="prev" title="Making your own linear filters!" href="page_tutorial_filter_2d.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> OpenCV Documentation
          

          
          </a>

          
            
            
              <div class="version">
                3.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="group_features2d.html">2D Features Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_viz.html">3D Visualizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_calib3d.html">Camera Calibration and 3D Reconstruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_flann.html">Clustering and Search in Multi-Dimensional Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_photo.html">Computational Photography</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_core.html">Core functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_highgui.html">High-level GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_imgcodecs.html">Image file reading and writing</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_imgproc.html">Image processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_stitching.html">Images stitching</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_ml.html">Machine Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_objdetect.html">Object Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_shape.html">Shape Distance and Matching</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_superres.html">Super Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_video.html">Video Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_videoio.html">Video I/O</a></li>
<li class="toctree-l1"><a class="reference internal" href="group_videostab.html">Video Stabilization</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="page_citelist.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_cuda_intro.html">CUDA Module Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_imgproc_color_conversions.html">Color conversions</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_deprecated.html">Deprecated List</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_ml_intro.html">Machine Learning Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="page_tutorial_root.html">OpenCV Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_features2d.html">2D Features framework (feature2d module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_calib3d.html">Camera calibration and 3D reconstruction (calib3d module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_photo.html">Computational photography (photo module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_gpu.html">GPU-Accelerated Computer Vision (cuda module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_highgui.html">High Level GUI and Media (highgui module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_imgcodecs.html">Image Input and Output (imgcodecs module)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="page_tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_copyMakeBorder.html">Adding borders to your images</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_warp_affine.html">Affine Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_back_projection.html">Back Projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_threshold.html">Basic Thresholding Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_canny_detector.html">Canny Edge Detector</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_hull.html">Convex Hull</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_bounding_rects_circles.html">Creating Bounding boxes and circles for contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_bounding_rotated_ellipses.html">Creating Bounding rotated boxes and ellipses for contours</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_erosion_dilatation.html">Eroding and Dilating</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_moprh_lines_detection.html">Extract horizontal and vertical lines by using morphological operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_find_contours.html">Finding contours in your image</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_histogram_calculation.html">Histogram Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_histogram_comparison.html">Histogram Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_histogram_equalization.html">Histogram Equalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_hitOrMiss.html">Hit-or-Miss</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_hough_circle.html">Hough Circle Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_hough_lines.html">Hough Line Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_moments.html">Image Moments</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_pyramids.html">Image Pyramids</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_distance_transform.html">Image Segmentation with Distance Transform and Watershed Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_laplace_operator.html">Laplace Operator</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_filter_2d.html">Making your own linear filters!</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">More Morphology Transformations</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_point_polygon_test.html">Point Polygon Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_remap.html">Remapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_gausian_median_blur_bilateral_filter.html">Smoothing Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_sobel_derivatives.html">Sobel Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_template_matching.html">Template Matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="page_tutorial_threshold_inRange.html">Thresholding Operations using inRange</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_stitching.html">Images stitching (stitching module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_introduction.html">Introduction to OpenCV</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_ml.html">Machine Learning (ml module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_objdetect.html">Object Detection (objdetect module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_viz.html">OpenCV Viz</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_ios.html">OpenCV iOS</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_core.html">The Core Functionality (core module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_videoio.html">Video Input and Output (videoio module)</a></li>
<li class="toctree-l2"><a class="reference internal" href="page_tutorial_table_of_content_video.html">Video analysis (video module)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="page_index.html">OpenCV modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_tutorial_py_root.html">OpenCV-Python Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_todo.html">Todo List</a></li>
<li class="toctree-l1"><a class="reference internal" href="page_videoio_overview.html">Video I/O with OpenCV Overview</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="example_contours2.cpp.html">contours2.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_convexhull.cpp.html">convexhull.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_cout_mat.cpp.html">cout_mat.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_demhist.cpp.html">demhist.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_distrans.cpp.html">distrans.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_edge.cpp.html">edge.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_ffilldemo.cpp.html">ffilldemo.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_filestorage.cpp.html">filestorage.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_fitellipse.cpp.html">fitellipse.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_grabcut.cpp.html">grabcut.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_houghcircles.cpp.html">houghcircles.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_houghlines.cpp.html">houghlines.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_kmeans.cpp.html">kmeans.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_laplace.cpp.html">laplace.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_lsd_lines.cpp.html">lsd_lines.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_minarea.cpp.html">minarea.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_morphology2.cpp.html">morphology2.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_pca.cpp.html">pca.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_polar_transforms.cpp.html">polar_transforms.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_segment_objects.cpp.html">segment_objects.cpp</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_watershed.cpp.html">watershed.cpp</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="global.html">Global Namespace</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">OpenCV Documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="page_tutorial_root.html">OpenCV Tutorials</a> &raquo;</li>
        
          <li><a href="page_tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a> &raquo;</li>
        
      <li>More Morphology Transformations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="more-morphology-transformations">
<span id="doxid-d3-dbe-tutorial-opening-closing-hats"></span><span id="index-0"></span><h1>More Morphology Transformations</h1>
<p class="rubric">Goal</p>
<p>In this tutorial you will learn how to:</p>
<ul class="simple">
<li>Use the OpenCV function <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1ga67493776e3ad1a3df63883829375201f"><span class="std std-ref">cv::morphologyEx</span></a> to apply Morphological Transformation such as:<ul>
<li>Opening</li>
<li>Closing</li>
<li>Morphological Gradient</li>
<li>Top Hat</li>
<li>Black Hat</li>
</ul>
</li>
</ul>
<p class="rubric">Theory</p>
<p>The explanation below belongs to the book <strong>Learning OpenCV</strong> by Bradski and Kaehler.</p>
<p>In the previous tutorial we covered two basic Morphology operations:</p>
<ul class="simple">
<li>Erosion</li>
<li>Dilation.</li>
</ul>
<p>Based on these two we can effectuate more sophisticated transformations to our images. Here we discuss briefly 5 operations offered by OpenCV:</p>
<p class="rubric">Opening</p>
<ul>
<li><p class="first">It is obtained by the erosion of an image followed by a dilation.</p>
<div class="math notranslate nohighlight">
\[dst = open( src, element) = dilate( erode( src, element ) )\]</div>
</li>
<li><p class="first">Useful for removing small objects (it is assumed that the objects are bright on a dark foreground)</p>
</li>
<li><p class="first">For instance, check out the example below. The image at the left is the original and the image at the right is the result after applying the opening transformation. We can observe that the small spaces in the corners of the letter tend to dissapear.</p>
<img alt="_images/Morphology_2_Tutorial_Theory_Opening.png" src="_images/Morphology_2_Tutorial_Theory_Opening.png" />
</li>
</ul>
<p>For the sake of clarity, we have performed the opening operation (<code class="docutils literal notranslate"><span class="pre">7x7</span></code> rectangular structuring element) on the same original image but inverted such as the object in white is now the letter.</p>
<img alt="Left image: original image inverted, right image: resulting opening" src="_images/Morphology_2_Tutorial_Theory_Opening_2.png" />
<p class="rubric">Closing</p>
<ul>
<li><p class="first">It is obtained by the dilation of an image followed by an erosion.</p>
<div class="math notranslate nohighlight">
\[dst = close( src, element ) = erode( dilate( src, element ) )\]</div>
</li>
<li><p class="first">Useful to remove small holes (dark regions).</p>
<img alt="_images/Morphology_2_Tutorial_Theory_Closing.png" src="_images/Morphology_2_Tutorial_Theory_Closing.png" />
</li>
</ul>
<p>On the inverted image, we have performed the closing operation (<code class="docutils literal notranslate"><span class="pre">7x7</span></code> rectangular structuring element):</p>
<img alt="Left image: original image inverted, right image: resulting closing" src="_images/Morphology_2_Tutorial_Theory_Closing_2.png" />
<p class="rubric">Morphological Gradient</p>
<ul>
<li><p class="first">It is the difference between the dilation and the erosion of an image.</p>
<div class="math notranslate nohighlight">
\[dst = morph_{grad}( src, element ) = dilate( src, element ) - erode( src, element )\]</div>
</li>
<li><p class="first">It is useful for finding the outline of an object as can be seen below:</p>
<img alt="_images/Morphology_2_Tutorial_Theory_Gradient.png" src="_images/Morphology_2_Tutorial_Theory_Gradient.png" />
</li>
</ul>
<p class="rubric">Top Hat</p>
<ul>
<li><p class="first">It is the difference between an input image and its opening.</p>
<div class="math notranslate nohighlight">
\[dst = tophat( src, element ) = src - open( src, element )\]</div>
<img alt="_images/Morphology_2_Tutorial_Theory_TopHat.png" src="_images/Morphology_2_Tutorial_Theory_TopHat.png" />
</li>
</ul>
<p class="rubric">Black Hat</p>
<ul>
<li><p class="first">It is the difference between the closing and its input image</p>
<div class="math notranslate nohighlight">
\[dst = blackhat( src, element ) = close( src, element ) - src\]</div>
<img alt="_images/Morphology_2_Tutorial_Theory_BlackHat.png" src="_images/Morphology_2_Tutorial_Theory_BlackHat.png" />
</li>
</ul>
<p class="rubric">Code</p>
<p>This tutorial code’s is shown lines below. You can also download it from <a class="reference external" href="https://github.com/opencv/opencv/tree/master/samples/cpp/tutorial_code/ImgProc/Morphology_2.cpp">here</a></p>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&quot;opencv2/imgproc.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;opencv2/imgcodecs.hpp&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;opencv2/highgui.hpp&quot;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_cv.html#doxid-d2-d75-namespacecv"><span class="std std-ref">cv</span></a><span></span><span class="p">;</span>

<a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">morph_elem</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">morph_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">morph_operator</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">int</span> <span class="k">const</span> <span class="n">max_operator</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="kt">int</span> <span class="k">const</span> <span class="n">max_elem</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="kt">int</span> <span class="k">const</span> <span class="n">max_kernel_size</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">window_name</span> <span class="o">=</span> <span class="s">&quot;Morphology Transformations Demo&quot;</span><span class="p">;</span>


<span class="kt">void</span> <span class="nf">Morphology_Operations</span><span class="p">(</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="p">);</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="n">src</span> <span class="o">=</span> <a class="reference internal" href="group_imgcodecs.html#doxid-d4-da8-group-imgcodecs-1ga288b8b3da0892bd651fce07b3bbd3a56"><span class="std std-ref">imread</span></a><span></span><span class="p">(</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <a class="reference internal" href="enum_cv_ImreadModes.html#doxid-d4-da8-group-imgcodecs-1gga61d9b0126a3e57d9277ac48327799c80af660544735200cbe942eea09232eb822"><span class="std std-ref">IMREAD_COLOR</span></a><span></span> <span class="p">);</span> <span class="c1">// Load an image</span>

  <span class="k">if</span><span class="p">(</span> <span class="n">src</span><span class="p">.</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1abbec3525a852e77998aba034813fded4"><span class="std std-ref">empty</span></a><span></span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="p">}</span>

  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga5afdf8410934fd099df85c75b2e0888b"><span class="std std-ref">namedWindow</span></a><span></span><span class="p">(</span> <span class="n">window_name</span><span class="p">,</span> <a class="reference internal" href="enum_cv_WindowFlags.html#doxid-d7-dfc-group-highgui-1ggabf7d2c5625bc59ac130287f925557ac3acf621ace7a54954cbac01df27e47228f"><span class="std std-ref">WINDOW_AUTOSIZE</span></a><span></span> <span class="p">);</span> <span class="c1">// Create window</span>

  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1gaf78d2155d30b728fc413803745b67a9b"><span class="std std-ref">createTrackbar</span></a><span></span><span class="p">(</span><span class="s">&quot;Operator:</span><span class="se">\n</span><span class="s"> 0: Opening - 1: Closing  </span><span class="se">\n</span><span class="s"> 2: Gradient - 3: Top Hat </span><span class="se">\n</span><span class="s"> 4: Black Hat&quot;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">morph_operator</span><span class="p">,</span> <span class="n">max_operator</span><span class="p">,</span> <span class="n">Morphology_Operations</span> <span class="p">);</span>

  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1gaf78d2155d30b728fc413803745b67a9b"><span class="std std-ref">createTrackbar</span></a><span></span><span class="p">(</span> <span class="s">&quot;Element:</span><span class="se">\n</span><span class="s"> 0: Rect - 1: Cross - 2: Ellipse&quot;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">,</span>
                  <span class="o">&amp;</span><span class="n">morph_elem</span><span class="p">,</span> <span class="n">max_elem</span><span class="p">,</span>
                  <span class="n">Morphology_Operations</span> <span class="p">);</span>

  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1gaf78d2155d30b728fc413803745b67a9b"><span class="std std-ref">createTrackbar</span></a><span></span><span class="p">(</span> <span class="s">&quot;Kernel size:</span><span class="se">\n</span><span class="s"> 2n +1&quot;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">,</span>
                  <span class="o">&amp;</span><span class="n">morph_size</span><span class="p">,</span> <span class="n">max_kernel_size</span><span class="p">,</span>
                  <span class="n">Morphology_Operations</span> <span class="p">);</span>

  <span class="n">Morphology_Operations</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>

  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga5628525ad33f52eab17feebcfba38bd7"><span class="std std-ref">waitKey</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">void</span> <span class="n">Morphology_Operations</span><span class="p">(</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Since MORPH_X : 2,3,4,5 and 6</span>
  <span class="kt">int</span> <span class="n">operation</span> <span class="o">=</span> <span class="n">morph_operator</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

  <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">element</span> <span class="o">=</span> <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1gac342a1bb6eabf6f55c803b09268e36dc"><span class="std std-ref">getStructuringElement</span></a><span></span><span class="p">(</span> <span class="n">morph_elem</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga346f563897249351a34549137c8532a0"><span class="std std-ref">Size</span></a><span></span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">morph_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">morph_size</span><span class="o">+</span><span class="mi">1</span> <span class="p">),</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span> <span class="n">morph_size</span><span class="p">,</span> <span class="n">morph_size</span> <span class="p">)</span> <span class="p">);</span>

  <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1ga67493776e3ad1a3df63883829375201f"><span class="std std-ref">morphologyEx</span></a><span></span><span class="p">(</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">element</span> <span class="p">);</span>
  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga453d42fe4cb60e5723281a89973ee563"><span class="std std-ref">imshow</span></a><span></span><span class="p">(</span> <span class="n">window_name</span><span class="p">,</span> <span class="n">dst</span> <span class="p">);</span>
<span class="p">}</span>
</pre>
<p class="rubric">Explanation</p>
<ol class="arabic">
<li><p class="first">Let’s check the general structure of the program:</p>
<ul>
<li><p class="first">Load an image</p>
</li>
<li><p class="first">Create a window to display results of the Morphological operations</p>
</li>
<li><p class="first">Create three Trackbars for the user to enter parameters:</p>
<ul>
<li><p class="first">The first trackbar <strong>Operator</strong> returns the kind of morphology operation to use (<strong>morph_operator</strong>).</p>
<pre class="highlight literal-block">
<a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1gaf78d2155d30b728fc413803745b67a9b"><span class="std std-ref">createTrackbar</span></a><span></span><span class="p">(</span><span class="s">&quot;Operator:</span><span class="se">\n</span><span class="s"> 0: Opening - 1: Closing  </span><span class="se">\n</span><span class="s"> 2: Gradient - 3: Top Hat </span><span class="se">\n</span><span class="s"> 4: Black Hat&quot;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">morph_operator</span><span class="p">,</span> <span class="n">max_operator</span><span class="p">,</span> <span class="n">Morphology_Operations</span> <span class="p">);</span>
</pre>
</li>
<li><p class="first">The second trackbar <strong>Element</strong> returns <strong>morph_elem</strong>, which indicates what kind of structure our kernel is:</p>
<pre class="highlight literal-block">
<a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1gaf78d2155d30b728fc413803745b67a9b"><span class="std std-ref">createTrackbar</span></a><span></span><span class="p">(</span> <span class="s">&quot;Element:</span><span class="se">\n</span><span class="s"> 0: Rect - 1: Cross - 2: Ellipse&quot;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">,</span>
                <span class="o">&amp;</span><span class="n">morph_elem</span><span class="p">,</span> <span class="n">max_elem</span><span class="p">,</span>
                <span class="n">Morphology_Operations</span> <span class="p">);</span>
</pre>
</li>
<li><p class="first">The final trackbar <strong>Kernel Size</strong> returns the size of the kernel to be used (<strong>morph_size</strong>)</p>
<pre class="highlight literal-block">
<a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1gaf78d2155d30b728fc413803745b67a9b"><span class="std std-ref">createTrackbar</span></a><span></span><span class="p">(</span> <span class="s">&quot;Kernel size:</span><span class="se">\n</span><span class="s"> 2n +1&quot;</span><span class="p">,</span> <span class="n">window_name</span><span class="p">,</span>
                <span class="o">&amp;</span><span class="n">morph_size</span><span class="p">,</span> <span class="n">max_kernel_size</span><span class="p">,</span>
                <span class="n">Morphology_Operations</span> <span class="p">);</span>
</pre>
</li>
</ul>
</li>
<li><p class="first">Every time we move any slider, the user’s function <strong>Morphology_Operations</strong> will be called to effectuate a new morphology operation and it will update the output image based on the current trackbar values.</p>
<pre class="highlight literal-block">
<span></span><span class="kt">void</span> <span class="nf">Morphology_Operations</span><span class="p">(</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// Since MORPH_X : 2,3,4,5 and 6</span>
  <span class="kt">int</span> <span class="n">operation</span> <span class="o">=</span> <span class="n">morph_operator</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>

  <span class="n">Mat</span> <span class="n">element</span> <span class="o">=</span> <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1gac342a1bb6eabf6f55c803b09268e36dc"><span class="std std-ref">getStructuringElement</span></a><span></span><span class="p">(</span> <span class="n">morph_elem</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga346f563897249351a34549137c8532a0"><span class="std std-ref">Size</span></a><span></span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">morph_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">morph_size</span><span class="o">+</span><span class="mi">1</span> <span class="p">),</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span> <span class="n">morph_size</span><span class="p">,</span> <span class="n">morph_size</span> <span class="p">)</span> <span class="p">);</span>

  <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1ga67493776e3ad1a3df63883829375201f"><span class="std std-ref">morphologyEx</span></a><span></span><span class="p">(</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">element</span> <span class="p">);</span>
  <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga453d42fe4cb60e5723281a89973ee563"><span class="std std-ref">imshow</span></a><span></span><span class="p">(</span> <span class="n">window_name</span><span class="p">,</span> <span class="n">dst</span> <span class="p">);</span>
<span class="p">}</span>
</pre>
<p>We can observe that the key function to perform the morphology transformations is <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1ga67493776e3ad1a3df63883829375201f"><span class="std std-ref">cv::morphologyEx</span></a>. In this example we use four arguments (leaving the rest as defaults):</p>
<ul>
<li><p class="first"><strong>src</strong> : Source (input) image</p>
</li>
<li><p class="first"><strong>dst</strong> : Output image</p>
</li>
<li><p class="first"><strong>operation</strong> : The kind of morphology transformation to be performed. Note that we have 5 alternatives:</p>
<ul class="simple">
<li><em>Opening</em> : MORPH_OPEN : 2</li>
<li><em>Closing</em> : MORPH_CLOSE: 3</li>
<li><em>Gradient</em> : MORPH_GRADIENT: 4</li>
<li><em>Top Hat</em> : MORPH_TOPHAT: 5</li>
<li><em>Black Hat</em> : MORPH_BLACKHAT: 6</li>
</ul>
<p>As you can see the values range from &lt;2-6&gt;, that is why we add (+2) to the values entered by the Trackbar:</p>
<pre class="highlight literal-block">
<span></span><span class="kt">int</span> <span class="n">operation</span> <span class="o">=</span> <span class="n">morph_operator</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
</pre>
</li>
<li><p class="first"><strong>element</strong> : The kernel to be used. We use the function <a class="reference internal" href="group_imgproc_filter.html#doxid-d4-d86-group-imgproc-filter-1gac342a1bb6eabf6f55c803b09268e36dc"><span class="std std-ref">cv::getStructuringElement</span></a> to define our own structure.</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<p class="rubric">Results</p>
<ul>
<li><p class="first">After compiling the code above we can execute it giving an image path as an argument. For this tutorial we use as input the image: <strong>baboon.png</strong> :</p>
<img alt="_images/Morphology_2_Tutorial_Original_Image.jpg" src="_images/Morphology_2_Tutorial_Original_Image.jpg" />
</li>
<li><p class="first">And here are two snapshots of the display window. The first picture shows the output after using the operator <strong>Opening</strong> with a cross kernel. The second picture (right side, shows the result of using a <strong>Blackhat</strong> operator with an ellipse kernel.</p>
<img alt="_images/Morphology_2_Tutorial_Result.jpg" src="_images/Morphology_2_Tutorial_Result.jpg" />
</li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="page_tutorial_point_polygon_test.html" class="btn btn-neutral float-right" title="Point Polygon Test" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="page_tutorial_filter_2d.html" class="btn btn-neutral float-left" title="Making your own linear filters!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 1999-2017, OpenCV Maintainers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>