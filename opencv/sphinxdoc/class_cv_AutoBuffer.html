
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>template class cv::AutoBuffer &#8212; OpenCV Documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinxdoc.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/target-highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="class cv::AutoLock" href="class_cv_AutoLock.html" />
    <link rel="prev" title="template class cv::Allocator::rebind" href="class_cv_Allocator_rebind.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="class_cv_AutoLock.html" title="class cv::AutoLock"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="class_cv_Allocator_rebind.html" title="template class cv::Allocator::rebind"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="group_core.html" >Core functionality</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_core_utils.html" accesskey="U">Utility and system functions and macros</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">template class cv::AutoBuffer</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#detailed-documentation">Detailed Documentation</a><ul>
<li><a class="reference internal" href="#fields">Fields</a></li>
<li><a class="reference internal" href="#construction">Construction</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="class_cv_Allocator_rebind.html"
                        title="previous chapter">template class cv::Allocator::rebind</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="class_cv_AutoLock.html"
                        title="next chapter">class cv::AutoLock</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="template-class-cv-autobuffer">
<span id="doxid-df-d8c-classcv-1-1-auto-buffer"></span><span id="index-0"></span><h1>template class cv::AutoBuffer</h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="overview">
<h2>Overview</h2>
<p>Automatically Allocated Buffer Class. <a class="reference internal" href="#details-df-d8c-classcv-1-1-auto-buffer"><span class="std std-ref">More…</span></a></p>
<pre class="highlight doxyrest-overview-code-block literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&lt;utility.hpp&gt;</span><span class="cp"></span>

<span class="k">template</span> <span class="o">&lt;</span>
    <span class="k">typename</span> <span class="n">_Tp</span><span class="p">,</span>
    <span class="kt">size_t</span> <span class="n">fixed_size</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">_Tp</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span>
    <span class="o">&gt;</span>
<span class="k">class</span> <span class="n">AutoBuffer</span>
<span class="p">{</span>
<span class="k">public</span><span class="o">:</span>
    <span class="c1">// typedefs</span>

    <span class="k">typedef</span> <span class="n">_Tp</span> <span class="doxyrest-code-target target" id="doxid-df-d8c-classcv-1-1-auto-buffer-1afbc953161e91d6455882c315eff66f6d">value_type</span><span></span><span class="p">;</span>

    <span class="c1">// construction</span>

    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a990ab2dd088c226def0e59177933c9df"><span class="std std-ref">AutoBuffer</span></a><span></span><span class="p">();</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1ac498c6689e5a18843e1c9d23441c3a99"><span class="std std-ref">AutoBuffer</span></a><span></span><span class="p">(</span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">_size</span><span class="p">);</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a3416e6aa3bb03435706abce813950d6e"><span class="std std-ref">AutoBuffer</span></a><span></span><span class="p">(</span><span class="k">const</span> <span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="n">_Tp</span><span class="p">,</span> <span class="n">fixed_size</span><span class="o">&gt;&amp;</span> <span class="n">buf</span><span class="p">);</span>

    <span class="c1">// methods</span>

    <span class="kt">void</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a1c16dbf31a16748ffc930e796f0dc54b"><span class="std std-ref">allocate</span></a><span></span><span class="p">(</span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">_size</span><span class="p">);</span>

    <span class="kt">void</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1aab78aeff0108ad5ba8c96baafd58702b"><span class="std std-ref">deallocate</span></a><span></span><span class="p">();</span>

    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1abf37a20ae4387196fe2a5684ced410dc"><span class="std std-ref">operator _Tp *</span></a><span></span><span class="p">();</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a8e1062498f5ea59f2784883cfd6607cb"><span class="std std-ref">operator const _Tp *</span></a><span></span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

    <span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="n">_Tp</span><span class="p">,</span> <span class="n">fixed_size</span><span class="o">&gt;&amp;</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1ad8be3a945146d9528f747eafb6c34a81"><span class="std std-ref">operator=</span></a><span></span><span class="p">(</span><span class="k">const</span> <span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="n">_Tp</span><span class="p">,</span> <span class="n">fixed_size</span><span class="o">&gt;&amp;</span> <span class="n">buf</span><span class="p">);</span>

    <span class="kt">void</span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a97edc51af209cd6ab20da864c3468124"><span class="std std-ref">resize</span></a><span></span><span class="p">(</span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">_size</span><span class="p">);</span>

    <a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span>
    <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a3e51a3baa4dcb2d8eaefddc4c3ceb455"><span class="std std-ref">size</span></a><span></span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>

<span class="k">protected</span><span class="o">:</span>
    <span class="c1">// fields</span>

    <span class="n">_Tp</span> <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a5286c7bfa1926f51f6d0c7bf5e01c001"><span class="std std-ref">buf</span></a><span></span><span class="p">[(</span><span class="n">fixed_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="nl">fixed_size</span> <span class="p">:</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">_Tp</span><span class="o">*</span> <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a194ac92b66c003787e0782bd8a38750b"><span class="std std-ref">ptr</span></a><span></span><span class="p">;</span>
    <a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer-1a6025c7fd11fa230c2c315673d2d293b3"><span class="std std-ref">sz</span></a><span></span><span class="p">;</span>
<span class="p">};</span>
</pre>
</div>
<div class="section" id="detailed-documentation">
<span id="details-df-d8c-classcv-1-1-auto-buffer"></span><h2>Detailed Documentation</h2>
<p>Automatically Allocated Buffer Class.</p>
<p>The class is used for temporary buffers in functions and methods. If a temporary buffer is usually small (a few K’s of memory), but its size depends on the parameters, it makes sense to create a small fixed-size array on stack and use it if it’s large enough. If the required buffer size is larger than the fixed size, another buffer of sufficient size is allocated dynamically and released after the processing. Therefore, in typical cases, when the buffer size is small, there is no overhead associated with malloc()/free(). At the same time, there is no limit on the size of processed data.</p>
<p>This is what <a class="reference internal" href="#doxid-df-d8c-classcv-1-1-auto-buffer"><span class="std std-ref">AutoBuffer</span></a> does. The template takes 2 parameters - type of the buffer elements and the number of stack-allocated elements. Here is how the class is used:</p>
<pre class="highlight literal-block">
<span></span><span class="kt">void</span> <span class="nf">my_func</span><span class="p">(</span><span class="k">const</span> <span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">&amp;</span> <span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
   <span class="n">cv</span><span class="o">::</span><span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">buf</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// create automatic buffer containing 1000 floats</span>

   <span class="n">buf</span><span class="p">.</span><span class="n">allocate</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="n">rows</span><span class="p">);</span> <span class="c1">// if m.rows &lt;= 1000, the pre-allocated buffer is used,</span>
                         <span class="c1">// otherwise the buffer of &quot;m.rows&quot; floats will be allocated</span>
                         <span class="c1">// dynamically and deallocated in cv::AutoBuffer destructor</span>
   <span class="p">...</span>
<span class="p">}</span>
</pre>
<div class="section" id="fields">
<h3>Fields</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a5286c7bfa1926f51f6d0c7bf5e01c001">
<span id="index-1"></span><span></span><span class="n">_Tp</span> <span class="n">buf</span><span class="p">[(</span><span class="n">fixed_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">?</span> <span class="nl">fixed_size</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre>
<p>pre-allocated buffer. At least 1 element to confirm C++ standard requirements</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a194ac92b66c003787e0782bd8a38750b">
<span id="index-2"></span><span></span><span class="n">_Tp</span><span class="o">*</span> <span class="n">ptr</span>
</pre>
<p>pointer to the real buffer, can point to buf if the buffer is small enough</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a6025c7fd11fa230c2c315673d2d293b3">
<span id="index-3"></span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">sz</span>
</pre>
<p>size of the real buffer</p>
</div>
<div class="section" id="construction">
<h3>Construction</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a990ab2dd088c226def0e59177933c9df">
<span id="index-4"></span><span></span><span class="n">AutoBuffer</span><span class="p">()</span>
</pre>
<p>the default constructor</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1ac498c6689e5a18843e1c9d23441c3a99">
<span id="index-5"></span><span></span><span class="n">AutoBuffer</span><span class="p">(</span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">_size</span><span class="p">)</span>
</pre>
<p>constructor taking the real buffer size</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a3416e6aa3bb03435706abce813950d6e">
<span id="index-6"></span><span></span><span class="n">AutoBuffer</span><span class="p">(</span><span class="k">const</span> <span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="n">_Tp</span><span class="p">,</span> <span class="n">fixed_size</span><span class="o">&gt;&amp;</span> <span class="n">buf</span><span class="p">)</span>
</pre>
<p>the copy constructor</p>
</div>
<div class="section" id="methods">
<h3>Methods</h3>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a1c16dbf31a16748ffc930e796f0dc54b">
<span id="index-7"></span><span></span><span class="kt">void</span>
<span class="n">allocate</span><span class="p">(</span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">_size</span><span class="p">)</span>
</pre>
<p>allocates the new buffer of size _size. if the _size is small enough, stack-allocated buffer is used</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1aab78aeff0108ad5ba8c96baafd58702b">
<span id="index-8"></span><span></span><span class="kt">void</span>
<span class="n">deallocate</span><span class="p">()</span>
</pre>
<p>deallocates the buffer if it was dynamically allocated</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1abf37a20ae4387196fe2a5684ced410dc">
<span id="index-9"></span><span></span><span class="k">operator</span> <span class="n">_Tp</span> <span class="o">*</span><span class="p">()</span>
</pre>
<p>returns pointer to the real buffer, stack-allocated or heap-allocated</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a8e1062498f5ea59f2784883cfd6607cb">
<span id="index-10"></span><span></span><span class="k">operator</span> <span class="k">const</span> <span class="n">_Tp</span> <span class="o">*</span><span class="p">()</span> <span class="k">const</span>
</pre>
<p>returns read-only pointer to the real buffer, stack-allocated or heap-allocated</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1ad8be3a945146d9528f747eafb6c34a81">
<span id="index-11"></span><span></span><span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="n">_Tp</span><span class="p">,</span> <span class="n">fixed_size</span><span class="o">&gt;&amp;</span>
<span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">AutoBuffer</span><span class="o">&lt;</span><span class="n">_Tp</span><span class="p">,</span> <span class="n">fixed_size</span><span class="o">&gt;&amp;</span> <span class="n">buf</span><span class="p">)</span>
</pre>
<p>the assignment operator</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a97edc51af209cd6ab20da864c3468124">
<span id="index-12"></span><span></span><span class="kt">void</span>
<span class="n">resize</span><span class="p">(</span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span> <span class="n">_size</span><span class="p">)</span>
</pre>
<p>resizes the buffer and preserves the content</p>
<pre class="highlight doxyrest-title-code-block literal-block" id="doxid-df-d8c-classcv-1-1-auto-buffer-1a3e51a3baa4dcb2d8eaefddc4c3ceb455">
<span id="index-13"></span><a class="reference internal" href="global.html#doxid-da-d06-autogenerated-2opencl-core-8hpp-1a6ff403ead16f7faa1f7228274eb6b01d"><span class="std std-ref">size_t</span></a><span></span>
<span class="n">size</span><span class="p">()</span> <span class="k">const</span>
</pre>
<p>returns the current buffer size</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="class_cv_AutoLock.html" title="class cv::AutoLock"
             >next</a> |</li>
        <li class="right" >
          <a href="class_cv_Allocator_rebind.html" title="template class cv::Allocator::rebind"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="group_core.html" >Core functionality</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="group_core_utils.html" >Utility and system functions and macros</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 1999-2017, OpenCV Maintainers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>