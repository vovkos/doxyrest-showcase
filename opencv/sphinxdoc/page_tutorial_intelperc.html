
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Using Creative Senz3D and other Intel Perceptual Computing SDK compatible depth sensors &#8212; OpenCV Documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinxdoc.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/target-highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using Kinect and other OpenNI compatible depth sensors" href="page_tutorial_kinect_openni.html" />
    <link rel="prev" title="Creating a video with OpenCV" href="page_tutorial_video_write.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="page_tutorial_kinect_openni.html" title="Using Kinect and other OpenNI compatible depth sensors"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="page_tutorial_video_write.html" title="Creating a video with OpenCV"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="page_tutorial_root.html" >OpenCV Tutorials</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="page_tutorial_table_of_content_videoio.html" accesskey="U">Video Input and Output (videoio module)</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="page_tutorial_video_write.html"
                        title="previous chapter">Creating a video with OpenCV</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="page_tutorial_kinect_openni.html"
                        title="next chapter">Using Kinect and other OpenNI compatible depth sensors</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-creative-senz3d-and-other-intel-perceptual-computing-sdk-compatible-depth-sensors">
<span id="doxid-db-d08-tutorial-intelperc"></span><span id="index-0"></span><h1>Using Creative Senz3D and other Intel Perceptual Computing SDK compatible depth sensors</h1>
<p>Depth sensors compatible with Intel Perceptual Computing SDK are supported through VideoCapture class. Depth map, RGB image and some other formats of output can be retrieved by using familiar interface of VideoCapture.</p>
<p>In order to use depth sensor with OpenCV you should do the following preliminary steps:</p>
<ol class="arabic simple">
<li>Install Intel Perceptual Computing SDK (from here <a class="reference external" href="http://www.intel.com/software/perceptual">http://www.intel.com/software/perceptual</a>).</li>
<li>Configure OpenCV with Intel Perceptual Computing SDK support by setting WITH_INTELPERC flag in CMake. If Intel Perceptual Computing SDK is found in install folders OpenCV will be built with Intel Perceptual Computing SDK library (see a status INTELPERC in CMake log). If CMake process doesn’t find Intel Perceptual Computing SDK installation folder automatically, the user should change corresponding CMake variables INTELPERC_LIB_DIR and INTELPERC_INCLUDE_DIR to the proper value.</li>
<li>Build OpenCV.</li>
</ol>
<p>VideoCapture can retrieve the following data:</p>
<ol class="arabic simple">
<li>data given from depth generator:<ul>
<li>CAP_INTELPERC_DEPTH_MAP - each pixel is a 16-bit integer. The value indicates the distance from an object to the camera’s XY plane or the Cartesian depth. (CV_16UC1)</li>
<li>CAP_INTELPERC_UVDEPTH_MAP - each pixel contains two 32-bit floating point values in the range of 0-1, representing the mapping of depth coordinates to the color coordinates. (CV_32FC2)</li>
<li>CAP_INTELPERC_IR_MAP - each pixel is a 16-bit integer. The value indicates the intensity of the reflected laser beam. (CV_16UC1)</li>
</ul>
</li>
<li>data given from RGB image generator:<ul>
<li>CAP_INTELPERC_IMAGE - color image. (CV_8UC3)</li>
</ul>
</li>
</ol>
<p>In order to get depth map from depth sensor use VideoCapture::operator &gt;&gt;, e. g. :</p>
<pre class="highlight literal-block">
<span></span><span class="n">VideoCapture</span> <span class="n">capture</span><span class="p">(</span> <a class="reference internal" href="enum_cv_VideoCaptureAPIs.html#doxid-d4-d15-group-videoio-flags-base-1gga023786be1ee68a9105bf2e48c700294dabe0df46cd132d1cfbae88efd6f4becdf"><span class="std std-ref">CAP_INTELPERC</span></a><span></span> <span class="p">);</span>
<span class="k">for</span><span class="p">(;;)</span>
<span class="p">{</span>
    <span class="n">Mat</span> <span class="n">depthMap</span><span class="p">;</span>
    <span class="n">capture</span> <span class="o">&gt;&gt;</span> <span class="n">depthMap</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span> <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga5628525ad33f52eab17feebcfba38bd7"><span class="std std-ref">waitKey</span></a><span></span><span class="p">(</span> <span class="mi">30</span> <span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>For getting several data maps use VideoCapture::grab and VideoCapture::retrieve, e.g. :</p>
<pre class="highlight literal-block">
<span></span><span class="n">VideoCapture</span> <span class="n">capture</span><span class="p">(</span><a class="reference internal" href="enum_cv_VideoCaptureAPIs.html#doxid-d4-d15-group-videoio-flags-base-1gga023786be1ee68a9105bf2e48c700294dabe0df46cd132d1cfbae88efd6f4becdf"><span class="std std-ref">CAP_INTELPERC</span></a><span></span><span class="p">);</span>
<span class="k">for</span><span class="p">(;;)</span>
<span class="p">{</span>
    <span class="n">Mat</span> <span class="n">depthMap</span><span class="p">;</span>
    <span class="n">Mat</span> <span class="n">image</span><span class="p">;</span>
    <span class="n">Mat</span> <span class="n">irImage</span><span class="p">;</span>

    <span class="n">capture</span><span class="p">.</span><span class="n">grab</span><span class="p">();</span>

    <span class="n">capture</span><span class="p">.</span><span class="n">retrieve</span><span class="p">(</span> <span class="n">depthMap</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-dfc-group-videoio-flags-others-1gga3f9a572bf02ebe19f6652ce7cadadc7ca0633813010b6c21838951de5fb34d643"><span class="std std-ref">CAP_INTELPERC_DEPTH_MAP</span></a><span></span> <span class="p">);</span>
    <span class="n">capture</span><span class="p">.</span><span class="n">retrieve</span><span class="p">(</span>    <span class="n">image</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-dfc-group-videoio-flags-others-1gga3f9a572bf02ebe19f6652ce7cadadc7ca5c722445f6d9324474cf50b39b92ae74"><span class="std std-ref">CAP_INTELPERC_IMAGE</span></a><span></span> <span class="p">);</span>
    <span class="n">capture</span><span class="p">.</span><span class="n">retrieve</span><span class="p">(</span>  <span class="n">irImage</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-dfc-group-videoio-flags-others-1gga3f9a572bf02ebe19f6652ce7cadadc7ca56fd50220f952776712bcfb656a5c64d"><span class="std std-ref">CAP_INTELPERC_IR_MAP</span></a><span></span><span class="p">);</span>

    <span class="k">if</span><span class="p">(</span> <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga5628525ad33f52eab17feebcfba38bd7"><span class="std std-ref">waitKey</span></a><span></span><span class="p">(</span> <span class="mi">30</span> <span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">)</span>
        <span class="k">break</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>For setting and getting some property of sensor` data generators use VideoCapture::set and VideoCapture::get methods respectively, e.g. :</p>
<pre class="highlight literal-block">
<span></span><span class="n">VideoCapture</span> <span class="n">capture</span><span class="p">(</span> <a class="reference internal" href="enum_cv_VideoCaptureAPIs.html#doxid-d4-d15-group-videoio-flags-base-1gga023786be1ee68a9105bf2e48c700294dabe0df46cd132d1cfbae88efd6f4becdf"><span class="std std-ref">CAP_INTELPERC</span></a><span></span> <span class="p">);</span>
<span class="n">capture</span><span class="p">.</span><span class="n">set</span><span class="p">(</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-dfc-group-videoio-flags-others-1ggabfc4ba1d1fb873f2b56d34032f86c1d4af09153f3c7f98ceb038d39453da205cf"><span class="std std-ref">CAP_INTELPERC_DEPTH_GENERATOR</span></a><span></span> <span class="o">|</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-dfc-group-videoio-flags-others-1ggaf454b747a111dc9819419b99807ae7aca03489c9c3fc5b2656a9063f2e079d7a3"><span class="std std-ref">CAP_PROP_INTELPERC_PROFILE_IDX</span></a><span></span><span class="p">,</span> <span class="mi">0</span> <span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;FPS    &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">capture</span><span class="p">.</span><span class="n">get</span><span class="p">(</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-dfc-group-videoio-flags-others-1ggabfc4ba1d1fb873f2b56d34032f86c1d4af09153f3c7f98ceb038d39453da205cf"><span class="std std-ref">CAP_INTELPERC_DEPTH_GENERATOR</span></a><span></span><span class="o">+</span><a class="reference internal" href="enum_cv_VideoCaptureProperties.html#doxid-d4-d15-group-videoio-flags-base-1ggaeb8dd9c89c10a5c63c139bf7c4f5704daf01bc92359d2abc9e6eeb5cbe36d9af2"><span class="std std-ref">CAP_PROP_FPS</span></a><span></span> <span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</pre>
<p>Since two types of sensor’s data generators are supported (image generator and depth generator), there are two flags that should be used to set/get property of the needed generator:</p>
<ul class="simple">
<li>CAP_INTELPERC_IMAGE_GENERATOR a flag for access to the image generator properties.</li>
<li>CAP_INTELPERC_DEPTH_GENERATOR a flag for access to the depth generator properties. This flag value is assumed by default if neither of the two possible values of the property is set.</li>
</ul>
<p>For more information please refer to the example of usage <a class="reference external" href="https://github.com/opencv/tree/master/samples/cpp/intelperc_capture.cpp">intelperc_capture.cpp</a> in opencv/samples/cpp folder.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="page_tutorial_kinect_openni.html" title="Using Kinect and other OpenNI compatible depth sensors"
             >next</a> |</li>
        <li class="right" >
          <a href="page_tutorial_video_write.html" title="Creating a video with OpenCV"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="page_tutorial_root.html" >OpenCV Tutorials</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="page_tutorial_table_of_content_videoio.html" >Video Input and Output (videoio module)</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 1999-2017, OpenCV Maintainers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>