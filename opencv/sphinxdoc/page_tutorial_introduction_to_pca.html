
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Introduction to Principal Component Analysis (PCA) &#8212; OpenCV Documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinxdoc.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/target-highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to Support Vector Machines" href="page_tutorial_introduction_to_svm.html" />
    <link rel="prev" title="Machine Learning (ml module)" href="page_tutorial_table_of_content_ml.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="page_tutorial_introduction_to_svm.html" title="Introduction to Support Vector Machines"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="page_tutorial_table_of_content_ml.html" title="Machine Learning (ml module)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="page_tutorial_root.html" >OpenCV Tutorials</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="page_tutorial_table_of_content_ml.html" accesskey="U">Machine Learning (ml module)</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="page_tutorial_table_of_content_ml.html"
                        title="previous chapter">Machine Learning (ml module)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="page_tutorial_introduction_to_svm.html"
                        title="next chapter">Introduction to Support Vector Machines</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction-to-principal-component-analysis-pca">
<span id="doxid-d1-dee-tutorial-introduction-to-pca"></span><span id="index-0"></span><h1>Introduction to Principal Component Analysis (PCA)</h1>
<p class="rubric">Goal</p>
<p>In this tutorial you will learn how to:</p>
<ul class="simple">
<li>Use the OpenCV class <a class="reference internal" href="class_cv_PCA.html#doxid-d3-d39-classcv-1-1-p-c-a"><span class="std std-ref">cv::PCA</span></a> to calculate the orientation of an object.</li>
</ul>
<p class="rubric">What is PCA?</p>
<p>Principal Component Analysis (PCA) is a statistical procedure that extracts the most important features of a dataset.</p>
<img alt="_images/pca_line.png" src="_images/pca_line.png" />
<p>Consider that you have a set of 2D points as it is shown in the figure above. Each dimension corresponds to a feature you are interested in. Here some could argue that the points are set in a random order. However, if you have a better look you will see that there is a linear pattern (indicated by the blue line) which is hard to dismiss. A key point of PCA is the Dimensionality Reduction. Dimensionality Reduction is the process of reducing the number of the dimensions of the given dataset. For example, in the above case it is possible to approximate the set of points to a single line and therefore, reduce the dimensionality of the given points from 2D to 1D.</p>
<p>Moreover, you could also see that the points vary the most along the blue line, more than they vary along the Feature 1 or Feature 2 axes. This means that if you know the position of a point along the blue line you have more information about the point than if you only knew where it was on Feature 1 axis or Feature 2 axis.</p>
<p>Hence, PCA allows us to find the direction along which our data varies the most. In fact, the result of running PCA on the set of points in the diagram consist of 2 vectors called <em>eigenvectors</em> which are the <em>principal components</em> of the data set.</p>
<img alt="_images/pca_eigen.png" src="_images/pca_eigen.png" />
<p>The size of each eigenvector is encoded in the corresponding eigenvalue and indicates how much the data vary along the principal component. The beginning of the eigenvectors is the center of all points in the data set. Applying PCA to N-dimensional data set yields N N-dimensional eigenvectors, N eigenvalues and 1 N-dimensional center point. Enough theory, let’s see how we can put these ideas into code.</p>
<p class="rubric">How are the eigenvectors and eigenvalues computed?</p>
<p>The goal is to transform a given data set <strong>X</strong> of dimension <em>p</em> to an alternative data set <strong>Y</strong> of smaller dimension <em>L</em>. Equivalently, we are seeking to find the matrix <strong>Y</strong>, where <strong>Y</strong> is the <em>Karhunen–Loève transform</em> (KLT) of matrix <strong>X</strong> :</p>
<div class="math notranslate nohighlight">
\[\mathbf{Y} = \mathbb{K} \mathbb{L} \mathbb{T} \{\mathbf{X}\}\]</div>
<p><strong>Organize the data set</strong></p>
<p>Suppose you have data comprising a set of observations of <em>p</em> variables, and you want to reduce the data so that each observation can be described with only <em>L</em> variables, <em>L</em> &lt;<em>p</em>. Suppose further, that the data are arranged as a set of <em>n</em> data vectors <span class="math notranslate nohighlight">\(x_1...x_n\)</span> with each <span class="math notranslate nohighlight">\(x_i\)</span> representing a single grouped observation of the <em>p</em> variables.</p>
<ul class="simple">
<li>Write <span class="math notranslate nohighlight">\(x_1...x_n\)</span> as row vectors, each of which has <em>p</em> columns.</li>
<li>Place the row vectors into a single matrix <strong>X</strong> of dimensions <span class="math notranslate nohighlight">\(n\times p\)</span>.</li>
</ul>
<p><strong>Calculate the empirical mean</strong></p>
<ul>
<li><p class="first">Find the empirical mean along each dimension <span class="math notranslate nohighlight">\(j = 1, ..., p\)</span>.</p>
</li>
<li><p class="first">Place the calculated mean values into an empirical mean vector <strong>u</strong> of dimensions <span class="math notranslate nohighlight">\(p\times 1\)</span>.</p>
<div class="math notranslate nohighlight">
\[\mathbf{u[j]} = \frac{1}{n}\sum_{i=1}^{n}\mathbf{X[i,j]}\]</div>
</li>
</ul>
<p><strong>Calculate the deviations from the mean</strong></p>
<p>Mean subtraction is an integral part of the solution towards finding a principal component basis that minimizes the mean square error of approximating the data. Hence, we proceed by centering the data as follows:</p>
<ul>
<li><p class="first">Subtract the empirical mean vector <strong>u</strong> from each row of the data matrix <strong>X</strong>.</p>
</li>
<li><p class="first">Store mean-subtracted data in the <span class="math notranslate nohighlight">\(n\times p\)</span> matrix <strong>B</strong>.</p>
<div class="math notranslate nohighlight">
\[\mathbf{B} = \mathbf{X} - \mathbf{h}\mathbf{u^{T}}\]</div>
<p>where <strong>h</strong> is an <span class="math notranslate nohighlight">\(n\times 1\)</span> column vector of all 1s:</p>
<div class="math notranslate nohighlight">
\[h[i] = 1, i = 1, ..., n\]</div>
</li>
</ul>
<p><strong>Find the covariance matrix</strong></p>
<ul>
<li><p class="first">Find the <span class="math notranslate nohighlight">\(p\times p\)</span> empirical covariance matrix <strong>C</strong> from the outer product of matrix <strong>B</strong> with itself:</p>
<div class="math notranslate nohighlight">
\[\mathbf{C} = \frac{1}{n-1} \mathbf{B^{*}} \cdot \mathbf{B}\]</div>
<p>where * is the conjugate transpose operator. Note that if B consists entirely of real numbers, which is the case in many applications, the “conjugate transpose” is the same as the regular transpose.</p>
</li>
</ul>
<p><strong>Find the eigenvectors and eigenvalues of the covariance matrix</strong></p>
<ul>
<li><p class="first">Compute the matrix <strong>V</strong> of eigenvectors which diagonalizes the covariance matrix <strong>C</strong> :</p>
<div class="math notranslate nohighlight">
\[\mathbf{V^{-1}} \mathbf{C} \mathbf{V} = \mathbf{D}\]</div>
<p>where <strong>D</strong> is the diagonal matrix of eigenvalues of <strong>C</strong>.</p>
</li>
<li><p class="first">Matrix <strong>D</strong> will take the form of an <span class="math notranslate nohighlight">\(p \times p\)</span> diagonal matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}D[k,l] = \left\{\begin{matrix} \lambda_k, k = l \\ 0, k \neq l \end{matrix}\right.\end{split}\]</div>
<p>here, <span class="math notranslate nohighlight">\(\lambda_j\)</span> is the <em>j</em> -th eigenvalue of the covariance matrix <strong>C</strong></p>
</li>
<li><p class="first">Matrix <strong>V</strong>, also of dimension <em>p</em> x <em>p</em>, contains <em>p</em> column vectors, each of length <em>p</em>, which represent the <em>p</em> eigenvectors of the covariance matrix <strong>C</strong>.</p>
</li>
<li><p class="first">The eigenvalues and eigenvectors are ordered and paired. The <em>j</em> th eigenvalue corresponds to the <em>j</em> th eigenvector.</p>
</li>
</ul>
<p>sources <a class="reference external" href="https://robospace.wordpress.com/2013/10/09/object-orientation-principal-component-analysis-opencv/">[1]</a>, <a class="reference external" href="http://en.wikipedia.org/wiki/Principal_component_analysis">[2]</a> and special thanks to Svetlin Penkov for the original tutorial.</p>
<p class="rubric">Source Code</p>
<p>This tutorial code’s is shown lines below. You can also download it from <a class="reference external" href="https://github.com/opencv/tree/master/samples/cpp/tutorial_code/ml/introduction_to_pca/introduction_to_pca.cpp">here</a>.</p>
<pre class="highlight literal-block">
<span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;opencv2/opencv.hpp&gt;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_std.html#doxid-d8-dcc-namespacestd"><span class="std std-ref">std</span></a><span></span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_cv.html#doxid-d2-d75-namespacecv"><span class="std std-ref">cv</span></a><span></span><span class="p">;</span>

<span class="c1">// Function declarations</span>
<span class="kt">void</span> <span class="n">drawAxis</span><span class="p">(</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span><span class="o">&amp;</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Scalar</span><span class="p">,</span> <span class="k">const</span> <span class="kt">float</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">getOrientation</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="p">,</span> <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span><span class="o">&amp;</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">drawAxis</span><span class="p">(</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span><span class="o">&amp;</span> <span class="n">img</span><span class="p">,</span> <span class="n">Point</span> <span class="n">p</span><span class="p">,</span> <span class="n">Point</span> <span class="n">q</span><span class="p">,</span> <span class="n">Scalar</span> <span class="n">colour</span><span class="p">,</span> <span class="k">const</span> <span class="kt">float</span> <span class="n">scale</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">double</span> <span class="n">angle</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">hypotenuse</span><span class="p">;</span>
    <span class="n">angle</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga1096ba687de70142e095cc791a8bcd65"><span class="std std-ref">atan2</span></a><span></span><span class="p">(</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="p">);</span> <span class="c1">// angle in radians</span>
    <span class="n">hypotenuse</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv.html#doxid-d2-d75-namespacecv-1a682082a1892db64a2856403ec17ba297"><span class="std std-ref">sqrt</span></a><span></span><span class="p">(</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span><span class="p">));</span>
<span class="c1">//    double degrees = angle * 180 / CV_PI; // convert radians to degrees (0-180 range)</span>
<span class="c1">//    cout &lt;&lt; &quot;Degrees: &quot; &lt;&lt; abs(degrees - 180) &lt;&lt; endl; // angle in 0-360 degrees range</span>

    <span class="c1">// Here we lengthen the arrow by a factor of scale</span>
    <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">hypotenuse</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga2591489e47c1cb227d235872e4b5e433"><span class="std std-ref">cos</span></a><span></span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
    <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">hypotenuse</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1gaa65ebb1958aa6daaacb7e0b94810ff87"><span class="std std-ref">sin</span></a><span></span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga7078a9fae8c7e7d13d24dac2520ae4a2"><span class="std std-ref">line</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ga32a38de93cb76391d98a1545d587a8ff"><span class="std std-ref">CV_AA</span></a><span></span><span class="p">);</span>

    <span class="c1">// create the arrow hooks</span>
    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga2591489e47c1cb227d235872e4b5e433"><span class="std std-ref">cos</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1gaa65ebb1958aa6daaacb7e0b94810ff87"><span class="std std-ref">sin</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga7078a9fae8c7e7d13d24dac2520ae4a2"><span class="std std-ref">line</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ga32a38de93cb76391d98a1545d587a8ff"><span class="std std-ref">CV_AA</span></a><span></span><span class="p">);</span>

    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga2591489e47c1cb227d235872e4b5e433"><span class="std std-ref">cos</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">-</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1gaa65ebb1958aa6daaacb7e0b94810ff87"><span class="std std-ref">sin</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">-</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga7078a9fae8c7e7d13d24dac2520ae4a2"><span class="std std-ref">line</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ga32a38de93cb76391d98a1545d587a8ff"><span class="std std-ref">CV_AA</span></a><span></span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">double</span> <span class="n">getOrientation</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">pts</span><span class="p">,</span> <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="o">&amp;</span><span class="n">img</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//Construct a buffer used by the pca analysis</span>
    <span class="kt">int</span> <span class="n">sz</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
    <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">data_pts</span> <span class="o">=</span> <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <a class="reference internal" href="group_core_hal_interface.html#doxid-d1-d1b-group-core-hal-interface-1ga3b256d68c6002b6afd60ab9538d717a8"><span class="std std-ref">CV_64FC1</span></a><span></span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">data_pts</span><span class="p">.</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1abed816466c45234254d25bc59c31245e"><span class="std std-ref">rows</span></a><span></span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">data_pts</span><span class="p">.</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1aa5d20fc86d41d59e4d71ae93daee9726"><span class="std std-ref">at</span></a><span></span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
        <span class="n">data_pts</span><span class="p">.</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1aa5d20fc86d41d59e4d71ae93daee9726"><span class="std std-ref">at</span></a><span></span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//Perform PCA analysis</span>
    <a class="reference internal" href="class_cv_PCA.html#doxid-d3-d39-classcv-1-1-p-c-a"><span class="std std-ref">PCA</span></a><span></span> <span class="n">pca_analysis</span><span class="p">(</span><span class="n">data_pts</span><span class="p">,</span> <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span><span class="p">(),</span> <a class="reference internal" href="group_core_c.html#doxid-d2-df8-group-core-c-1ga8010c4e67ca59cfd17d7a965cea7d198"><span class="std std-ref">CV_PCA_DATA_AS_ROW</span></a><span></span><span class="p">);</span>

    <span class="c1">//Store the center of the object</span>
    <span class="n">Point</span> <span class="n">cntr</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pca_analysis</span><span class="p">.</span><span class="n">mean</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                      <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pca_analysis</span><span class="p">.</span><span class="n">mean</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)));</span>

    <span class="c1">//Store the eigenvalues and eigenvectors</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Point2d</span><span class="o">&gt;</span> <span class="n">eigen_vecs</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">eigen_val</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">eigen_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga32986d8c6fd05949688352abd112509f"><span class="std std-ref">Point2d</span></a><span></span><span class="p">(</span><span class="n">pca_analysis</span><span class="p">.</span><span class="n">eigenvectors</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                <span class="n">pca_analysis</span><span class="p">.</span><span class="n">eigenvectors</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

        <span class="n">eigen_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca_analysis</span><span class="p">.</span><span class="n">eigenvalues</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Draw the principal components</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1gaf10604b069374903dbd0f0488cb43670"><span class="std std-ref">circle</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cntr</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span>
    <span class="n">Point</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">+</span> <span class="mf">0.02</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
    <span class="n">Point</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">-</span> <span class="mf">0.02</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
    <span class="n">drawAxis</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cntr</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
    <span class="n">drawAxis</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cntr</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">5</span><span class="p">);</span>

    <span class="kt">double</span> <span class="n">angle</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga1096ba687de70142e095cc791a8bcd65"><span class="std std-ref">atan2</span></a><span></span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">);</span> <span class="c1">// orientation in radians</span>

    <span class="k">return</span> <span class="n">angle</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span><span class="o">**</span> <span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Load image</span>
<span class="c1">//    Mat src = imread(&quot;pca_test1.jpg&quot;);</span>
    <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">src</span> <span class="o">=</span> <a class="reference internal" href="group_imgcodecs.html#doxid-d4-da8-group-imgcodecs-1ga288b8b3da0892bd651fce07b3bbd3a56"><span class="std std-ref">imread</span></a><span></span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

    <span class="c1">// Check if image is loaded successfully</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">src</span><span class="p">.</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1a4d33bed1c850265370d2af0ff02e1564"><span class="std std-ref">data</span></a><span></span> <span class="o">||</span> <span class="n">src</span><span class="p">.</span><a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1abbec3525a852e77998aba034813fded4"><span class="std std-ref">empty</span></a><span></span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Problem loading image!!!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
    <span class="p">}</span>

    <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga453d42fe4cb60e5723281a89973ee563"><span class="std std-ref">imshow</span></a><span></span><span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>

    <span class="c1">// Convert image to grayscale</span>
    <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">gray</span><span class="p">;</span>
    <a class="reference internal" href="group_imgproc_misc.html#doxid-d7-d1b-group-imgproc-misc-1ga397ae87e1288a81d2363b61574eb8cab"><span class="std std-ref">cvtColor</span></a><span></span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">gray</span><span class="p">,</span> <a class="reference internal" href="enum_cv_ColorConversionCodes.html#doxid-d7-d1b-group-imgproc-misc-1gga4e0972be5de079fed4e3a10e24ef5ef0a353a4b8db9040165db4dacb5bcefb6ea"><span class="std std-ref">COLOR_BGR2GRAY</span></a><span></span><span class="p">);</span>

    <span class="c1">// Convert image to binary</span>
    <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">bw</span><span class="p">;</span>
    <a class="reference internal" href="group_imgproc_misc.html#doxid-d7-d1b-group-imgproc-misc-1gae8a4a146d1ca78c626a53577199e9c57"><span class="std std-ref">threshold</span></a><span></span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="n">bw</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ggaea33efd5e2c69d615faad5c5965510aaa6af8cb4caea50fb9578d4543aa7b6f20"><span class="std std-ref">CV_THRESH_BINARY</span></a><span></span> <span class="o">|</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ggaea33efd5e2c69d615faad5c5965510aaa2456934f4f01402e80006a317ea2693e"><span class="std std-ref">CV_THRESH_OTSU</span></a><span></span><span class="p">);</span>

    <span class="c1">// Find all the contours in the thresholded image</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">Vec4i</span><span class="o">&gt;</span> <span class="n">hierarchy</span><span class="p">;</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">contours</span><span class="p">;</span>
    <a class="reference internal" href="group_imgproc_shape.html#doxid-d3-dc0-group-imgproc-shape-1ga17ed9f5d79ae97bd4c7cf18403e1689a"><span class="std std-ref">findContours</span></a><span></span><span class="p">(</span><span class="n">bw</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ggae33c78feb670de33d2abf21ec0624531aec6d12db5ae363eb5182e77949b16d05"><span class="std std-ref">CV_RETR_LIST</span></a><span></span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1gga950bf8e3371138ceb9649d45e9a96340a68069f66db6f6a3540948eed23bf0dcf"><span class="std std-ref">CV_CHAIN_APPROX_NONE</span></a><span></span><span class="p">);</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contours</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Calculate the area of each contour</span>
        <span class="kt">double</span> <span class="n">area</span> <span class="o">=</span> <a class="reference internal" href="group_imgproc_shape.html#doxid-d3-dc0-group-imgproc-shape-1ga2c759ed9f497d4a618048a2f56dc97f1"><span class="std std-ref">contourArea</span></a><span></span><span class="p">(</span><span class="n">contours</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="c1">// Ignore contours that are too small or too large</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">area</span> <span class="o">&lt;</span> <span class="mf">1e2</span> <span class="o">||</span> <span class="mf">1e5</span> <span class="o">&lt;</span> <span class="n">area</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

        <span class="c1">// Draw each contour only for visualisation purposes</span>
        <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga746c0625f1781f1ffc9056259103edbc"><span class="std std-ref">drawContours</span></a><span></span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">hierarchy</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="c1">// Find the orientation of each shape</span>
        <span class="n">getOrientation</span><span class="p">(</span><span class="n">contours</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">src</span><span class="p">);</span>
    <span class="p">}</span>

    <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga453d42fe4cb60e5723281a89973ee563"><span class="std std-ref">imshow</span></a><span></span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>

    <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga5628525ad33f52eab17feebcfba38bd7"><span class="std std-ref">waitKey</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>Another example using PCA for dimensionality reduction while maintaining an amount of variance can be found at <a class="reference external" href="https://github.com/opencv/tree/master/samples/cpp/pca.cpp">opencv_source_code/samples/cpp/pca.cpp</a></p>
<p class="rubric">Explanation</p>
<ol class="arabic">
<li><p class="first"><strong>Read image and convert it to binary</strong></p>
<p>Here we apply the necessary pre-processing procedures in order to be able to detect the objects of interest.</p>
<pre class="highlight literal-block">
<span></span>    <span class="c1">// Load image</span>
<span class="c1">//    Mat src = imread(&quot;pca_test1.jpg&quot;);</span>
    <span class="n">Mat</span> <span class="n">src</span> <span class="o">=</span> <a class="reference internal" href="group_imgcodecs.html#doxid-d4-da8-group-imgcodecs-1ga288b8b3da0892bd651fce07b3bbd3a56"><span class="std std-ref">imread</span></a><span></span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

    <span class="c1">// Check if image is loaded successfully</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">src</span><span class="p">.</span><span class="n">data</span> <span class="o">||</span> <span class="n">src</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Problem loading image!!!&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
    <span class="p">}</span>

    <a class="reference internal" href="group_highgui.html#doxid-d7-dfc-group-highgui-1ga453d42fe4cb60e5723281a89973ee563"><span class="std std-ref">imshow</span></a><span></span><span class="p">(</span><span class="s">&quot;src&quot;</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>

    <span class="c1">// Convert image to grayscale</span>
    <span class="n">Mat</span> <span class="n">gray</span><span class="p">;</span>
    <a class="reference internal" href="group_imgproc_misc.html#doxid-d7-d1b-group-imgproc-misc-1ga397ae87e1288a81d2363b61574eb8cab"><span class="std std-ref">cvtColor</span></a><span></span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">gray</span><span class="p">,</span> <a class="reference internal" href="enum_cv_ColorConversionCodes.html#doxid-d7-d1b-group-imgproc-misc-1gga4e0972be5de079fed4e3a10e24ef5ef0a353a4b8db9040165db4dacb5bcefb6ea"><span class="std std-ref">COLOR_BGR2GRAY</span></a><span></span><span class="p">);</span>

    <span class="c1">// Convert image to binary</span>
    <span class="n">Mat</span> <span class="n">bw</span><span class="p">;</span>
    <a class="reference internal" href="group_imgproc_misc.html#doxid-d7-d1b-group-imgproc-misc-1gae8a4a146d1ca78c626a53577199e9c57"><span class="std std-ref">threshold</span></a><span></span><span class="p">(</span><span class="n">gray</span><span class="p">,</span> <span class="n">bw</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ggaea33efd5e2c69d615faad5c5965510aaa6af8cb4caea50fb9578d4543aa7b6f20"><span class="std std-ref">CV_THRESH_BINARY</span></a><span></span> <span class="o">|</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ggaea33efd5e2c69d615faad5c5965510aaa2456934f4f01402e80006a317ea2693e"><span class="std std-ref">CV_THRESH_OTSU</span></a><span></span><span class="p">);</span>
</pre>
</li>
<li><p class="first"><strong>Extract objects of interest</strong></p>
<p>Then find and filter contours by size and obtain the orientation of the remaining ones.</p>
<pre class="highlight literal-block">
<span></span><span class="c1">// Find all the contours in the thresholded image</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">Vec4i</span><span class="o">&gt;</span> <span class="n">hierarchy</span><span class="p">;</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Point</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">contours</span><span class="p">;</span>
<a class="reference internal" href="group_imgproc_shape.html#doxid-d3-dc0-group-imgproc-shape-1ga17ed9f5d79ae97bd4c7cf18403e1689a"><span class="std std-ref">findContours</span></a><span></span><span class="p">(</span><span class="n">bw</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="n">hierarchy</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ggae33c78feb670de33d2abf21ec0624531aec6d12db5ae363eb5182e77949b16d05"><span class="std std-ref">CV_RETR_LIST</span></a><span></span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1gga950bf8e3371138ceb9649d45e9a96340a68069f66db6f6a3540948eed23bf0dcf"><span class="std std-ref">CV_CHAIN_APPROX_NONE</span></a><span></span><span class="p">);</span>

<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">contours</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Calculate the area of each contour</span>
    <span class="kt">double</span> <span class="n">area</span> <span class="o">=</span> <a class="reference internal" href="group_imgproc_shape.html#doxid-d3-dc0-group-imgproc-shape-1ga2c759ed9f497d4a618048a2f56dc97f1"><span class="std std-ref">contourArea</span></a><span></span><span class="p">(</span><span class="n">contours</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="c1">// Ignore contours that are too small or too large</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">area</span> <span class="o">&lt;</span> <span class="mf">1e2</span> <span class="o">||</span> <span class="mf">1e5</span> <span class="o">&lt;</span> <span class="n">area</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>

    <span class="c1">// Draw each contour only for visualisation purposes</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga746c0625f1781f1ffc9056259103edbc"><span class="std std-ref">drawContours</span></a><span></span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">hierarchy</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="c1">// Find the orientation of each shape</span>
    <span class="n">getOrientation</span><span class="p">(</span><span class="n">contours</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">src</span><span class="p">);</span>
<span class="p">}</span>
</pre>
</li>
<li><p class="first"><strong>Extract orientation</strong></p>
<p>Orientation is extracted by the call of getOrientation() function, which performs all the PCA procedure.</p>
<pre class="highlight literal-block">
<span></span><span class="c1">//Construct a buffer used by the pca analysis</span>
<span class="kt">int</span> <span class="n">sz</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pts</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
<span class="n">Mat</span> <span class="n">data_pts</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">sz</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <a class="reference internal" href="group_core_hal_interface.html#doxid-d1-d1b-group-core-hal-interface-1ga3b256d68c6002b6afd60ab9538d717a8"><span class="std std-ref">CV_64FC1</span></a><span></span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">data_pts</span><span class="p">.</span><span class="n">rows</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">data_pts</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="p">;</span>
    <span class="n">data_pts</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//Perform PCA analysis</span>
<span class="n">PCA</span> <span class="n">pca_analysis</span><span class="p">(</span><span class="n">data_pts</span><span class="p">,</span> <span class="n">Mat</span><span class="p">(),</span> <a class="reference internal" href="group_core_c.html#doxid-d2-df8-group-core-c-1ga8010c4e67ca59cfd17d7a965cea7d198"><span class="std std-ref">CV_PCA_DATA_AS_ROW</span></a><span></span><span class="p">);</span>

<span class="c1">//Store the center of the object</span>
<span class="n">Point</span> <span class="n">cntr</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pca_analysis</span><span class="p">.</span><span class="n">mean</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                  <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pca_analysis</span><span class="p">.</span><span class="n">mean</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)));</span>

<span class="c1">//Store the eigenvalues and eigenvectors</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="n">Point2d</span><span class="o">&gt;</span> <span class="n">eigen_vecs</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">eigen_val</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">eigen_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga32986d8c6fd05949688352abd112509f"><span class="std std-ref">Point2d</span></a><span></span><span class="p">(</span><span class="n">pca_analysis</span><span class="p">.</span><span class="n">eigenvectors</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                            <span class="n">pca_analysis</span><span class="p">.</span><span class="n">eigenvectors</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>

    <span class="n">eigen_val</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pca_analysis</span><span class="p">.</span><span class="n">eigenvalues</span><span class="p">.</span><span class="n">at</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
<span class="p">}</span>
</pre>
<p>First the data need to be arranged in a matrix with size n x 2, where n is the number of data points we have. Then we can perform that PCA analysis. The calculated mean (i.e. center of mass) is stored in the <em>cntr</em> variable and the eigenvectors and eigenvalues are stored in the corresponding std::vector’s.</p>
</li>
<li><p class="first"><strong>Visualize result</strong></p>
<p>The final result is visualized through the drawAxis() function, where the principal components are drawn in lines, and each eigenvector is multiplied by its eigenvalue and translated to the mean position.</p>
<pre class="highlight literal-block">
<span></span><span class="c1">// Draw the principal components</span>
<a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1gaf10604b069374903dbd0f0488cb43670"><span class="std std-ref">circle</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cntr</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">Point</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">+</span> <span class="mf">0.02</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">0</span><span class="p">]));</span>
<span class="n">Point</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">cntr</span> <span class="o">-</span> <span class="mf">0.02</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga1e83eafb2d26b3c93f09e8338bcab192"><span class="std std-ref">Point</span></a><span></span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">x</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">y</span> <span class="o">*</span> <span class="n">eigen_val</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
<span class="n">drawAxis</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cntr</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">drawAxis</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">cntr</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <a class="reference internal" href="namespace_cv.html#doxid-dc-d84-group-core-basic-1ga599fe92e910c027be274233eccad7beb"><span class="std std-ref">Scalar</span></a><span></span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">5</span><span class="p">);</span>

<span class="kt">double</span> <span class="n">angle</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga1096ba687de70142e095cc791a8bcd65"><span class="std std-ref">atan2</span></a><span></span><span class="p">(</span><span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">y</span><span class="p">,</span> <span class="n">eigen_vecs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">x</span><span class="p">);</span> <span class="c1">// orientation in radians</span>
</pre>
<pre class="highlight literal-block">
<span></span>    <span class="kt">double</span> <span class="n">angle</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">hypotenuse</span><span class="p">;</span>
    <span class="n">angle</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga1096ba687de70142e095cc791a8bcd65"><span class="std std-ref">atan2</span></a><span></span><span class="p">(</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span><span class="p">,</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="p">);</span> <span class="c1">// angle in radians</span>
    <span class="n">hypotenuse</span> <span class="o">=</span> <a class="reference internal" href="namespace_cv.html#doxid-d2-d75-namespacecv-1a682082a1892db64a2856403ec17ba297"><span class="std std-ref">sqrt</span></a><span></span><span class="p">(</span> <span class="p">(</span><span class="kt">double</span><span class="p">)</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span><span class="p">));</span>
<span class="c1">//    double degrees = angle * 180 / CV_PI; // convert radians to degrees (0-180 range)</span>
<span class="c1">//    cout &lt;&lt; &quot;Degrees: &quot; &lt;&lt; abs(degrees - 180) &lt;&lt; endl; // angle in 0-360 degrees range</span>

    <span class="c1">// Here we lengthen the arrow by a factor of scale</span>
    <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">-</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">hypotenuse</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga2591489e47c1cb227d235872e4b5e433"><span class="std std-ref">cos</span></a><span></span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
    <span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">-</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">hypotenuse</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1gaa65ebb1958aa6daaacb7e0b94810ff87"><span class="std std-ref">sin</span></a><span></span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga7078a9fae8c7e7d13d24dac2520ae4a2"><span class="std std-ref">line</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ga32a38de93cb76391d98a1545d587a8ff"><span class="std std-ref">CV_AA</span></a><span></span><span class="p">);</span>

    <span class="c1">// create the arrow hooks</span>
    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga2591489e47c1cb227d235872e4b5e433"><span class="std std-ref">cos</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1gaa65ebb1958aa6daaacb7e0b94810ff87"><span class="std std-ref">sin</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">+</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga7078a9fae8c7e7d13d24dac2520ae4a2"><span class="std std-ref">line</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ga32a38de93cb76391d98a1545d587a8ff"><span class="std std-ref">CV_AA</span></a><span></span><span class="p">);</span>

    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a4c96fa7bdbfe390be5ed356edb274ff3"><span class="std std-ref">x</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1ga2591489e47c1cb227d235872e4b5e433"><span class="std std-ref">cos</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">-</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <span class="n">p</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="p">(</span><span class="n">q</span><span class="p">.</span><a class="reference internal" href="class_cv_Point_.html#doxid-d9-d87-classcv-1-1-point-1a157337197338ff199e5df1a393022f15"><span class="std std-ref">y</span></a><span></span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <a class="reference internal" href="namespace_cv_cudev.html#doxid-df-dfc-group-cudev-1gaa65ebb1958aa6daaacb7e0b94810ff87"><span class="std std-ref">sin</span></a><span></span><span class="p">(</span><span class="n">angle</span> <span class="o">-</span> <span class="n">CV_PI</span> <span class="o">/</span> <span class="mi">4</span><span class="p">));</span>
    <a class="reference internal" href="group_imgproc_draw.html#doxid-d6-d6e-group-imgproc-draw-1ga7078a9fae8c7e7d13d24dac2520ae4a2"><span class="std std-ref">line</span></a><span></span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <a class="reference internal" href="group_imgproc_c.html#doxid-df-d4e-group-imgproc-c-1ga32a38de93cb76391d98a1545d587a8ff"><span class="std std-ref">CV_AA</span></a><span></span><span class="p">);</span>
</pre>
<p class="rubric">Results</p>
</li>
</ol>
<p>The code opens an image, finds the orientation of the detected objects of interest and then visualizes the result by drawing the contours of the detected objects of interest, the center point, and the x-axis, y-axis regarding the extracted orientation.</p>
<img alt="_images/pca_test1.jpg" src="_images/pca_test1.jpg" />
<img alt="_images/output.png" src="_images/output.png" />
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="page_tutorial_introduction_to_svm.html" title="Introduction to Support Vector Machines"
             >next</a> |</li>
        <li class="right" >
          <a href="page_tutorial_table_of_content_ml.html" title="Machine Learning (ml module)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="page_tutorial_root.html" >OpenCV Tutorials</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="page_tutorial_table_of_content_ml.html" >Machine Learning (ml module)</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 1999-2017, OpenCV Maintainers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>