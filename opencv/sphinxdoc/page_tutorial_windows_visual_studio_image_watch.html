
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Image Watch: viewing in-memory images in the Visual Studio debugger &#8212; OpenCV Documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/doxyrest-sphinxdoc.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/target-highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation in Linux" href="page_tutorial_linux_install.html" />
    <link rel="prev" title="How to build applications with OpenCV inside the “Microsoft Visual Studio”" href="page_tutorial_windows_visual_studio_Opencv.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="page_tutorial_linux_install.html" title="Installation in Linux"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="page_tutorial_windows_visual_studio_Opencv.html" title="How to build applications with OpenCV inside the “Microsoft Visual Studio”"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="page_tutorial_root.html" >OpenCV Tutorials</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="page_tutorial_table_of_content_introduction.html" accesskey="U">Introduction to OpenCV</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="page_tutorial_windows_visual_studio_Opencv.html"
                        title="previous chapter">How to build applications with OpenCV inside the “Microsoft Visual Studio”</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="page_tutorial_linux_install.html"
                        title="next chapter">Installation in Linux</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="image-watch-viewing-in-memory-images-in-the-visual-studio-debugger">
<span id="doxid-d4-d14-tutorial-windows-visual-studio-image-watch"></span><span id="index-0"></span><h1>Image Watch: viewing in-memory images in the Visual Studio debugger</h1>
<p>Image Watch is a plug-in for Microsoft Visual Studio that lets you to visualize in-memory images (<a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">cv::Mat</span></a> or <em>IplImage_</em> objects, for example) while debugging an application. This can be helpful for tracking down bugs, or for simply understanding what a given piece of code is doing.</p>
<p class="rubric">Prerequisites</p>
<p>This tutorial assumes that you have the following available:</p>
<ol class="arabic simple">
<li>Visual Studio 2012 Professional (or better) with Update 1 installed. Update 1 can be downloaded <a class="reference external" href="http://www.microsoft.com/en-us/download/details.aspx?id=35774">here</a>.</li>
<li>An OpenCV installation on your Windows machine (Tutorial: <a class="reference internal" href="page_tutorial_windows_install.html#doxid-d3-d52-tutorial-windows-install"><span class="std std-ref">Installation in Windows</span></a>).</li>
<li>Ability to create and build OpenCV projects in Visual Studio (Tutorial: <a class="reference internal" href="page_tutorial_windows_visual_studio_Opencv.html#doxid-d6-d81-tutorial-windows-visual-studio-opencv"><span class="std std-ref">How to build applications with OpenCV inside the “Microsoft Visual Studio”</span></a>).</li>
</ol>
<p class="rubric">Installation</p>
<p><a class="reference external" href="http://go.microsoft.com/fwlink/?LinkId=285460">Download</a> the Image Watch installer. The installer comes in a single file with extension .vsix (<em>Visual Studio Extension</em>). To launch it, simply double-click on the .vsix file in Windows Explorer. When the installer has finished, make sure to restart Visual Studio to complete the installation.</p>
<p class="rubric">Example</p>
<p>Image Watch works with any existing project that uses OpenCV image objects (for example, <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">cv::Mat</span></a>). In this example, we use a minimal test program that loads an image from a file and runs an edge detector. To build the program, create a console application project in Visual Studio, name it “image-watch-demo”, and insert the source code below.</p>
<pre class="highlight literal-block">
<span></span><span class="c1">// Test application for the Visual Studio Image Watch Debugger extension</span>

<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;                        // std::cout</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;opencv2/core/core.hpp&gt;           // cv::Mat</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;opencv2/imgcodecs/imgcodecs.hpp&gt;     // cv::imread()</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;opencv2/imgproc/imgproc.hpp&gt;     // cv::Canny()</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_std.html#doxid-d8-dcc-namespacestd"><span class="std std-ref">std</span></a><span></span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <a class="reference internal" href="namespace_cv.html#doxid-d2-d75-namespacecv"><span class="std std-ref">cv</span></a><span></span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">help</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">cout</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;----------------------------------------------------&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;This is a test program for the Image Watch Debugger &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;plug-in for Visual Studio. The program loads an     &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;image from a file and runs the Canny edge detector. &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;No output is displayed or written to disk.&quot;</span>
        <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;Usage:&quot;</span>                                               <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;image-watch-demo inputimage&quot;</span>                          <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="s">&quot;----------------------------------------------------&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
        <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">help</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Wrong number of parameters&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Loading input image: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">input</span><span class="p">;</span>
    <span class="n">input</span> <span class="o">=</span> <a class="reference internal" href="group_imgcodecs.html#doxid-d4-da8-group-imgcodecs-1ga288b8b3da0892bd651fce07b3bbd3a56"><span class="std std-ref">imread</span></a><span></span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <a class="reference internal" href="enum_cv_ImreadModes.html#doxid-d4-da8-group-imgcodecs-1gga61d9b0126a3e57d9277ac48327799c80af660544735200cbe942eea09232eb822"><span class="std std-ref">IMREAD_COLOR</span></a><span></span><span class="p">);</span>

    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Detecting edges in input image&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
    <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat"><span class="std std-ref">Mat</span></a><span></span> <span class="n">edges</span><span class="p">;</span>
    <a class="reference internal" href="group_imgproc_feature.html#doxid-dd-d1a-group-imgproc-feature-1ga04723e007ed888ddf11d9ba04e2232de"><span class="std std-ref">Canny</span></a><span></span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
<p>Make sure your active solution configuration (Build&gt; Configuration Manager) is set to a debug build (usually called “Debug”). This should disable compiler optimizations so that viewing variables in the debugger can work reliably.</p>
<p>Build your solution (Build&gt; Build Solution, or press <em>F7</em>).</p>
<p>Before continuing, do not forget to add the command line argument of your input image to your project (Right click on project&gt; Properties&gt; Configuration Properties&gt; Debugging and then set the field Command Arguments with the location of the image).</p>
<p>Now set a breakpoint on the source line that says</p>
<pre class="highlight literal-block">
<span></span><span class="n">Mat</span> <span class="n">edges</span><span class="p">;</span>
</pre>
<p>To set the breakpoint, right-click on the source line and select Breakpoints&gt; Insert Breakpoint from the context menu.</p>
<p>Launch the program in the debugger (Debug&gt; Start Debugging, or hit <em>F5</em>). When the breakpoint is hit, the program is paused and Visual Studio displays a yellow instruction pointer at the breakpoint:</p>
<img alt="_images/breakpoint.png" src="_images/breakpoint.png" />
<p>Now you can inspect the state of you program. For example, you can bring up the <em>Locals</em> window (Debug&gt; Windows&gt; Locals), which will show the names and values of the variables in the current scope:</p>
<img alt="_images/vs_locals.png" src="_images/vs_locals.png" />
<p>Note that the built-in <em>Locals</em> window will display text only. This is where the Image Watch plug-in comes in. Image Watch is like another <em>Locals</em> window, but with an image viewer built into it. To bring up Image Watch, select View&gt; Other Windows&gt; Image Watch. Like Visual Studio’s <em>Locals</em> window, Image Watch can dock to the Visual Studio IDE. Also, Visual Studio will remember whether you had Image Watch open, and where it was located between debugging sessions. This means you only have to do this once the next time you start debugging, Image Watch will be back where you left it. Here’s what the docked Image Watch window looks like at our breakpoint:</p>
<img alt="_images/toolwindow.jpg" src="_images/toolwindow.jpg" />
<p>The radio button at the top left (<em>Locals/Watch</em>) selects what is shown in the <em>Image List</em> below: <em>Locals</em> lists all OpenCV image objects in the current scope (this list is automatically populated). <em>Watch</em> shows image expressions that have been pinned for continuous inspection (not described here, see <a class="reference external" href="http://go.microsoft.com/fwlink/?LinkId=285461">Image Watch documentation</a> for details). The image list shows basic information such as width, height, number of channels, and, if available, a thumbnail. In our example, the image list contains our two local image variables, <em>input</em> and <em>edges</em>.</p>
<p>If an image has a thumbnail, left-clicking on that image will select it for detailed viewing in the <em>Image Viewer</em> on the right. The viewer lets you pan (drag mouse) and zoom (mouse wheel). It also displays the pixel coordinate and value at the current mouse position.</p>
<img alt="_images/viewer.jpg" src="_images/viewer.jpg" />
<p>Note that the second image in the list, <em>edges</em>, is shown as “invalid”. This indicates that some data members of this image object have corrupt or invalid values (for example, a negative image width). This is expected at this point in the program, since the C++ constructor for <em>edges</em> has not run yet, and so its members have undefined values (in debug mode they are usually filled with “0xCD” bytes).</p>
<p>From here you can single-step through your code (Debug-&gt;Step Over, or press <em>F10</em>) and watch the pixels change: if you step once, over the <em>Mat edges;</em> statement, the <em>edges</em> image will change from “invalid” to “empty”, which means that it is now in a valid state (default constructed), even though it has not been initialized yet (using <a class="reference internal" href="class_cv_Mat.html#doxid-db-de6-classcv-1-1-mat-1a55ced2c8d844d683ea9a725c60037ad0"><span class="std std-ref">cv::Mat::create()</span></a>, for example). If you make one more step over the <a class="reference internal" href="group_imgproc_feature.html#doxid-dd-d1a-group-imgproc-feature-1ga04723e007ed888ddf11d9ba04e2232de"><span class="std std-ref">cv::Canny()</span></a> call, you will see a thumbnail of the edge image appear in the image list.</p>
<p>Now assume you want to do a visual sanity check of the <a class="reference internal" href="group_imgproc_feature.html#doxid-dd-d1a-group-imgproc-feature-1ga04723e007ed888ddf11d9ba04e2232de"><span class="std std-ref">cv::Canny()</span></a> implementation. Bring the <em>edges</em> image into the viewer by selecting it in the <em>Image List</em> and zoom into a region with a clearly defined edge:</p>
<img alt="_images/edges_zoom.png" src="_images/edges_zoom.png" />
<p>Right-click on the <em>Image Viewer</em> to bring up the view context menu and enable Link Views (a check box next to the menu item indicates whether the option is enabled).</p>
<img alt="_images/viewer_context_menu.png" src="_images/viewer_context_menu.png" />
<p>The Link Views feature keeps the view region fixed when flipping between images of the same size. To see how this works, select the input image from the image list you should now see the corresponding zoomed-in region in the input image:</p>
<img alt="_images/input_zoom.png" src="_images/input_zoom.png" />
<p>You may also switch back and forth between viewing input and edges with your up/down cursor keys. That way you can easily verify that the detected edges line up nicely with the data in the input image.</p>
<p class="rubric">More …</p>
<p>Image watch has a number of more advanced features, such as</p>
<ol class="arabic simple">
<li>pinning images to a <em>Watch</em> list for inspection across scopes or between debugging sessions</li>
<li>clamping, thresholding, or diff’ing images directly inside the Watch window</li>
<li>comparing an in-memory image against a reference image from a file</li>
</ol>
<p>Please refer to the online <a class="reference external" href="http://go.microsoft.com/fwlink/?LinkId=285461">Image Watch Documentation</a> for details you also can get to the documentation page by clicking on the <em>Help</em> link in the Image Watch window:</p>
<img alt="_images/help_button.jpg" src="_images/help_button.jpg" />
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="page_tutorial_linux_install.html" title="Installation in Linux"
             >next</a> |</li>
        <li class="right" >
          <a href="page_tutorial_windows_visual_studio_Opencv.html" title="How to build applications with OpenCV inside the “Microsoft Visual Studio”"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">OpenCV Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="page_tutorial_root.html" >OpenCV Tutorials</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="page_tutorial_table_of_content_introduction.html" >Introduction to OpenCV</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 1999-2017, OpenCV Maintainers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>