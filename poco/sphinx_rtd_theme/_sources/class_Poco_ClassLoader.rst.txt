.. index:: pair: class; Poco::ClassLoader
.. _doxid-class_poco_1_1_class_loader:

template class Poco::ClassLoader
================================

.. toctree::
	:hidden:

	struct_Poco_ClassLoader_LibraryInfo.rst
	class_Poco_ClassLoader_Iterator.rst

Overview
~~~~~~~~

The :ref:`ClassLoader <doxid-class_poco_1_1_class_loader>` loads C++ classes from shared libraries at runtime. :ref:`More...<details-class_poco_1_1_class_loader>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <ClassLoader.h>
	
	template <class Base>
	class ClassLoader
	{
	public:
		// typedefs
	
		typedef :ref:`AbstractMetaObject<doxid-class_poco_1_1_abstract_meta_object>`<Base> :target:`Meta<doxid-class_poco_1_1_class_loader_1a2672cd31bc67f30d4373ef5f7cdc863d>`;
		typedef :ref:`Manifest<doxid-class_poco_1_1_manifest>`<Base> :target:`Manif<doxid-class_poco_1_1_class_loader_1a737cf3dc6d6e47cca29cb9090cfaaf37>`;
		typedef void (*:target:`InitializeLibraryFunc<doxid-class_poco_1_1_class_loader_1a9a5cc2d67ffae07ab23cf849d77d374c>`)();
		typedef void (*:target:`UninitializeLibraryFunc<doxid-class_poco_1_1_class_loader_1ab4386f06ae66af630ee4031a0abb0b6f>`)();
		typedef bool (*:target:`BuildManifestFunc<doxid-class_poco_1_1_class_loader_1a6c96457b88746c26d5d5063b6832a1f1>`)(ManifestBase *);
		typedef std::map<std::string, :ref:`LibraryInfo<doxid-struct_poco_1_1_class_loader_1_1_library_info>`> :target:`LibraryMap<doxid-class_poco_1_1_class_loader_1af04684f86651b5b962c06198f155d7e7>`;

		// structs
	
		struct :ref:`LibraryInfo<doxid-struct_poco_1_1_class_loader_1_1_library_info>`;

		// classes
	
		class :ref:`Iterator<doxid-class_poco_1_1_class_loader_1_1_iterator>`;

		// methods
	
		void
		:ref:`loadLibrary<doxid-class_poco_1_1_class_loader_1a6b61bcd93ea7916687fa7e5e3b37df9d>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& manifest
			);
	
		void
		:ref:`loadLibrary<doxid-class_poco_1_1_class_loader_1a456885af52391e678bd5178d25eea75b>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path);
	
		void
		:ref:`unloadLibrary<doxid-class_poco_1_1_class_loader_1ad40782e8148e47fd6293fa44dbf3ba2c>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path);
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Meta<doxid-class_poco_1_1_class_loader_1a2672cd31bc67f30d4373ef5f7cdc863d>`*
		:ref:`findClass<doxid-class_poco_1_1_class_loader_1aa349c58c7276cde0bab7be86f10c04c7>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const;
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Meta<doxid-class_poco_1_1_class_loader_1a2672cd31bc67f30d4373ef5f7cdc863d>`&
		:ref:`classFor<doxid-class_poco_1_1_class_loader_1acb8430fa63e9642fdc4983476f27ba92>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const;
	
		Base*
		:ref:`create<doxid-class_poco_1_1_class_loader_1a92fc70b1a85e8c58066e3f78cf57581c>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const;
	
		Base&
		:ref:`instance<doxid-class_poco_1_1_class_loader_1ab05f43595e4a855fb8c216a3099676cd>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const;
	
		bool
		:ref:`canCreate<doxid-class_poco_1_1_class_loader_1af6337e3c01f4bbf47a115860b28ba443>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const;
	
		void
		:ref:`destroy<doxid-class_poco_1_1_class_loader_1a369ce42aea85d8c02c6efe7ffd4069ee>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className,
			Base* pObject
			) const;
	
		bool
		:ref:`isAutoDelete<doxid-class_poco_1_1_class_loader_1a8529e5bde8258b78fde6ade862c971de>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className,
			Base* pObject
			) const;
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Manif<doxid-class_poco_1_1_class_loader_1a737cf3dc6d6e47cca29cb9090cfaaf37>`*
		:ref:`findManifest<doxid-class_poco_1_1_class_loader_1ade24760e889ab2698586e49d34fb94ae>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path) const;
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Manif<doxid-class_poco_1_1_class_loader_1a737cf3dc6d6e47cca29cb9090cfaaf37>`&
		:ref:`manifestFor<doxid-class_poco_1_1_class_loader_1a25e8076497a8ec8a8d38195310af8ba0>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path) const;
	
		bool
		:ref:`isLibraryLoaded<doxid-class_poco_1_1_class_loader_1a7d0d4b25e786f0678555942f8b6f8ed5>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path) const;
	
		:ref:`Iterator<doxid-class_poco_1_1_class_loader_1_1_iterator>`
		:target:`begin<doxid-class_poco_1_1_class_loader_1a6675b4055073bec0f4d391d9b8eb552a>`() const;
	
		:ref:`Iterator<doxid-class_poco_1_1_class_loader_1_1_iterator>`
		:target:`end<doxid-class_poco_1_1_class_loader_1ad9fda67010f73734332fac0276cbdfc1>`() const;
	};
.. _details-class_poco_1_1_class_loader:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

The :ref:`ClassLoader <doxid-class_poco_1_1_class_loader>` loads C++ classes from shared libraries at runtime.

It must be instantiated with a root class of the loadable classes. For a class to be loadable from a library, the library must provide a :ref:`Manifest <doxid-class_poco_1_1_manifest>` of all the classes it contains. The :ref:`Manifest <doxid-class_poco_1_1_manifest>` for a shared library can be easily built with the help of the macros in the header file "Foundation/ClassLibrary.h".

Starting with POCO release 1.3, a class library can export multiple manifests. In addition to the default (unnamed) manifest, multiple named manifests can be exported, each having a different base class.

There is one important restriction: one instance of :ref:`ClassLoader <doxid-class_poco_1_1_class_loader>` can only load one manifest from a class library.

Construction
------------

.. _doxid-class_poco_1_1_class_loader_1ac2130a0321159978105b5f6aa6309d80:
.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	~ClassLoader()

Destroys the :ref:`ClassLoader <doxid-class_poco_1_1_class_loader>`.

Methods
-------

.. index:: pair: function; loadLibrary
.. _doxid-class_poco_1_1_class_loader_1a6b61bcd93ea7916687fa7e5e3b37df9d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	loadLibrary(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& manifest
		)

Loads a library from the given path, using the given manifest.

Does nothing if the library is already loaded. Throws a LibraryLoadException if the library cannot be loaded or does not have a :ref:`Manifest <doxid-class_poco_1_1_manifest>`. If the library exports a function named "pocoInitializeLibrary", this function is executed. If called multiple times for the same library, the number of calls to :ref:`unloadLibrary() <doxid-class_poco_1_1_class_loader_1ad40782e8148e47fd6293fa44dbf3ba2c>` must be the same for the library to become unloaded.

.. index:: pair: function; loadLibrary
.. _doxid-class_poco_1_1_class_loader_1a456885af52391e678bd5178d25eea75b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	loadLibrary(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path)

Loads a library from the given path.

Does nothing if the library is already loaded. Throws a LibraryLoadException if the library cannot be loaded or does not have a :ref:`Manifest <doxid-class_poco_1_1_manifest>`. If the library exports a function named "pocoInitializeLibrary", this function is executed. If called multiple times for the same library, the number of calls to :ref:`unloadLibrary() <doxid-class_poco_1_1_class_loader_1ad40782e8148e47fd6293fa44dbf3ba2c>` must be the same for the library to become unloaded.

Equivalent to loadLibrary(path, "").

.. index:: pair: function; unloadLibrary
.. _doxid-class_poco_1_1_class_loader_1ad40782e8148e47fd6293fa44dbf3ba2c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	unloadLibrary(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path)

Unloads the given library.

Be extremely cautious when unloading shared libraries. If objects from the library are still referenced somewhere, a total crash is very likely. If the library exports a function named "pocoUninitializeLibrary", this function is executed before it is unloaded. If :ref:`loadLibrary() <doxid-class_poco_1_1_class_loader_1a6b61bcd93ea7916687fa7e5e3b37df9d>` has been called multiple times for the same library, the number of calls to :ref:`unloadLibrary() <doxid-class_poco_1_1_class_loader_1ad40782e8148e47fd6293fa44dbf3ba2c>` must be the same for the library to become unloaded.

.. index:: pair: function; findClass
.. _doxid-class_poco_1_1_class_loader_1aa349c58c7276cde0bab7be86f10c04c7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Meta<doxid-class_poco_1_1_class_loader_1a2672cd31bc67f30d4373ef5f7cdc863d>`*
	findClass(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const

Returns a pointer to the :ref:`MetaObject <doxid-class_poco_1_1_meta_object>` for the given class, or a null pointer if the class is not known.

.. index:: pair: function; classFor
.. _doxid-class_poco_1_1_class_loader_1acb8430fa63e9642fdc4983476f27ba92:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Meta<doxid-class_poco_1_1_class_loader_1a2672cd31bc67f30d4373ef5f7cdc863d>`&
	classFor(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const

Returns a reference to the :ref:`MetaObject <doxid-class_poco_1_1_meta_object>` for the given class.

Throws a NotFoundException if the class is not known.

.. index:: pair: function; create
.. _doxid-class_poco_1_1_class_loader_1a92fc70b1a85e8c58066e3f78cf57581c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	Base*
	create(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const

Creates an instance of the given class.

Throws a NotFoundException if the class is not known.

.. index:: pair: function; instance
.. _doxid-class_poco_1_1_class_loader_1ab05f43595e4a855fb8c216a3099676cd:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	Base&
	instance(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const

Returns a reference to the sole instance of the given class.

The class must be a singleton, otherwise an InvalidAccessException will be thrown. Throws a NotFoundException if the class is not known.

.. index:: pair: function; canCreate
.. _doxid-class_poco_1_1_class_loader_1af6337e3c01f4bbf47a115860b28ba443:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	canCreate(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className) const

Returns true if :ref:`create() <doxid-class_poco_1_1_class_loader_1a92fc70b1a85e8c58066e3f78cf57581c>` can create new instances of the class.

.. index:: pair: function; destroy
.. _doxid-class_poco_1_1_class_loader_1a369ce42aea85d8c02c6efe7ffd4069ee:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	destroy(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className,
		Base* pObject
		) const

Destroys the object pObject points to.

Does nothing if object is not found.

.. index:: pair: function; isAutoDelete
.. _doxid-class_poco_1_1_class_loader_1a8529e5bde8258b78fde6ade862c971de:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	isAutoDelete(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& className,
		Base* pObject
		) const

Returns true if the object is automatically deleted by its meta object.

.. index:: pair: function; findManifest
.. _doxid-class_poco_1_1_class_loader_1ade24760e889ab2698586e49d34fb94ae:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Manif<doxid-class_poco_1_1_class_loader_1a737cf3dc6d6e47cca29cb9090cfaaf37>`*
	findManifest(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path) const

Returns a pointer to the :ref:`Manifest <doxid-class_poco_1_1_manifest>` for the given library, or a null pointer if the library has not been loaded.

.. index:: pair: function; manifestFor
.. _doxid-class_poco_1_1_class_loader_1a25e8076497a8ec8a8d38195310af8ba0:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Manif<doxid-class_poco_1_1_class_loader_1a737cf3dc6d6e47cca29cb9090cfaaf37>`&
	manifestFor(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path) const

Returns a reference to the :ref:`Manifest <doxid-class_poco_1_1_manifest>` for the given library Throws a NotFoundException if the library has not been loaded.

.. index:: pair: function; isLibraryLoaded
.. _doxid-class_poco_1_1_class_loader_1a7d0d4b25e786f0678555942f8b6f8ed5:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	isLibraryLoaded(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path) const

Returns true if the library with the given name has already been loaded.

