.. index:: pair: class; Poco::EventLogChannel
.. _doxid-class_poco_1_1_event_log_channel:

class Poco::EventLogChannel
===========================

.. toctree::
	:hidden:

Overview
~~~~~~~~

This Windows-only channel works with the Windows NT :ref:`Event <doxid-class_poco_1_1_event>` Log service. :ref:`More...<details-class_poco_1_1_event_log_channel>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <EventLogChannel.h>
	
	class EventLogChannel: public :ref:`Poco::Channel<doxid-class_poco_1_1_channel>`
	{
	public:
		// fields
	
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string :target:`PROP_NAME<doxid-class_poco_1_1_event_log_channel_1ae4e85b33db3e1aab5fd6f06b2398feb0>`;
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string :target:`PROP_HOST<doxid-class_poco_1_1_event_log_channel_1ab3b3f723bc74ab3de85fbf4e2ca4e739>`;
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string :target:`PROP_LOGHOST<doxid-class_poco_1_1_event_log_channel_1a4ecf9aea162aaa129ae21dee5b377d17>`;
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string :target:`PROP_LOGFILE<doxid-class_poco_1_1_event_log_channel_1a2e5dab93f4ea29d6e7add73b7ebfe2ab>`;

		// construction
	
		:ref:`EventLogChannel<doxid-class_poco_1_1_event_log_channel_1aad44f8a981401551ab8e8a0c0460df2a>`();
		:ref:`EventLogChannel<doxid-class_poco_1_1_event_log_channel_1a5bf4c334c71d3bb8cc94c12608c63524>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		:ref:`EventLogChannel<doxid-class_poco_1_1_event_log_channel_1adee1a659796d1fe404f62efa7fa7df60>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& host
			);

		// methods
	
		virtual
		void
		:ref:`open<doxid-class_poco_1_1_event_log_channel_1a64d0fde321e10eee50853ed2bc16148a>`();
	
		virtual
		void
		:ref:`close<doxid-class_poco_1_1_event_log_channel_1acb2b6d3e2f0ef0403374c42d78460cf2>`();
	
		virtual
		void
		:ref:`log<doxid-class_poco_1_1_event_log_channel_1a45b02b67bfcf80c823d802ad49a443a2>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Message<doxid-class_poco_1_1_message>`& msg);
	
		virtual
		void
		:ref:`setProperty<doxid-class_poco_1_1_event_log_channel_1a1b35fb9a74c68bdfdc544e270088a9ff>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
			);
	
		virtual
		std::string
		:ref:`getProperty<doxid-class_poco_1_1_event_log_channel_1a50e7d14847fb98c3a8afc12c453e7f56>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name) const;

	protected:
		// methods
	
		void
		:target:`setUpRegistry<doxid-class_poco_1_1_event_log_channel_1ae2e0fdb28af288fc970e2867fe138655>`() const;
	
		static
		int
		:target:`getType<doxid-class_poco_1_1_event_log_channel_1a17ae0b4c705bba4391db6a5cf86ff5f9>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Message<doxid-class_poco_1_1_message>`& msg);
	
		static
		int
		:target:`getCategory<doxid-class_poco_1_1_event_log_channel_1a3e65abf4bbff9d0f10ee75b3353c9d77>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Message<doxid-class_poco_1_1_message>`& msg);
	
		static
		std::string
		:target:`findLibrary<doxid-class_poco_1_1_event_log_channel_1a1d715f5e703cb4c2f2c0e12f0ead7e74>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` char* name);
	};

Inherited Members
-----------------

.. ref-code-block:: cpp
	:class: doxyrest-overview-inherited-code-block

	public:
		// methods
	
		virtual
		void
		:ref:`setProperty<doxid-class_poco_1_1_configurable_1ae31289819bd01f4a1bda0be67144d5bf>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
			) = 0;
	
		virtual
		std::string
		:ref:`getProperty<doxid-class_poco_1_1_configurable_1a565940a99f096c005743a68040ca5e25>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name) const = 0;
	
		void
		:ref:`duplicate<doxid-class_poco_1_1_ref_counted_object_1a13296da57127169ed0709b3dde86bf0d>`() const;
	
		void
		:ref:`release<doxid-class_poco_1_1_ref_counted_object_1a14bf204923a6ba4b97df6f8fdb9deb72>`() const;
	
		int
		:ref:`referenceCount<doxid-class_poco_1_1_ref_counted_object_1a45b62ccd833bcb06055399c2d889eb35>`() const;
	
		virtual
		void
		:ref:`open<doxid-class_poco_1_1_channel_1aef60226200d2e287068a62d9af5a4f6e>`();
	
		virtual
		void
		:ref:`close<doxid-class_poco_1_1_channel_1a2056a173f804c51411942649bd4d6408>`();
	
		virtual
		void
		:ref:`log<doxid-class_poco_1_1_channel_1aeafdcc5ce2e0e38d96f15a60a563da4e>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Message<doxid-class_poco_1_1_message>`& msg) = 0;
	
		virtual
		void
		:ref:`setProperty<doxid-class_poco_1_1_channel_1a67c2a274e476745b902ced03fb485c6e>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
			);
	
		virtual
		std::string
		:ref:`getProperty<doxid-class_poco_1_1_channel_1a187321f59674dfde457599885a4f6ec0>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name) const;

.. _details-class_poco_1_1_event_log_channel:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

This Windows-only channel works with the Windows NT :ref:`Event <doxid-class_poco_1_1_event>` Log service.

To work properly, the :ref:`EventLogChannel <doxid-class_poco_1_1_event_log_channel>` class requires that either the PocoFoundation.dll or the PocoMsg.dll :ref:`Dynamic <doxid-namespace_poco_1_1_dynamic>` Link Library containing the message definition resources can be found in $PATH.

Construction
------------

.. index:: pair: function; EventLogChannel
.. _doxid-class_poco_1_1_event_log_channel_1aad44f8a981401551ab8e8a0c0460df2a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	EventLogChannel()

Creates the :ref:`EventLogChannel <doxid-class_poco_1_1_event_log_channel>`.

The name of the current application (or more correctly, the name of its executable) is taken as event source name.

.. index:: pair: function; EventLogChannel
.. _doxid-class_poco_1_1_event_log_channel_1a5bf4c334c71d3bb8cc94c12608c63524:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	EventLogChannel(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Creates the :ref:`EventLogChannel <doxid-class_poco_1_1_event_log_channel>` with the given event source name.

.. index:: pair: function; EventLogChannel
.. _doxid-class_poco_1_1_event_log_channel_1adee1a659796d1fe404f62efa7fa7df60:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	EventLogChannel(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& host
		)

Creates an :ref:`EventLogChannel <doxid-class_poco_1_1_event_log_channel>` with the given event source name that routes messages to the given host.

Methods
-------

.. index:: pair: function; open
.. _doxid-class_poco_1_1_event_log_channel_1a64d0fde321e10eee50853ed2bc16148a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	open()

Opens the :ref:`EventLogChannel <doxid-class_poco_1_1_event_log_channel>`.

If necessary, the required registry entries to register a message resource DLL are made.

.. index:: pair: function; close
.. _doxid-class_poco_1_1_event_log_channel_1acb2b6d3e2f0ef0403374c42d78460cf2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	close()

Closes the :ref:`EventLogChannel <doxid-class_poco_1_1_event_log_channel>`.

.. index:: pair: function; log
.. _doxid-class_poco_1_1_event_log_channel_1a45b02b67bfcf80c823d802ad49a443a2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	log(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Message<doxid-class_poco_1_1_message>`& msg)

Logs the given message to the Windows :ref:`Event <doxid-class_poco_1_1_event>` Log.

The message type and priority are mapped to appropriate values for :ref:`Event <doxid-class_poco_1_1_event>` Log type and category.

.. index:: pair: function; setProperty
.. _doxid-class_poco_1_1_event_log_channel_1a1b35fb9a74c68bdfdc544e270088a9ff:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	setProperty(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
		)

Sets or changes a configuration property.

The following properties are supported:

.. ref-code-block:: cpp

	* name:    The name of the event source.
	* loghost: The name of the host where the Event Log service is running.
	           The default is "localhost".
	* host:    same as host.
	* logfile: The name of the log file. The default is "Application".

.. index:: pair: function; getProperty
.. _doxid-class_poco_1_1_event_log_channel_1a50e7d14847fb98c3a8afc12c453e7f56:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	std::string
	getProperty(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name) const

Returns the value of the given property.

