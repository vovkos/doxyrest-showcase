.. index:: pair: class; Poco::Net::ICMPPacketImpl
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl:

class Poco::Net::ICMPPacketImpl
===============================

.. toctree::
	:hidden:

Overview
~~~~~~~~

This is the abstract class for ICMP packet implementations. :ref:`More...<details-class_poco_1_1_net_1_1_i_c_m_p_packet_impl>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <ICMPPacketImpl.h>
	
	class ICMPPacketImpl
	{
	public:
		// fields
	
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` Poco::UInt16 :target:`MAX_PACKET_SIZE<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1ae71b99b94458403e4014fb38c40c4cf6>`;
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` Poco::UInt16 :target:`MAX_SEQ_VALUE<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a800983f86842fd194b5e5d88683e6ed6>`;

		// construction
	
		:ref:`ICMPPacketImpl<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1aadf4c414d32dbe95fdeb60cc40c41f96>`(int dataSize = 48);

		// methods
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` Poco::UInt8*
		:ref:`packet<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a897a74006bdaa3b5fdd5545b0b86fa3d>`(bool init = true);
	
		virtual
		int
		:ref:`packetSize<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a019c75f64c863180aacfa02a4985291a>`() const = 0;
	
		virtual
		int
		:ref:`maxPacketSize<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1aa1fe64ccafb36a3beb00af0335b74eb2>`() const;
	
		Poco::UInt16
		:ref:`sequence<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1ab3e6df9397d4f0fdb3be3d43fa234c4a>`() const;
	
		void
		:ref:`setDataSize<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1abae6175a660cf96b338e5223b8b4f26a>`(int dataSize);
	
		int
		:ref:`getDataSize<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a0357b17bfc97f6a1a5a08d062a5bee16>`() const;
	
		virtual
		struct timeval
		:ref:`time<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1aad7c4b3009395905d460b839a8d07aeb>`(
			Poco::UInt8* buffer = 0,
			int length = 0
			) const = 0;
	
		virtual
		bool
		:ref:`validReplyID<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1abf0b1b8ca93ce216ad36f0384eb47db3>`(
			unsigned char* buffer,
			int length
			) const = 0;
	
		virtual
		std::string
		:ref:`errorDescription<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a7506d2823a217f1452cde279cad2d8fb>`(
			Poco::UInt8* buffer,
			int length
			) = 0;
	
		virtual
		std::string
		:ref:`typeDescription<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a991cfa8dbdfa865aa21283752c65f7b3>`(int typeId) = 0;

	protected:
		// methods
	
		Poco::UInt16
		:ref:`nextSequence<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1ad970e3bd3a35fab8c7c696e80a2ac747>`();
	
		void
		:ref:`resetSequence<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a5de065cfb5f29d6caac74c0fd4f45de4>`();
	
		virtual
		void
		:ref:`initPacket<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a3b74e2ea09b4b396c9db60f52de97567>`() = 0;
	
		Poco::UInt16
		:ref:`checksum<doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a95ef8e384edef91acdce2ab688e91b13>`(
			Poco::UInt16* addr,
			Poco::Int32 len
			);
	};

	// direct descendants

	class :ref:`ICMPv4PacketImpl<doxid-class_poco_1_1_net_1_1_i_c_m_pv4_packet_impl>`;
.. _details-class_poco_1_1_net_1_1_i_c_m_p_packet_impl:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

This is the abstract class for ICMP packet implementations.

Construction
------------

.. index:: pair: function; ICMPPacketImpl
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1aadf4c414d32dbe95fdeb60cc40c41f96:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	ICMPPacketImpl(int dataSize = 48)

Constructor. Creates an :ref:`ICMPPacketImpl <doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl>`.

Methods
-------

.. index:: pair: function; packet
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a897a74006bdaa3b5fdd5545b0b86fa3d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` Poco::UInt8*
	packet(bool init = true)

Returns raw ICMP packet.

ICMP header and data are included in the packet. If init is true, :ref:`initPacket() <doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a3b74e2ea09b4b396c9db60f52de97567>` is called.

.. index:: pair: function; packetSize
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a019c75f64c863180aacfa02a4985291a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	packetSize() const = 0

Returns the total size of packet (ICMP header + data) in number of octets.

Must be overriden.

.. index:: pair: function; maxPacketSize
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1aa1fe64ccafb36a3beb00af0335b74eb2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	maxPacketSize() const

Returns the maximum permitted size of packet in number of octets.

.. index:: pair: function; sequence
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1ab3e6df9397d4f0fdb3be3d43fa234c4a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	Poco::UInt16
	sequence() const

Returns the most recent sequence number generated.

.. index:: pair: function; setDataSize
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1abae6175a660cf96b338e5223b8b4f26a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setDataSize(int dataSize)

Sets data size.

.. index:: pair: function; getDataSize
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a0357b17bfc97f6a1a5a08d062a5bee16:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	getDataSize() const

Returns data size.

.. index:: pair: function; time
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1aad7c4b3009395905d460b839a8d07aeb:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	struct timeval
	time(
		Poco::UInt8* buffer = 0,
		int length = 0
		) const = 0

Returns current epoch time if either argument is equal to zero.

Otherwise, it extracts the time value from the supplied buffer.

Supplied buffer includes IP header, ICMP header and data. Must be overriden.

.. index:: pair: function; validReplyID
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1abf0b1b8ca93ce216ad36f0384eb47db3:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	bool
	validReplyID(
		unsigned char* buffer,
		int length
		) const = 0

Returns true if the extracted id is recognized (i.e.

equals the process id).

Supplied buffer includes IP header, ICMP header and data. Must be overriden.

.. index:: pair: function; errorDescription
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a7506d2823a217f1452cde279cad2d8fb:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	std::string
	errorDescription(
		Poco::UInt8* buffer,
		int length
		) = 0

Returns error description string.

If supplied buffer contains an ICMP echo reply packet, an empty string is returned indicating the absence of error.

Supplied buffer includes IP header, ICMP header and data. Must be overriden.

.. index:: pair: function; typeDescription
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a991cfa8dbdfa865aa21283752c65f7b3:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	std::string
	typeDescription(int typeId) = 0

Returns the description of the packet type.

Must be overriden.

.. index:: pair: function; nextSequence
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1ad970e3bd3a35fab8c7c696e80a2ac747:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	Poco::UInt16
	nextSequence()

Increments sequence number and returns the new value.

.. index:: pair: function; resetSequence
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a5de065cfb5f29d6caac74c0fd4f45de4:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	resetSequence()

Resets the sequence to zero.

.. index:: pair: function; initPacket
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a3b74e2ea09b4b396c9db60f52de97567:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	initPacket() = 0

(Re)assembles the packet.

Must be overriden.

.. index:: pair: function; checksum
.. _doxid-class_poco_1_1_net_1_1_i_c_m_p_packet_impl_1a95ef8e384edef91acdce2ab688e91b13:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	Poco::UInt16
	checksum(
		Poco::UInt16* addr,
		Poco::Int32 len
		)

Calculates the checksum for supplied buffer.

