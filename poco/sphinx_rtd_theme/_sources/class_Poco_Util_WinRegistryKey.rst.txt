.. index:: pair: class; Poco::Util::WinRegistryKey
.. _doxid-class_poco_1_1_util_1_1_win_registry_key:

class Poco::Util::WinRegistryKey
================================

.. toctree::
	:hidden:

	enum_Poco_Util_WinRegistryKey_Type.rst

Overview
~~~~~~~~

This class implements a convenient interface to the Windows Registry. :ref:`More...<details-class_poco_1_1_util_1_1_win_registry_key>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <WinRegistryKey.h>
	
	class WinRegistryKey
	{
	public:
		// typedefs
	
		typedef std::vector<std::string> :target:`Keys<doxid-class_poco_1_1_util_1_1_win_registry_key_1a7dabbf6fc0f8a1ece806d34a2a48ca4d>`;
		typedef std::vector<std::string> :target:`Values<doxid-class_poco_1_1_util_1_1_win_registry_key_1aafb50b4d13a94d3a300f51a78f4425de>`;

		// enums
	
		enum :ref:`Type<doxid-class_poco_1_1_util_1_1_win_registry_key_1a5f6213f3a2f21a337b923e08aa6b2748>`;

		// construction
	
		:ref:`WinRegistryKey<doxid-class_poco_1_1_util_1_1_win_registry_key_1a95dfe2f70b153cc0a23fecbdd53ac38b>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& key,
			bool readOnly = false,
			REGSAM extraSam = 0
			);
	
		:ref:`WinRegistryKey<doxid-class_poco_1_1_util_1_1_win_registry_key_1a11456dada354b504c4960691321beee0>`(
			HKEY hRootKey,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& subKey,
			bool readOnly = false,
			REGSAM extraSam = 0
			);

		// methods
	
		void
		:ref:`setString<doxid-class_poco_1_1_util_1_1_win_registry_key_1a8fdc63c29e1908434dc44a116ab2648d>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
			);
	
		std::string
		:ref:`getString<doxid-class_poco_1_1_util_1_1_win_registry_key_1a181cbdef3c73d1583825df6fa44faad7>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		void
		:ref:`setStringExpand<doxid-class_poco_1_1_util_1_1_win_registry_key_1a6f11f0801e913ee292aab6a852e2717d>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
			);
	
		std::string
		:ref:`getStringExpand<doxid-class_poco_1_1_util_1_1_win_registry_key_1aca69137c53fc87a6f723e316040432ad>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		void
		:ref:`setBinary<doxid-class_poco_1_1_util_1_1_win_registry_key_1a02b7540cdfc3a7a63aa26d8b2dc4ecd1>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::vector<char>& value
			);
	
		std::vector<char>
		:ref:`getBinary<doxid-class_poco_1_1_util_1_1_win_registry_key_1a943f191adc28e85e7e7e22ba3ab850dc>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		void
		:ref:`setInt<doxid-class_poco_1_1_util_1_1_win_registry_key_1a886747d7e89b3895b8f16bb9e4c1d31d>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
			int value
			);
	
		int
		:ref:`getInt<doxid-class_poco_1_1_util_1_1_win_registry_key_1aed70baccaa1f12660a7aaed6ddc71547>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		void
		:ref:`deleteValue<doxid-class_poco_1_1_util_1_1_win_registry_key_1ab3dc03f655f550f58fe44533b2a8d988>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		void
		:ref:`deleteKey<doxid-class_poco_1_1_util_1_1_win_registry_key_1a8d2cac48573acb26b8bedb6878b313de>`();
	
		bool
		:ref:`exists<doxid-class_poco_1_1_util_1_1_win_registry_key_1a5c972be1def1bf501674c50f63e74714>`();
	
		:ref:`Type<doxid-class_poco_1_1_util_1_1_win_registry_key_1a5f6213f3a2f21a337b923e08aa6b2748>`
		:ref:`type<doxid-class_poco_1_1_util_1_1_win_registry_key_1a376e43a7878eb6a502bec538d765cb22>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		bool
		:ref:`exists<doxid-class_poco_1_1_util_1_1_win_registry_key_1ae0b39c45968d3b8bb2d80719bac27aa6>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		void
		:ref:`subKeys<doxid-class_poco_1_1_util_1_1_win_registry_key_1aefb536acb3f7db31f5f1d23bdd6e6130>`(:ref:`Keys<doxid-class_poco_1_1_util_1_1_win_registry_key_1a7dabbf6fc0f8a1ece806d34a2a48ca4d>`& keys);
	
		void
		:ref:`values<doxid-class_poco_1_1_util_1_1_win_registry_key_1aa9c2ed1878e0861f126c01e05c20faf0>`(:ref:`Values<doxid-class_poco_1_1_util_1_1_win_registry_key_1aafb50b4d13a94d3a300f51a78f4425de>`& vals);
	
		bool
		:ref:`isReadOnly<doxid-class_poco_1_1_util_1_1_win_registry_key_1ae27fbb1789b42474de8a96f214b4daf3>`() const;

	protected:
		// methods
	
		void
		:target:`open<doxid-class_poco_1_1_util_1_1_win_registry_key_1aaf15380d7b019d8b00fd35983d51b1d7>`();
	
		void
		:target:`close<doxid-class_poco_1_1_util_1_1_win_registry_key_1a6c23df6344a447d04f398c99f1257687>`();
	
		std::string
		:target:`key<doxid-class_poco_1_1_util_1_1_win_registry_key_1a866b62a2c29eda2b8c37607da469d626>`() const;
	
		std::string
		:target:`key<doxid-class_poco_1_1_util_1_1_win_registry_key_1aca3a710c82cdab5fcd031ae80589b2e2>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& valueName) const;
	
		HKEY
		:target:`handle<doxid-class_poco_1_1_util_1_1_win_registry_key_1a265eb61b8c578d37bef6ab13c48ce3da>`();
	
		void
		:target:`handleSetError<doxid-class_poco_1_1_util_1_1_win_registry_key_1a254bee4c9dbe2127d6fb1de3401dae3a>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);
	
		static
		HKEY
		:target:`handleFor<doxid-class_poco_1_1_util_1_1_win_registry_key_1a2567ecdc3fb041fdf69ec70d5453a144>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& rootKey);
	};
.. _details-class_poco_1_1_util_1_1_win_registry_key:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

This class implements a convenient interface to the Windows Registry.

This class is only available on Windows platforms.

Construction
------------

.. index:: pair: function; WinRegistryKey
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a95dfe2f70b153cc0a23fecbdd53ac38b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	WinRegistryKey(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& key,
		bool readOnly = false,
		REGSAM extraSam = 0
		)

Creates the :ref:`WinRegistryKey <doxid-class_poco_1_1_util_1_1_win_registry_key>`.

The key must start with one of the root key names like HKEY_CLASSES_ROOT, e.g. HKEY_LOCAL_MACHINE.

If readOnly is true, then only read access to the registry is available and any attempt to write to the registry will result in an exception.

extraSam is used to pass extra flags (in addition to KEY_READ and KEY_WRITE) to the samDesired argument of RegOpenKeyEx() or RegCreateKeyEx().

.. index:: pair: function; WinRegistryKey
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a11456dada354b504c4960691321beee0:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	WinRegistryKey(
		HKEY hRootKey,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& subKey,
		bool readOnly = false,
		REGSAM extraSam = 0
		)

Creates the :ref:`WinRegistryKey <doxid-class_poco_1_1_util_1_1_win_registry_key>`.

If readOnly is true, then only read access to the registry is available and any attempt to write to the registry will result in an exception.

extraSam is used to pass extra flags (in addition to KEY_READ and KEY_WRITE) to the samDesired argument of RegOpenKeyEx() or RegCreateKeyEx().

Methods
-------

.. index:: pair: function; setString
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a8fdc63c29e1908434dc44a116ab2648d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setString(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
		)

Sets the string value (REG_SZ) with the given name.

An empty name denotes the default value.

.. index:: pair: function; getString
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a181cbdef3c73d1583825df6fa44faad7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::string
	getString(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Returns the string value (REG_SZ) with the given name.

An empty name denotes the default value.

Throws a NotFoundException if the value does not exist.

.. index:: pair: function; setStringExpand
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a6f11f0801e913ee292aab6a852e2717d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setStringExpand(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& value
		)

Sets the expandable string value (REG_EXPAND_SZ) with the given name.

An empty name denotes the default value.

.. index:: pair: function; getStringExpand
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1aca69137c53fc87a6f723e316040432ad:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::string
	getStringExpand(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Returns the string value (REG_EXPAND_SZ) with the given name.

An empty name denotes the default value. All references to environment variables (VAR%) in the string are expanded.

Throws a NotFoundException if the value does not exist.

.. index:: pair: function; setBinary
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a02b7540cdfc3a7a63aa26d8b2dc4ecd1:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setBinary(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::vector<char>& value
		)

Sets the string value (REG_BINARY) with the given name.

An empty name denotes the default value.

.. index:: pair: function; getBinary
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a943f191adc28e85e7e7e22ba3ab850dc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::vector<char>
	getBinary(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Returns the string value (REG_BINARY) with the given name.

An empty name denotes the default value.

Throws a NotFoundException if the value does not exist.

.. index:: pair: function; setInt
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a886747d7e89b3895b8f16bb9e4c1d31d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setInt(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name,
		int value
		)

Sets the numeric (REG_DWORD) value with the given name.

An empty name denotes the default value.

.. index:: pair: function; getInt
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1aed70baccaa1f12660a7aaed6ddc71547:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	getInt(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Returns the numeric value (REG_DWORD) with the given name.

An empty name denotes the default value.

Throws a NotFoundException if the value does not exist.

.. index:: pair: function; deleteValue
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1ab3dc03f655f550f58fe44533b2a8d988:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	deleteValue(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Deletes the value with the given name.

Throws a NotFoundException if the value does not exist.

.. index:: pair: function; deleteKey
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a8d2cac48573acb26b8bedb6878b313de:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	deleteKey()

Recursively deletes the key and all subkeys.

.. index:: pair: function; exists
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a5c972be1def1bf501674c50f63e74714:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	exists()

Returns true iff the key exists.

.. index:: pair: function; type
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1a376e43a7878eb6a502bec538d765cb22:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`Type<doxid-class_poco_1_1_util_1_1_win_registry_key_1a5f6213f3a2f21a337b923e08aa6b2748>`
	type(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Returns the type of the key value.

.. index:: pair: function; exists
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1ae0b39c45968d3b8bb2d80719bac27aa6:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	exists(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Returns true iff the given value exists under that key.

.. index:: pair: function; subKeys
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1aefb536acb3f7db31f5f1d23bdd6e6130:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	subKeys(:ref:`Keys<doxid-class_poco_1_1_util_1_1_win_registry_key_1a7dabbf6fc0f8a1ece806d34a2a48ca4d>`& keys)

Appends all subKey names to keys.

.. index:: pair: function; values
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1aa9c2ed1878e0861f126c01e05c20faf0:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	values(:ref:`Values<doxid-class_poco_1_1_util_1_1_win_registry_key_1aafb50b4d13a94d3a300f51a78f4425de>`& vals)

Appends all value names to vals;.

.. index:: pair: function; isReadOnly
.. _doxid-class_poco_1_1_util_1_1_win_registry_key_1ae27fbb1789b42474de8a96f214b4daf3:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	isReadOnly() const

Returns true iff the key has been opened for read-only access only.

