.. index:: pair: class; Poco::DirectoryWatcher
.. _doxid-class_poco_1_1_directory_watcher:

class Poco::DirectoryWatcher
============================

.. toctree::
	:hidden:

	enum_Poco_DirectoryWatcher_DirectoryEventMask.rst
	enum_Poco_DirectoryWatcher_DirectoryEventType.rst
	struct_Poco_DirectoryWatcher_DirectoryEvent.rst

Overview
~~~~~~~~

This class is used to get notifications about changes to the filesystem, more specifically, to a specific directory. :ref:`More...<details-class_poco_1_1_directory_watcher>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <DirectoryWatcher.h>
	
	class DirectoryWatcher: protected :ref:`Poco::Runnable<doxid-class_poco_1_1_runnable>`
	{
	public:
		// enums
	
		enum
		{
		    :ref:`DW_DEFAULT_SCAN_INTERVAL<doxid-class_poco_1_1_directory_watcher_1ac2a1c73a685ac92ea1a31b73709a99cead1547e2c14312b8359940598b18d06bb>` = 5,
		};
	
		enum :ref:`DirectoryEventMask<doxid-class_poco_1_1_directory_watcher_1afafd443bec6747c77d00a0d40610bc87>`;
		enum :ref:`DirectoryEventType<doxid-class_poco_1_1_directory_watcher_1a0117c1fb5de043a3b92d3e4f586803fa>`;

		// structs
	
		struct :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`;

		// fields
	
		:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> :ref:`itemAdded<doxid-class_poco_1_1_directory_watcher_1a1dca026393020b11972450558a71aa2a>`;
		:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> :ref:`itemRemoved<doxid-class_poco_1_1_directory_watcher_1a16c1d4ef189bff35f59039003c9482aa>`;
		:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> :ref:`itemModified<doxid-class_poco_1_1_directory_watcher_1a7550b7bccbd5366e68dbcaa8cb2a3ce9>`;
		:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> :ref:`itemMovedFrom<doxid-class_poco_1_1_directory_watcher_1a3a95f2b4a37353b4fbddf2c7827632ce>`;
		:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> :ref:`itemMovedTo<doxid-class_poco_1_1_directory_watcher_1a98493853cad7643750589acec38d1ebb>`;
		:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Exception<doxid-class_poco_1_1_exception>`> :ref:`scanError<doxid-class_poco_1_1_directory_watcher_1a43ae2db6d48767f8dc425cb79a2bcf88>`;

		// construction
	
		:ref:`DirectoryWatcher<doxid-class_poco_1_1_directory_watcher_1a9bde964821812b6e9fabe6bdfc7aab86>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path,
			int eventMask = :ref:`DW_FILTER_ENABLE_ALL<doxid-class_poco_1_1_directory_watcher_1afafd443bec6747c77d00a0d40610bc87a62ffb5186dd4b98fbeb04fbc82b825cb>`,
			int scanInterval = :ref:`DW_DEFAULT_SCAN_INTERVAL<doxid-class_poco_1_1_directory_watcher_1ac2a1c73a685ac92ea1a31b73709a99cead1547e2c14312b8359940598b18d06bb>`
			);
	
		:ref:`DirectoryWatcher<doxid-class_poco_1_1_directory_watcher_1a51e8be8c08443c6028a0ace41b3ac97b>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`File<doxid-class_poco_1_1_file>`& directory,
			int eventMask = :ref:`DW_FILTER_ENABLE_ALL<doxid-class_poco_1_1_directory_watcher_1afafd443bec6747c77d00a0d40610bc87a62ffb5186dd4b98fbeb04fbc82b825cb>`,
			int scanInterval = :ref:`DW_DEFAULT_SCAN_INTERVAL<doxid-class_poco_1_1_directory_watcher_1ac2a1c73a685ac92ea1a31b73709a99cead1547e2c14312b8359940598b18d06bb>`
			);

		// methods
	
		void
		:ref:`suspendEvents<doxid-class_poco_1_1_directory_watcher_1ad37c05876bf46f6b06279a523f2553b2>`();
	
		void
		:ref:`resumeEvents<doxid-class_poco_1_1_directory_watcher_1a815ee4aab5d2315b56764b4f3ce6865b>`();
	
		bool
		:ref:`eventsSuspended<doxid-class_poco_1_1_directory_watcher_1ade7c7e5fcf2cc7e96f359a6322885a62>`() const;
	
		int
		:ref:`eventMask<doxid-class_poco_1_1_directory_watcher_1a2bec956f47e27364b113a3a3a67e304d>`() const;
	
		int
		:ref:`scanInterval<doxid-class_poco_1_1_directory_watcher_1a9b081187afebb06528fbb70cdea45e42>`() const;
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`File<doxid-class_poco_1_1_file>`&
		:ref:`directory<doxid-class_poco_1_1_directory_watcher_1a7437dbde5507a43e0592f5d678443566>`() const;
	
		bool
		:ref:`supportsMoveEvents<doxid-class_poco_1_1_directory_watcher_1a674d13446c45b3daac0edb8068ce8769>`() const;

	protected:
		// methods
	
		void
		:target:`init<doxid-class_poco_1_1_directory_watcher_1a3f50c2e1b0d8f6d59b727adacf119fcf>`();
	
		void
		:target:`stop<doxid-class_poco_1_1_directory_watcher_1ac28ce0f47807d2d67ca73b070c01437d>`();
	
		virtual
		void
		:ref:`run<doxid-class_poco_1_1_directory_watcher_1a39394b9a97931487331d07134b6e17f7>`();
	};

Inherited Members
-----------------

.. ref-code-block:: cpp
	:class: doxyrest-overview-inherited-code-block

	public:
		// methods
	
		virtual
		void
		:ref:`run<doxid-class_poco_1_1_runnable_1ad89816e81207bf5f1e52d5df860d11d4>`() = 0;

.. _details-class_poco_1_1_directory_watcher:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

This class is used to get notifications about changes to the filesystem, more specifically, to a specific directory.

Changes to a directory are reported via events.

A thread will be created that watches the specified directory for changes. Events are reported in the context of this thread.

Note that changes to files in subdirectories of the watched directory are not reported. Separate :ref:`DirectoryWatcher <doxid-class_poco_1_1_directory_watcher>` objects must be created for these directories if they should be watched.

Changes to file attributes are not reported.

On Windows, this class is implemented using FindFirstChangeNotification()/FindNextChangeNotification(). On Linux, this class is implemented using inotify. On FreeBSD and Darwin (Mac OS X, iOS), this class uses kevent/kqueue. On all other platforms, the watched directory is periodically scanned for changes. This can negatively affect performance if done too often. Therefore, the interval in which scans are done can be specified in the constructor. Note that periodic scanning will also be done on FreeBSD and Darwin if events for changes to files (DW_ITEM_MODIFIED) are enabled.

DW_ITEM_MOVED_FROM and DW_ITEM_MOVED_TO events will only be reported on Linux. On other platforms, a file rename or move operation will be reported via a DW_ITEM_REMOVED and a DW_ITEM_ADDED event. The order of these two events is not defined.

An event mask can be specified to enable only certain events.

Enum Values
-----------

.. index:: pair: enumvalue; DW_DEFAULT_SCAN_INTERVAL
.. _doxid-class_poco_1_1_directory_watcher_1ac2a1c73a685ac92ea1a31b73709a99cead1547e2c14312b8359940598b18d06bb:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	DW_DEFAULT_SCAN_INTERVAL

Default scan interval for platforms that don't provide a native notification mechanism.

Fields
------

.. index:: pair: variable; itemAdded
.. _doxid-class_poco_1_1_directory_watcher_1a1dca026393020b11972450558a71aa2a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> itemAdded

Fired when a file or directory has been created or added to the directory.

.. index:: pair: variable; itemRemoved
.. _doxid-class_poco_1_1_directory_watcher_1a16c1d4ef189bff35f59039003c9482aa:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> itemRemoved

Fired when a file or directory has been removed from the directory.

.. index:: pair: variable; itemModified
.. _doxid-class_poco_1_1_directory_watcher_1a7550b7bccbd5366e68dbcaa8cb2a3ce9:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> itemModified

Fired when a file or directory has been modified.

.. index:: pair: variable; itemMovedFrom
.. _doxid-class_poco_1_1_directory_watcher_1a3a95f2b4a37353b4fbddf2c7827632ce:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> itemMovedFrom

Fired when a file or directory has been renamed. This event delivers the old name.

.. index:: pair: variable; itemMovedTo
.. _doxid-class_poco_1_1_directory_watcher_1a98493853cad7643750589acec38d1ebb:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`DirectoryEvent<doxid-struct_poco_1_1_directory_watcher_1_1_directory_event>`> itemMovedTo

Fired when a file or directory has been moved. This event delivers the new name.

.. index:: pair: variable; scanError
.. _doxid-class_poco_1_1_directory_watcher_1a43ae2db6d48767f8dc425cb79a2bcf88:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`BasicEvent<doxid-class_poco_1_1_basic_event>`<:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Exception<doxid-class_poco_1_1_exception>`> scanError

Fired when an error occurs while scanning for changes.

Construction
------------

.. index:: pair: function; DirectoryWatcher
.. _doxid-class_poco_1_1_directory_watcher_1a9bde964821812b6e9fabe6bdfc7aab86:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	DirectoryWatcher(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path,
		int eventMask = :ref:`DW_FILTER_ENABLE_ALL<doxid-class_poco_1_1_directory_watcher_1afafd443bec6747c77d00a0d40610bc87a62ffb5186dd4b98fbeb04fbc82b825cb>`,
		int scanInterval = :ref:`DW_DEFAULT_SCAN_INTERVAL<doxid-class_poco_1_1_directory_watcher_1ac2a1c73a685ac92ea1a31b73709a99cead1547e2c14312b8359940598b18d06bb>`
		)

Creates a :ref:`DirectoryWatcher <doxid-class_poco_1_1_directory_watcher>` for the directory given in path.

To enable only specific events, an eventMask can be specified by OR-ing the desired event IDs (e.g., DW_ITEM_ADDED | DW_ITEM_MODIFIED). On platforms where no native filesystem notifications are available, scanInterval specifies the interval in seconds between scans of the directory.

.. index:: pair: function; DirectoryWatcher
.. _doxid-class_poco_1_1_directory_watcher_1a51e8be8c08443c6028a0ace41b3ac97b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	DirectoryWatcher(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`File<doxid-class_poco_1_1_file>`& directory,
		int eventMask = :ref:`DW_FILTER_ENABLE_ALL<doxid-class_poco_1_1_directory_watcher_1afafd443bec6747c77d00a0d40610bc87a62ffb5186dd4b98fbeb04fbc82b825cb>`,
		int scanInterval = :ref:`DW_DEFAULT_SCAN_INTERVAL<doxid-class_poco_1_1_directory_watcher_1ac2a1c73a685ac92ea1a31b73709a99cead1547e2c14312b8359940598b18d06bb>`
		)

Creates a :ref:`DirectoryWatcher <doxid-class_poco_1_1_directory_watcher>` for the specified directory To enable only specific events, an eventMask can be specified by OR-ing the desired event IDs (e.g., DW_ITEM_ADDED | DW_ITEM_MODIFIED).

On platforms where no native filesystem notifications are available, scanInterval specifies the interval in seconds between scans of the directory.

Methods
-------

.. index:: pair: function; suspendEvents
.. _doxid-class_poco_1_1_directory_watcher_1ad37c05876bf46f6b06279a523f2553b2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	suspendEvents()

Suspends sending of events.

Can be called multiple times, but every call to suspendEvent() must be matched by a call to :ref:`resumeEvents() <doxid-class_poco_1_1_directory_watcher_1a815ee4aab5d2315b56764b4f3ce6865b>`.

.. index:: pair: function; resumeEvents
.. _doxid-class_poco_1_1_directory_watcher_1a815ee4aab5d2315b56764b4f3ce6865b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	resumeEvents()

Resumes events, after they have been suspended with a call to :ref:`suspendEvents() <doxid-class_poco_1_1_directory_watcher_1ad37c05876bf46f6b06279a523f2553b2>`.

.. index:: pair: function; eventsSuspended
.. _doxid-class_poco_1_1_directory_watcher_1ade7c7e5fcf2cc7e96f359a6322885a62:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	eventsSuspended() const

Returns true iff events are suspended.

.. index:: pair: function; eventMask
.. _doxid-class_poco_1_1_directory_watcher_1a2bec956f47e27364b113a3a3a67e304d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	eventMask() const

Returns the value of the eventMask passed to the constructor.

.. index:: pair: function; scanInterval
.. _doxid-class_poco_1_1_directory_watcher_1a9b081187afebb06528fbb70cdea45e42:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	scanInterval() const

Returns the scan interval in seconds.

.. index:: pair: function; directory
.. _doxid-class_poco_1_1_directory_watcher_1a7437dbde5507a43e0592f5d678443566:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`File<doxid-class_poco_1_1_file>`&
	directory() const

Returns the directory being watched.

.. index:: pair: function; supportsMoveEvents
.. _doxid-class_poco_1_1_directory_watcher_1a674d13446c45b3daac0edb8068ce8769:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	supportsMoveEvents() const

Returns true iff the platform supports DW_ITEM_MOVED_FROM/itemMovedFrom and DW_ITEM_MOVED_TO/itemMovedTo events.

.. index:: pair: function; run
.. _doxid-class_poco_1_1_directory_watcher_1a39394b9a97931487331d07134b6e17f7:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	run()

Do whatever the thread needs to do.

Must be overridden by subclasses.

