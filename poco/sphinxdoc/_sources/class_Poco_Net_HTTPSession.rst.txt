.. index:: pair: class; Poco::Net::HTTPSession
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session:

class Poco::Net::HTTPSession
============================

.. toctree::
	:hidden:

Overview
~~~~~~~~

:ref:`HTTPSession <doxid-class_poco_1_1_net_1_1_h_t_t_p_session>` implements basic HTTP session management for both HTTP clients and HTTP servers. :ref:`More...<details-class_poco_1_1_net_1_1_h_t_t_p_session>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <HTTPSession.h>
	
	class HTTPSession
	{
	public:
		// enums
	
		enum
		{
		    :target:`HTTP_PORT<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a7e78432e9e6b9be68de9c85adcf259b6a7bc48abc88c649b13f10ea2acd5eb40e>` = 80,
		};

		// methods
	
		void
		:ref:`setKeepAlive<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a0f26e56231626324cda47a77764de1f1>`(bool keepAlive);
	
		bool
		:ref:`getKeepAlive<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a5e256ffa0ebcf858313c19b66f0237b8>`() const;
	
		void
		:ref:`setTimeout<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ac3b0e50de429e8fd4f5dc4a29a7f462d>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`& timeout);
	
		:ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`
		:ref:`getTimeout<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a53513a8292c059fde84315cd77cbb1da>`() const;
	
		bool
		:ref:`connected<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1aa86d1fc3fea4d65a522ef7dbbd160a22>`() const;
	
		virtual
		void
		:ref:`abort<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a9ac3b8330254494361f77154237175e5>`();
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Exception<doxid-class_poco_1_1_exception>`*
		:ref:`networkException<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1af129fb7e044498220f7bdc174aa36754>`() const;
	
		void
		:ref:`attachSessionData<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a173eb4f77be8506fd70ae55eef7b870e>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Any<doxid-class_poco_1_1_any>`& data);
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Any<doxid-class_poco_1_1_any>`&
		:ref:`sessionData<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1abaf374cb873d125048778e65712b51fc>`() const;
	
		:ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`
		:ref:`detachSocket<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a23b4bff0b82e6ae1163493829191c7c9>`();
	
		:ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`&
		:ref:`socket<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a182567e432a2641121f20753721cb476>`();
	
		void
		:ref:`drainBuffer<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a88015e458df0965f55e2577b4902a10e>`(:ref:`Poco::Buffer<doxid-class_poco_1_1_buffer>`<char>& buffer);

	protected:
		// construction
	
		:ref:`HTTPSession<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1aac36adc32fb7b22abf494733707518cb>`();
		:ref:`HTTPSession<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1abaec059900b33126240489e249c1a926>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket);
	
		:ref:`HTTPSession<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a89db2dcfebccbf33f43e9d27094a1f4c>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket,
			bool keepAlive
			);

		// methods
	
		int
		:ref:`get<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a820bcbed4147f4bb2f99539ab53d174d>`();
	
		int
		:ref:`peek<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ab94b6d69b827a552caf567862f96e2fe>`();
	
		virtual
		int
		:ref:`read<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a6875dc9399fdbe3aa1eb0d364cbb3f03>`(
			char* buffer,
			std::streamsize length
			);
	
		virtual
		int
		:ref:`write<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a1caa7029dcf1266db4bc4a5cc363c8e0>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` char* buffer,
			std::streamsize length
			);
	
		int
		:ref:`receive<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a30aa9bdf25c31303b9c069d5c926d152>`(
			char* buffer,
			int length
			);
	
		int
		:ref:`buffered<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ad089729b720424ce8b0c1272cbce333a>`() const;
	
		void
		:ref:`refill<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1aa40c1ada2a7b6f53614d69c47511f8e8>`();
	
		virtual
		void
		:ref:`connect<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1af17a521622971969cb591a4a37b19fc3>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`SocketAddress<doxid-class_poco_1_1_net_1_1_socket_address>`& address);
	
		void
		:ref:`attachSocket<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ac72cad836b2904ff29893fce46f22ede>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket);
	
		void
		:ref:`close<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a5c0150fffac13de77e83b81cea30813b>`();
	
		void
		:ref:`setException<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a49c55e08b257d07b57b8cb7e764c4ade>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Exception<doxid-class_poco_1_1_exception>`& exc);
	
		void
		:ref:`clearException<doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a09215e39a1d3679d2cfb0654c30510c2>`();
	};

	// direct descendants

	class :ref:`HTTPClientSession<doxid-class_poco_1_1_net_1_1_h_t_t_p_client_session>`;
	class :ref:`HTTPServerSession<doxid-class_poco_1_1_net_1_1_h_t_t_p_server_session>`;
.. _details-class_poco_1_1_net_1_1_h_t_t_p_session:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

:ref:`HTTPSession <doxid-class_poco_1_1_net_1_1_h_t_t_p_session>` implements basic HTTP session management for both HTTP clients and HTTP servers.

:ref:`HTTPSession <doxid-class_poco_1_1_net_1_1_h_t_t_p_session>` implements buffering for HTTP connections, as well as specific support for the various HTTP stream classes.

This class can not be instantiated. :ref:`HTTPClientSession <doxid-class_poco_1_1_net_1_1_h_t_t_p_client_session>` or :ref:`HTTPServerSession <doxid-class_poco_1_1_net_1_1_h_t_t_p_server_session>` must be used instead.

Construction
------------

.. index:: pair: function; HTTPSession
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1aac36adc32fb7b22abf494733707518cb:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	HTTPSession()

Creates a HTTP session using an unconnected stream socket.

.. index:: pair: function; HTTPSession
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1abaec059900b33126240489e249c1a926:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	HTTPSession(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket)

Creates a HTTP session using the given socket.

The session takes ownership of the socket and closes it when it's no longer used.

.. index:: pair: function; HTTPSession
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a89db2dcfebccbf33f43e9d27094a1f4c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	HTTPSession(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket,
		bool keepAlive
		)

Creates a HTTP session using the given socket.

The session takes ownership of the socket and closes it when it's no longer used.

Methods
-------

.. index:: pair: function; setKeepAlive
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a0f26e56231626324cda47a77764de1f1:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setKeepAlive(bool keepAlive)

Sets the keep-alive flag for this session.

If the keep-alive flag is enabled, persistent HTTP/1.1 connections are supported.

.. index:: pair: function; getKeepAlive
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a5e256ffa0ebcf858313c19b66f0237b8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	getKeepAlive() const

Returns the value of the keep-alive flag for this session.

.. index:: pair: function; setTimeout
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ac3b0e50de429e8fd4f5dc4a29a7f462d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setTimeout(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`& timeout)

Sets the timeout for the HTTP session.

.. index:: pair: function; getTimeout
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a53513a8292c059fde84315cd77cbb1da:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`
	getTimeout() const

Returns the timeout for the HTTP session.

.. index:: pair: function; connected
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1aa86d1fc3fea4d65a522ef7dbbd160a22:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	connected() const

Returns true if the underlying socket is connected.

.. index:: pair: function; abort
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a9ac3b8330254494361f77154237175e5:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	abort()

Aborts a session in progress by shutting down and closing the underlying socket.

.. index:: pair: function; networkException
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1af129fb7e044498220f7bdc174aa36754:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Exception<doxid-class_poco_1_1_exception>`*
	networkException() const

If sending or receiving data over the underlying socket connection resulted in an exception, a pointer to this exception is returned.

Otherwise, NULL is returned.

.. index:: pair: function; attachSessionData
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a173eb4f77be8506fd70ae55eef7b870e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	attachSessionData(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Any<doxid-class_poco_1_1_any>`& data)

Allows to attach an application-specific data item to the session.

On the server side, this can be used to manage data that must be maintained over the entire lifetime of a persistent connection (that is, multiple requests sent over the same connection).

.. index:: pair: function; sessionData
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1abaf374cb873d125048778e65712b51fc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Any<doxid-class_poco_1_1_any>`&
	sessionData() const

Returns the data attached with :ref:`attachSessionData() <doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a173eb4f77be8506fd70ae55eef7b870e>`, or an empty :ref:`Poco::Any <doxid-class_poco_1_1_any>` if no user data has been attached.

.. index:: pair: function; detachSocket
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a23b4bff0b82e6ae1163493829191c7c9:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`
	detachSocket()

Detaches the socket from the session.

The socket is returned, and a new, uninitialized socket is attached to the session.

.. index:: pair: function; socket
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a182567e432a2641121f20753721cb476:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`&
	socket()

Returns a reference to the underlying socket.

.. index:: pair: function; drainBuffer
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a88015e458df0965f55e2577b4902a10e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	drainBuffer(:ref:`Poco::Buffer<doxid-class_poco_1_1_buffer>`<char>& buffer)

Copies all bytes remaining in the internal buffer to the given :ref:`Poco::Buffer <doxid-class_poco_1_1_buffer>`, resizing it as necessary.

This is usually used together with :ref:`detachSocket() <doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a23b4bff0b82e6ae1163493829191c7c9>` to obtain any data already read from the socket, but not yet processed.

.. index:: pair: function; get
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a820bcbed4147f4bb2f99539ab53d174d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	get()

Returns the next byte in the buffer.

Reads more data from the socket if there are no bytes left in the buffer.

.. index:: pair: function; peek
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ab94b6d69b827a552caf567862f96e2fe:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	peek()

Peeks at the next character in the buffer.

Reads more data from the socket if there are no bytes left in the buffer.

.. index:: pair: function; read
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a6875dc9399fdbe3aa1eb0d364cbb3f03:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	read(
		char* buffer,
		std::streamsize length
		)

Reads up to length bytes.

If there is data in the buffer, this data is returned. Otherwise, data is read from the socket to avoid unnecessary buffering.

.. index:: pair: function; write
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a1caa7029dcf1266db4bc4a5cc363c8e0:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	int
	write(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` char* buffer,
		std::streamsize length
		)

Writes data to the socket.

.. index:: pair: function; receive
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a30aa9bdf25c31303b9c069d5c926d152:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	receive(
		char* buffer,
		int length
		)

Reads up to length bytes.

.. index:: pair: function; buffered
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ad089729b720424ce8b0c1272cbce333a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	buffered() const

Returns the number of bytes in the buffer.

.. index:: pair: function; refill
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1aa40c1ada2a7b6f53614d69c47511f8e8:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	refill()

Refills the internal buffer.

.. index:: pair: function; connect
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1af17a521622971969cb591a4a37b19fc3:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	virtual
	void
	connect(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`SocketAddress<doxid-class_poco_1_1_net_1_1_socket_address>`& address)

Connects the underlying socket to the given address and sets the socket's receive timeout.

.. index:: pair: function; attachSocket
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1ac72cad836b2904ff29893fce46f22ede:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	attachSocket(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket)

Attaches a socket to the session, replacing the previously attached socket.

.. index:: pair: function; close
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a5c0150fffac13de77e83b81cea30813b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	close()

Closes the underlying socket.

.. index:: pair: function; setException
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a49c55e08b257d07b57b8cb7e764c4ade:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setException(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Exception<doxid-class_poco_1_1_exception>`& exc)

Stores a clone of the exception.

.. index:: pair: function; clearException
.. _doxid-class_poco_1_1_net_1_1_h_t_t_p_session_1a09215e39a1d3679d2cfb0654c30510c2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	clearException()

Clears the stored exception.

