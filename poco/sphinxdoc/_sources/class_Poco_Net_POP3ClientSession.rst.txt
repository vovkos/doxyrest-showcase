.. index:: pair: class; Poco::Net::POP3ClientSession
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session:

class Poco::Net::POP3ClientSession
==================================

.. toctree::
	:hidden:

	struct_Poco_Net_POP3ClientSession_MessageInfo.rst

Overview
~~~~~~~~

This class implements an Post Office Protocol Version 3 (POP3, RFC 1939) client for receiving e-mail messages. :ref:`More...<details-class_poco_1_1_net_1_1_p_o_p3_client_session>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <POP3ClientSession.h>
	
	class POP3ClientSession
	{
	public:
		// typedefs
	
		typedef std::vector<:ref:`MessageInfo<doxid-struct_poco_1_1_net_1_1_p_o_p3_client_session_1_1_message_info>`> :target:`MessageInfoVec<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ad9670360f2f3abde38ea4ecd61fd19eb>`;

		// enums
	
		enum
		{
		    :target:`POP3_PORT<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1af80ebb4ce6caf437fe7fe9a3b9efefd6a1d10d7364906cd53a056b3408c17da6b>` = 110,
		};

		// structs
	
		struct :ref:`MessageInfo<doxid-struct_poco_1_1_net_1_1_p_o_p3_client_session_1_1_message_info>`;

		// construction
	
		:ref:`POP3ClientSession<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aff82778805ac5fd4c6c546c34e23b644>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket);
	
		:ref:`POP3ClientSession<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aec195669bc1c79efd35ee14c3fb0001b>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& host,
			Poco::UInt16 port = :ref:`POP3_PORT<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1af80ebb4ce6caf437fe7fe9a3b9efefd6a1d10d7364906cd53a056b3408c17da6b>`
			);

		// methods
	
		void
		:ref:`setTimeout<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aa9f3e8073b77e0cbb3e8471183e3ba66>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`& timeout);
	
		:ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`
		:ref:`getTimeout<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a43ab34349e5e22cc890a1b7883d73e1f>`() const;
	
		void
		:ref:`login<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a14373f6ca69b904c27f63ea132095d8b>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& username,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& password
			);
	
		void
		:ref:`close<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a9fb7d95eb3d2743c60625857717c6b34>`();
	
		int
		:ref:`messageCount<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a22af73ca80d9a3a3361455ed5fb4e27e>`();
	
		void
		:ref:`listMessages<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a4497873766e3c4d1b7d1e5c9fbc8fac2>`(:ref:`MessageInfoVec<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ad9670360f2f3abde38ea4ecd61fd19eb>`& messages);
	
		void
		:ref:`retrieveMessage<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae825e8a504136fd01cb84232d8b131cd>`(
			int id,
			:ref:`MailMessage<doxid-class_poco_1_1_net_1_1_mail_message>`& message
			);
	
		void
		:ref:`retrieveMessage<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae3330014db7ddbf65b1be0a67decbaaf>`(
			int id,
			:ref:`MailMessage<doxid-class_poco_1_1_net_1_1_mail_message>`& message,
			:ref:`PartHandler<doxid-class_poco_1_1_net_1_1_part_handler>`& handler
			);
	
		void
		:ref:`retrieveMessage<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae1b401e94f0a944a13418239755f0736>`(
			int id,
			std::ostream& ostr
			);
	
		void
		:ref:`retrieveHeader<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a0439383788061d9abe7110312c909262>`(
			int id,
			:ref:`MessageHeader<doxid-class_poco_1_1_net_1_1_message_header>`& header
			);
	
		void
		:ref:`deleteMessage<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aaf8482c1bf7016321185d04cd8560a2c>`(int id);
	
		bool
		:ref:`sendCommand<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae309ffc4189a14216aeb70d6f7edcb1e>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& command,
			std::string& response
			);
	
		bool
		:ref:`sendCommand<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a92fa8d135c822a886c8cd1d63aa37f81>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& command,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& arg,
			std::string& response
			);
	
		bool
		:ref:`sendCommand<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a710c797b7eef70d6eadff6d77a33ca9f>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& command,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& arg1,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& arg2,
			std::string& response
			);

	protected:
		// methods
	
		static
		bool
		:target:`isPositive<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ac6156fdea5d8c33d7933e2f9a160227b>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& response);
	};
.. _details-class_poco_1_1_net_1_1_p_o_p3_client_session:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

This class implements an Post Office Protocol Version 3 (POP3, RFC 1939) client for receiving e-mail messages.

Construction
------------

.. index:: pair: function; POP3ClientSession
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aff82778805ac5fd4c6c546c34e23b644:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	POP3ClientSession(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`StreamSocket<doxid-class_poco_1_1_net_1_1_stream_socket>`& socket)

Creates the :ref:`POP3ClientSession <doxid-class_poco_1_1_net_1_1_p_o_p3_client_session>` using the given socket, which must be connected to a POP3 server.

.. index:: pair: function; POP3ClientSession
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aec195669bc1c79efd35ee14c3fb0001b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	POP3ClientSession(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& host,
		Poco::UInt16 port = :ref:`POP3_PORT<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1af80ebb4ce6caf437fe7fe9a3b9efefd6a1d10d7364906cd53a056b3408c17da6b>`
		)

Creates the :ref:`POP3ClientSession <doxid-class_poco_1_1_net_1_1_p_o_p3_client_session>` using a socket connected to the given host and port.

Methods
-------

.. index:: pair: function; setTimeout
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aa9f3e8073b77e0cbb3e8471183e3ba66:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setTimeout(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` :ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`& timeout)

Sets the timeout for socket read operations.

.. index:: pair: function; getTimeout
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a43ab34349e5e22cc890a1b7883d73e1f:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`Poco::Timespan<doxid-class_poco_1_1_timespan>`
	getTimeout() const

Returns the timeout for socket read operations.

.. index:: pair: function; login
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a14373f6ca69b904c27f63ea132095d8b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	login(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& username,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& password
		)

Logs in to the POP3 server by sending a USER command followed by a PASS command.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; close
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a9fb7d95eb3d2743c60625857717c6b34:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	close()

Sends a QUIT command and closes the connection to the server.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; messageCount
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a22af73ca80d9a3a3361455ed5fb4e27e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	int
	messageCount()

Sends a STAT command to determine the number of messages available on the server and returns that number.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; listMessages
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a4497873766e3c4d1b7d1e5c9fbc8fac2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	listMessages(:ref:`MessageInfoVec<doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ad9670360f2f3abde38ea4ecd61fd19eb>`& messages)

Fills the given vector with the ids and sizes of all messages available on the server.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; retrieveMessage
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae825e8a504136fd01cb84232d8b131cd:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	retrieveMessage(
		int id,
		:ref:`MailMessage<doxid-class_poco_1_1_net_1_1_mail_message>`& message
		)

Retrieves the message with the given id from the server and stores the raw message content in the message's content string, available with message.getContent().

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; retrieveMessage
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae3330014db7ddbf65b1be0a67decbaaf:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	retrieveMessage(
		int id,
		:ref:`MailMessage<doxid-class_poco_1_1_net_1_1_mail_message>`& message,
		:ref:`PartHandler<doxid-class_poco_1_1_net_1_1_part_handler>`& handler
		)

Retrieves the message with the given id from the server and stores it in message.

If the message has multiple parts, the parts are reported to the :ref:`PartHandler <doxid-class_poco_1_1_net_1_1_part_handler>`. If the message is not a multi-part message, the content is stored in a string available by calling message.getContent().

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; retrieveMessage
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae1b401e94f0a944a13418239755f0736:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	retrieveMessage(
		int id,
		std::ostream& ostr
		)

Retrieves the raw message with the given id from the server and copies it to the given output stream.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; retrieveHeader
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a0439383788061d9abe7110312c909262:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	retrieveHeader(
		int id,
		:ref:`MessageHeader<doxid-class_poco_1_1_net_1_1_message_header>`& header
		)

Retrieves the message header of the message with the given id and stores it in header.

For this to work, the server must support the TOP command.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; deleteMessage
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1aaf8482c1bf7016321185d04cd8560a2c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	deleteMessage(int id)

Marks the message with the given ID for deletion.

The message will be deleted when the connection to the server is closed by calling :ref:`close() <doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a9fb7d95eb3d2743c60625857717c6b34>`.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; sendCommand
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1ae309ffc4189a14216aeb70d6f7edcb1e:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	sendCommand(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& command,
		std::string& response
		)

Sends the given command verbatim to the server and waits for a response.

Returns true if the response is positive, false otherwise.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; sendCommand
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a92fa8d135c822a886c8cd1d63aa37f81:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	sendCommand(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& command,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& arg,
		std::string& response
		)

Sends the given command verbatim to the server and waits for a response.

Returns true if the response is positive, false otherwise.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

.. index:: pair: function; sendCommand
.. _doxid-class_poco_1_1_net_1_1_p_o_p3_client_session_1a710c797b7eef70d6eadff6d77a33ca9f:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	sendCommand(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& command,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& arg1,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& arg2,
		std::string& response
		)

Sends the given command verbatim to the server and waits for a response.

Returns true if the response is positive, false otherwise.

Throws a POP3Exception in case of a POP3-specific error, or a NetException in case of a general network communication failure.

