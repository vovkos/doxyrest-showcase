.. index:: pair: class; Poco::Util::WinService
.. _doxid-class_poco_1_1_util_1_1_win_service:

class Poco::Util::WinService
============================

.. toctree::
	:hidden:

	enum_Poco_Util_WinService_Startup.rst

Overview
~~~~~~~~

This class provides an object-oriented interface to the Windows Service Control Manager for registering, unregistering, configuring, starting and stopping services. :ref:`More...<details-class_poco_1_1_util_1_1_win_service>`


.. ref-code-block:: cpp
	:class: doxyrest-overview-code-block

	#include <WinService.h>
	
	class WinService
	{
	public:
		// enums
	
		enum :ref:`Startup<doxid-class_poco_1_1_util_1_1_win_service_1ab8e2757ddbb4c95127a3311a539a7149>`;

		// fields
	
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` int :target:`STARTUP_TIMEOUT<doxid-class_poco_1_1_util_1_1_win_service_1a8da235bbff1db94f1945932fb8226af3>`;

		// construction
	
		:ref:`WinService<doxid-class_poco_1_1_util_1_1_win_service_1a26c81adfd1825765e45b3a932fc55f5c>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name);

		// methods
	
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string&
		:ref:`name<doxid-class_poco_1_1_util_1_1_win_service_1a0a75cfcb4ae33dfe7a8c7c642c908620>`() const;
	
		std::string
		:ref:`displayName<doxid-class_poco_1_1_util_1_1_win_service_1abc12e9d2ff11e6441805e3976f771cfc>`() const;
	
		std::string
		:ref:`path<doxid-class_poco_1_1_util_1_1_win_service_1aba760c992460cfce566d7cf8023d7dcf>`() const;
	
		void
		:ref:`registerService<doxid-class_poco_1_1_util_1_1_win_service_1a058249f5a8d75d6a49fc3e40259bf87c>`(
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path,
			:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& displayName
			);
	
		void
		:ref:`registerService<doxid-class_poco_1_1_util_1_1_win_service_1a4b21e8c4b83ba568876b29768520547a>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path);
	
		void
		:ref:`unregisterService<doxid-class_poco_1_1_util_1_1_win_service_1ac2ca7b55443e8f1713cfd9c9b8da9135>`();
	
		bool
		:ref:`isRegistered<doxid-class_poco_1_1_util_1_1_win_service_1af595f2a7a21d86429a6191585363374b>`() const;
	
		bool
		:ref:`isRunning<doxid-class_poco_1_1_util_1_1_win_service_1af743fce7a60994d595b6a618c6178114>`() const;
	
		void
		:ref:`start<doxid-class_poco_1_1_util_1_1_win_service_1a5c35e5cefa98b200abc43f53309a5fbd>`();
	
		void
		:ref:`stop<doxid-class_poco_1_1_util_1_1_win_service_1a3557d4f296196c35d43e9f1e40f7d0c2>`();
	
		void
		:ref:`setStartup<doxid-class_poco_1_1_util_1_1_win_service_1a228bc40272eca54ba74211e9a4886906>`(:ref:`Startup<doxid-class_poco_1_1_util_1_1_win_service_1ab8e2757ddbb4c95127a3311a539a7149>` startup);
	
		:ref:`Startup<doxid-class_poco_1_1_util_1_1_win_service_1ab8e2757ddbb4c95127a3311a539a7149>`
		:ref:`getStartup<doxid-class_poco_1_1_util_1_1_win_service_1acc7c215a451c9305e8a71bddff923a51>`() const;
	
		void
		:ref:`setDescription<doxid-class_poco_1_1_util_1_1_win_service_1a3d45170c89b62bd5bb213f616269a01d>`(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& description);
	
		std::string
		:ref:`getDescription<doxid-class_poco_1_1_util_1_1_win_service_1a69c92aa1796319036396f41cafef147c>`() const;

	protected:
		// fields
	
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string :target:`REGISTRY_KEY<doxid-class_poco_1_1_util_1_1_win_service_1ae8c34c3b27ca91c976311d8b99991e46>`;
		static :ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string :target:`REGISTRY_DESCRIPTION<doxid-class_poco_1_1_util_1_1_win_service_1a65cc7f4848d58f30efc4e1832645c5ca>`;
	};
.. _details-class_poco_1_1_util_1_1_win_service:

Detailed Documentation
~~~~~~~~~~~~~~~~~~~~~~

This class provides an object-oriented interface to the Windows Service Control Manager for registering, unregistering, configuring, starting and stopping services.

This class is only available on Windows platforms.

Construction
------------

.. index:: pair: function; WinService
.. _doxid-class_poco_1_1_util_1_1_win_service_1a26c81adfd1825765e45b3a932fc55f5c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	WinService(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& name)

Creates the :ref:`WinService <doxid-class_poco_1_1_util_1_1_win_service>`, using the given service name.

Methods
-------

.. index:: pair: function; name
.. _doxid-class_poco_1_1_util_1_1_win_service_1a0a75cfcb4ae33dfe7a8c7c642c908620:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string&
	name() const

Returns the service name.

.. index:: pair: function; displayName
.. _doxid-class_poco_1_1_util_1_1_win_service_1abc12e9d2ff11e6441805e3976f771cfc:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::string
	displayName() const

Returns the service's display name.

.. index:: pair: function; path
.. _doxid-class_poco_1_1_util_1_1_win_service_1aba760c992460cfce566d7cf8023d7dcf:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::string
	path() const

Returns the path to the service executable.

Throws a NotFoundException if the service has not been registered.

.. index:: pair: function; registerService
.. _doxid-class_poco_1_1_util_1_1_win_service_1a058249f5a8d75d6a49fc3e40259bf87c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	registerService(
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path,
		:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& displayName
		)

Creates a Windows service with the executable specified by path and the given displayName.

Throws a ExistsException if the service has already been registered.

.. index:: pair: function; registerService
.. _doxid-class_poco_1_1_util_1_1_win_service_1a4b21e8c4b83ba568876b29768520547a:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	registerService(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& path)

Creates a Windows service with the executable specified by path and the given displayName.

The service name is used as display name.

Throws a ExistsException if the service has already been registered.

.. index:: pair: function; unregisterService
.. _doxid-class_poco_1_1_util_1_1_win_service_1ac2ca7b55443e8f1713cfd9c9b8da9135:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	unregisterService()

Deletes the Windows service.

Throws a NotFoundException if the service has not been registered.

.. index:: pair: function; isRegistered
.. _doxid-class_poco_1_1_util_1_1_win_service_1af595f2a7a21d86429a6191585363374b:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	isRegistered() const

Returns true if the service has been registered with the Service Control Manager.

.. index:: pair: function; isRunning
.. _doxid-class_poco_1_1_util_1_1_win_service_1af743fce7a60994d595b6a618c6178114:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	bool
	isRunning() const

Returns true if the service is currently running.

.. index:: pair: function; start
.. _doxid-class_poco_1_1_util_1_1_win_service_1a5c35e5cefa98b200abc43f53309a5fbd:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	start()

Starts the service.

Does nothing if the service is already running.

Throws a NotFoundException if the service has not been registered.

.. index:: pair: function; stop
.. _doxid-class_poco_1_1_util_1_1_win_service_1a3557d4f296196c35d43e9f1e40f7d0c2:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	stop()

Stops the service.

Does nothing if the service is not running.

Throws a NotFoundException if the service has not been registered.

.. index:: pair: function; setStartup
.. _doxid-class_poco_1_1_util_1_1_win_service_1a228bc40272eca54ba74211e9a4886906:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setStartup(:ref:`Startup<doxid-class_poco_1_1_util_1_1_win_service_1ab8e2757ddbb4c95127a3311a539a7149>` startup)

Sets the startup mode for the service.

.. index:: pair: function; getStartup
.. _doxid-class_poco_1_1_util_1_1_win_service_1acc7c215a451c9305e8a71bddff923a51:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	:ref:`Startup<doxid-class_poco_1_1_util_1_1_win_service_1ab8e2757ddbb4c95127a3311a539a7149>`
	getStartup() const

Returns the startup mode for the service.

.. index:: pair: function; setDescription
.. _doxid-class_poco_1_1_util_1_1_win_service_1a3d45170c89b62bd5bb213f616269a01d:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	void
	setDescription(:ref:`const<doxid-zconf_8h_1a2c212835823e3c54a8ab6d95c652660e>` std::string& description)

Sets the service description in the registry.

.. index:: pair: function; getDescription
.. _doxid-class_poco_1_1_util_1_1_win_service_1a69c92aa1796319036396f41cafef147c:

.. ref-code-block:: cpp
	:class: doxyrest-title-code-block

	std::string
	getDescription() const

Returns the service description from the registry.

